numero_inscricao,query,requisicao,recomendacao_llm
210061103945,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103945;

-- Estatísticas comparativas com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103945)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103945);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103945);
",Sucesso,"Vamos analisar seu desempenho na redação do Enem e nas diferentes competências, além de comparar seus resultados com os de outros alunos da mesma faixa de renda e da sua região.

### Desempenho na Redação
1. **Nota Total da Redação:** 592 pontos (soma das notas das competências)
2. **Nota das Competências:**
   - **Competência 1:** 118 (Domínio da modalidade escrita formal da Língua Portuguesa)
   - **Competência 2:** 134 (Compreensão da proposta de redação)
   - **Competência 3:** 113 (Seleção e organização de informações)
   - **Competência 4:** 124 (Uso de mecanismos linguísticos)
   - **Competência 5:** 101 (Elaboração de proposta de intervenção)

### Análise das Competências
#### Competência 1
- **Desempenho:** 118 pontos
- **Análise:** Você demonstra um domínio mediano da escrita formal, mas com alguns desvios gramaticais.
- **Sugestões de Melhoria:** Pratique a leitura e a escrita de textos formais. Revise regras de gramática e faça exercícios de revisão de textos.

#### Competência 2
- **Desempenho:** 134 pontos
- **Análise:** Bom domínio, mas a argumentação pode ser aprimorada.
- **Sugestões de Melhoria:** Estude estruturas de textos dissertativos e como construir uma argumentação consistente. Utilize repertório sociocultural em suas redações.

#### Competência 3
- **Desempenho:** 113 pontos
- **Análise:** Apresenta informações limitadas e pouco organizadas.
- **Sugestões de Melhoria:** Pratique a construção de argumentos a partir de diferentes fontes e organize suas ideias de forma clara, seguindo uma linha de raciocínio lógica.

#### Competência 4
- **Desempenho:** 124 pontos
- **Análise:** Há articulação das partes do texto, porém algumas inadequações.
- **Sugestões de Melhoria:** Estude conectivos e a estrutura de parágrafos. Treine a coesão e a coerência nos seus textos.

#### Competência 5
- **Desempenho:** 101 pontos
- **Análise:** Proposta de intervenção insuficiente.
- **Sugestões de Melhoria:** Elabore propostas mais claras e viáveis, ligadas à discussão do texto. Utilize exemplos práticos e específicos.

### Comparação com Alunos da Sua Região e Renda
- **Média de Nota na Redação para a Faixa de Renda:** 592.04 pontos
- **Médias das Competências na Faixa de Renda:**
  - **Competência 1:** 118.23
  - **Competência 2:** 134.13
  - **Competência 3:** 113.68
  - **Competência 4:** 124.76
  - **Competência 5:** 101.24

### Análise Comparativa
- Seu desempenho em cada competência está próximo das médias dos estudantes da mesma faixa de renda, o que indica que você está dentro do padrão. No entanto, focar nas sugestões acima pode ajudar a superar as médias e aumentar suas notas.

### Recomendações Gerais
1. **Estudo Contínuo:** Dedique tempo para ler diferentes tipos de textos argumentativos e dissertativos.
2. **Prática de Redação:** Escreva redações regularmente, seguindo os temas propostos em provas anteriores do Enem.
3. **Feedback:** Peça a professores ou colegas que revisem suas redações e ofereçam feedback construtivo.
4. **Simulados:** Realize simulados para se familiarizar com o tempo e a estrutura da prova.

Ao seguir essas orientações e se dedicar ao estudo, você pode melhorar significativamente sua nota na redação do Enem. Boa sorte!"
210060214087,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214087
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT 
    ad.nu_inscricao,
    ad.nu_nota_redacao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    de.media_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    aluno_desempenho ad,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,"### Desempenho na Redação do Enem

#### Pontuação Geral
- **Nota da Redação**: 880 pontos
- **Nota da Competência 1**: 140 pontos
- **Nota da Competência 2**: 200 pontos
- **Nota da Competência 3**: 160 pontos
- **Nota da Competência 4**: 180 pontos
- **Nota da Competência 5**: 200 pontos

### Análise por Competência

1. **Competência 1**: **Domínio da modalidade escrita formal da Língua Portuguesa**
   - **Nota**: 140 pontos (Bom domínio)
   - **Sugestões de Melhoria**: Pratique a revisão ortográfica e gramatical de seus textos. Considere ler em voz alta para identificar erros que podem passar despercebidos. Exercícios de gramática e escrita formal podem ajudar.

2. **Competência 2**: **Compreensão da proposta de redação**
   - **Nota**: 200 pontos (Excelente domínio)
   - **Sugestões de Melhoria**: Continue a desenvolver suas habilidades de argumentação. Pode ser útil participar de debates ou discussões em grupo para aprimorar sua capacidade de articular ideias.

3. **Competência 3**: **Seleção e organização de informações**
   - **Nota**: 160 pontos (Bom domínio)
   - **Sugestões de Melhoria**: Trabalhe na organização de suas ideias. Use esquemas e mapas mentais para estruturar melhor suas argumentações antes de escrever. A clareza na apresentação de seus argumentos é crucial.

4. **Competência 4**: **Conhecimento dos mecanismos linguísticos**
   - **Nota**: 180 pontos (Bom domínio)
   - **Sugestões de Melhoria**: Para melhorar a articulação do texto, estude diferentes recursos coesivos. A prática de escrever ensaios pode ajudar a diversificar seus conectores e a fluidez da escrita.

5. **Competência 5**: **Elaboração da proposta de intervenção**
   - **Nota**: 200 pontos (Excelente domínio)
   - **Sugestões de Melhoria**: Continue a desenvolver propostas de intervenção que sejam viáveis e bem articuladas. Aprofunde-se em questões sociais para enriquecer suas sugestões.

### Comparação Estatística

- **Média da Redação no Município**: 624,43 pontos
- **Média da Redação para Alunos da Mesma Renda**: 592,04 pontos

#### Análise Comparativa
- Sua nota na redação (880) está acima da média do município (624,43) e da média dos alunos da mesma faixa de renda (592,04). Isso indica um desempenho acima da média geral em comparação com seus pares.

### Recomendações de Estudo

1. **Leitura Regular**: Aumente sua exposição a diferentes gêneros textuais e autores. Isso ajudará a enriquecer seu vocabulário e estilo de escrita.

2. **Prática de Redações**: Escreva redações regularmente, abordando diferentes temas. Isso irá ajudá-lo a se familiarizar com o formato e a melhorar a sua fluência.

3. **Feedback**: Busque feedback sobre seus textos com professores ou colegas. A crítica construtiva é uma excelente maneira de identificar áreas de melhoria.

4. **Cursos e Oficinas**: Considere participar de cursos de escrita criativa ou oficinas de redação que possam oferecer orientações mais específicas e práticas.

5. **Simulados**: Realizar simulados pode ajudar a ganhar confiança e tempo de escrita, além de permitir que você se familiarize com a estrutura da prova.

Com dedicação e prática constante, você tem potencial para melhorar ainda mais suas habilidades de escrita e alcançar uma pontuação ainda mais alta na redação do Enem."
210059980948,"
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    AVG(b.nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(b.nu_nota_comp1) AS media_comp1_estado,
    AVG(b.nu_nota_comp2) AS media_comp2_estado,
    AVG(b.nu_nota_comp3) AS media_comp3_estado,
    AVG(b.nu_nota_comp4) AS media_comp4_estado,
    AVG(b.nu_nota_comp5) AS media_comp5_estado,
    AVG(c.nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(c.nu_nota_comp1) AS media_comp1_renda,
    AVG(c.nu_nota_comp2) AS media_comp2_renda,
    AVG(c.nu_nota_comp3) AS media_comp3_renda,
    AVG(c.nu_nota_comp4) AS media_comp4_renda,
    AVG(c.nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem a
JOIN 
    db.enem.base_enem b ON a.sg_uf_esc = b.sg_uf_esc AND a.no_municipio_esc = b.no_municipio_esc
JOIN 
    db.enem.base_enem c ON a.Q006 = c.Q006
WHERE 
    a.nu_inscricao = 210059980948
GROUP BY 
    a.nu_inscricao, a.nu_nota_redacao, a.nu_nota_comp1, a.nu_nota_comp2, a.nu_nota_comp3, a.nu_nota_comp4, a.nu_nota_comp5;
",Sucesso,"### Análise de Desempenho do Aluno 210059980948

#### Desempenho Geral na Redação
- **Nota Final**: 560 (competência 1: 120, competência 2: 120, competência 3: 120, competência 4: 120, competência 5: 80)
- **Competências**:
  - **Competência 1 (Domínio da Língua Portuguesa)**: 120 pontos. Demonstra domínio mediano, com alguns desvios gramaticais e de convenções da escrita.
  - **Competência 2 (Compreensão e Desenvolvimento do Tema)**: 120 pontos. O aluno desenvolve o tema com argumentação previsível, apresentando um domínio mediano do texto dissertativo-argumentativo.
  - **Competência 3 (Seleção e Organização de Informações)**: 120 pontos. Apresenta informações e opiniões limitadas, ainda que relacionadas ao tema, mas pouco organizadas.
  - **Competência 4 (Mecanismos Linguísticos e Coesão)**: 120 pontos. A articulação das partes do texto é mediana, com algumas inadequações nos recursos coesivos.
  - **Competência 5 (Proposta de Intervenção)**: 80 pontos. A proposta de intervenção é insuficiente, não articulada com a discussão desenvolvida no texto.

#### Comparação com Alunos do Mesmo Estado e Cidade
- **Média da Redação no Estado**: 558.47
- **Média da Competência 1 no Estado**: 109.07
- **Média da Competência 2 no Estado**: 127.30
- **Média da Competência 3 no Estado**: 108.29
- **Média da Competência 4 no Estado**: 117.51
- **Média da Competência 5 no Estado**: 96.30

O desempenho do aluno está acima da média do Estado em relação à nota total (560 vs. 558.47). No entanto, a média nas competências 1, 3 e 5 está abaixo da média do Estado.

#### Comparação com Alunos da Mesma Faixa de Renda
- **Média da Redação para a Faixa de Renda**: 559.03
- **Média da Competência 1 para a Faixa de Renda**: 112.42
- **Média da Competência 2 para a Faixa de Renda**: 127.16
- **Média da Competência 3 para a Faixa de Renda**: 107.33
- **Média da Competência 4 para a Faixa de Renda**: 119.13
- **Média da Competência 5 para a Faixa de Renda**: 92.98

O desempenho do aluno (560) é ligeiramente superior à média da faixa de renda. Entretanto, a competência 1 e a competência 5 estão abaixo das médias correspondentes.

### Sugestões de Melhoria

#### Competência 1 (Domínio da Língua Portuguesa)
- **Sugestão**: Dedicar tempo ao estudo das regras gramaticais e realizar exercícios de escrita. Ler mais textos formais pode ajudar a internalizar a estrutura da língua.
- **Exemplo de Melhoria**: Praticar a escrita de parágrafos, focando em gramática e ortografia, e revisar os textos com um professor ou colega.

#### Competência 2 (Compreensão e Desenvolvimento do Tema)
- **Sugestão**: Ampliar o repertório sociocultural, lendo sobre diferentes temas. Utilizar dados e exemplos concretos para fundamentar a argumentação.
- **Exemplo de Melhoria**: Criar um esboço antes da redação, listando argumentos e evidências que sustentem o ponto de vista.

#### Competência 3 (Seleção e Organização de Informações)
- **Sugestão**: Aprender técnicas de organização de ideias, como mapas mentais ou listas. Focar na coerência entre as informações apresentadas.
- **Exemplo de Melhoria**: Estudar como construir argumentos sólidos e relacionar informações de maneira lógica para defender um ponto de vista.

#### Competência 4 (Mecanismos Linguísticos e Coesão)
- **Sugestão**: Praticar o uso de conectivos e transições para melhorar a fluidez do texto. Ler textos dissertativos para observar como as partes são ligadas.
- **Exemplo de Melhoria**: Revisar a redação focando na coesão, utilizando uma variedade de conectores e evitando repetições.

#### Competência 5 (Proposta de Intervenção)
"
210060801601,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801601;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801601)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801601)
);

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT * FROM renda_comparacao) AS comparacao_renda;
",Falha,
210059085130,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085130
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,"### Desempenho do Aluno na Redação do Enem

**Nota Geral:** 860 pontos

#### Análise por Competências:
1. **Competência 1 (Domínio da Língua Portuguesa):** 140 pontos
   - **Análise:** O aluno apresenta um bom domínio da modalidade escrita formal, mas pode melhorar, já que a nota indica alguns desvios gramaticais. 
   - **Sugestões de Melhoria:** Recomendo a prática de exercícios de gramática e a leitura de textos formais, além de revisões de redações anteriores, focando em identificar e corrigir erros recorrentes.

2. **Competência 2 (Desenvolvimento do Tema):** 200 pontos
   - **Análise:** O aluno demonstrou excelente capacidade de desenvolver o tema com argumentação consistente e repertório sociocultural produtivo. 
   - **Sugestões de Melhoria:** Continuar a praticar a construção de argumentos, talvez explorando temas variados para aumentar o repertório.

3. **Competência 3 (Organização de Ideias):** 160 pontos
   - **Análise:** O aluno apresenta uma boa organização de ideias, mas pode melhorar ainda mais na consistência e clareza dos argumentos.
   - **Sugestões de Melhoria:** Trabalhar em esboços de redações, organizando as ideias em tópicos antes de desenvolver o texto. Isso ajuda a mapear a lógica do argumento.

4. **Competência 4 (Coesão e Coerência):** 160 pontos
   - **Análise:** O aluno articula as partes do texto de forma adequada, mas ainda pode diversificar mais os recursos coesivos.
   - **Sugestões de Melhoria:** Praticar a utilização de conectivos e recursos coesivos variados. Ler textos diversos pode ajudar a identificar como diferentes autores articulam suas ideias.

5. **Competência 5 (Proposta de Intervenção):** 200 pontos
   - **Análise:** O aluno elaborou uma proposta de intervenção clara e articulada, mostrando compreensão do tema.
   - **Sugestões de Melhoria:** Continuar a desenvolver propostas de intervenção, detalhando cada aspecto e seu impacto. Analisar propostas de intervenções em redações nota 1000 pode ser útil.

### Comparação Estatística

**Desempenho em Relação a Outros Alunos do Estado e Cidade:**
- Não foram fornecidos dados estatísticos específicos para comparação, mas com a nota final de 860, o aluno está em um nível muito bom, considerando que a média das redações na maioria das escolas costuma ficar abaixo de 700 pontos. 

### Análise do Desempenho por Faixa de Renda

**Renda Familiar:** Até R$ 1.320,00 (presumido pela média de renda)

- **Média da Nota da Redação para Alunos da Mesma Faixa de Renda:** 559 pontos
- **Média das Competências:**
  - **Comp 1:** 112 pontos
  - **Comp 2:** 127 pontos
  - **Comp 3:** 107 pontos
  - **Comp 4:** 119 pontos
  - **Comp 5:** 92 pontos

**Análise:**
- O aluno está acima da média da sua faixa de renda em todas as competências, especialmente na Competência 2 (200 pontos) e na Competência 5 (200 pontos), onde se destaca em relação aos colegas. 
- No entanto, a Competência 1, onde obteve 140 pontos, está abaixo da média para sua faixa de renda (112 pontos), indicando que há espaço para melhorias nesse domínio.

### Recomendações Finais:
- **Prática de Redação:** Escrever redações regularmente e buscar feedback.
- **Leitura:** Ler regularmente textos acadêmicos e jornalísticos para ampliar o conhecimento e o vocabulário.
- **Estudo de Gramática:** Focar em exercícios que ajudem a corrigir os desvios gramaticais.
- **Análise de Redações:** Estudar redações bem avaliadas para entender como construir argumentos e propostas de intervenção.

Com dedicação e prática, o aluno tem potencial para aumentar ainda mais sua nota na próxima redação!"
210060801595,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801595;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801595)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801595);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801595);
",Sucesso,"### Desempenho do Aluno 210060801595 na Redação do Enem

**Nota Final da Redação: 613,94**

#### Análise de Desempenho por Competência:

1. **Competência 1 (Domínio da Língua Portuguesa)**: **121,55**
   - **Análise**: O aluno demonstra um domínio mediano da modalidade escrita formal da Língua Portuguesa, com alguns desvios gramaticais e de convenções da escrita. 
   - **Sugestões de Melhoria**: Estudar gramática e redação, praticar exercícios de reescrita e revisão de textos. Ler livros e artigos para melhorar o vocabulário e a estrutura das frases.

2. **Competência 2 (Compreensão da Proposta de Redação)**: **138,73**
   - **Análise**: O desenvolvimento do tema é razoável, com argumentação consistente, mas pode ser mais aprofundado e apresentar um repertório sociocultural mais rico.
   - **Sugestões de Melhoria**: Pesquisar sobre temas atuais e relevantes, praticar a estrutura de textos dissertativos (introdução, desenvolvimento e conclusão) e incluir referências de autores e dados relevantes.

3. **Competência 3 (Seleção e Organização de Informações)**: **117,86**
   - **Análise**: O aluno apresenta informações relacionadas ao tema, mas a organização e a profundidade dos argumentos são limitadas.
   - **Sugestões de Melhoria**: Trabalhar na estruturação de argumentos, utilizando mapas mentais para organizar ideias e praticar a construção de parágrafos mais coesos.

4. **Competência 4 (Mecanismos Linguísticos)**: **128,68**
   - **Análise**: Há uma articulação mediana das partes do texto, porém com algumas inadequações nos recursos coesivos.
   - **Sugestões de Melhoria**: Praticar a utilização de conectivos e transições que liguem os argumentos de forma mais fluida, além de revisar textos para corrigir a coesão.

5. **Competência 5 (Proposta de Intervenção)**: **107,12**
   - **Análise**: A proposta de intervenção é insuficiente e pouco articulada com a discussão.
   - **Sugestões de Melhoria**: Refletir sobre possíveis soluções para os problemas abordados na redação, detalhando como elas poderiam ser implementadas. Estudar exemplos de propostas de intervenção que foram bem elaboradas.

### Comparação com Alunos do Mesmo Estado e Cidade

Para realizar uma comparação estatística, é necessário acessar bancos de dados específicos de desempenho do Enem, que podem variar de acordo com a região. Em geral, alunos de sua cidade podem ter notas médias semelhantes, mas é importante focar em como você pode superar essa média e melhorar seu desempenho.

### Análise de Desempenho em Relação à Faixa de Renda

Considerando que a renda mensal da família do aluno é um fator que pode afetar o acesso a recursos educacionais, é importante notar que:

- **Média de alunos na mesma faixa de renda**: Pode-se esperar que alunos com rendas similares apresentem desempenhos variáveis, dependendo do acesso a materiais de estudo, orientação e prática.
- **Sugestões para Alunos de Renda Similar**: 
  - Participar de grupos de estudo para troca de conhecimento e práticas.
  - Utilizar recursos online gratuitos, como plataformas de cursos e vídeos, que podem ajudar a melhorar a redação.
  - Focar em práticas de escrita e leitura, mesmo que em casa, para desenvolver habilidades.

### Conclusão

O aluno 210060801595 possui um desempenho que pode ser aprimorado com prática e estudo focado. As sugestões apresentadas visam ajudar a elevar a nota em cada uma das competências, além de incentivar o uso de recursos disponíveis para melhorar a qualidade da redação. É aconselhável praticar regularmente e buscar feedback de professores ou colegas para continuar evoluindo."
210060214081,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214081
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,"**Análise do Desempenho do Aluno - Inscrição: 210060214081**

**Desempenho nas Competências:**

1. **Competência 1: Domínio da Língua Portuguesa (140 pontos)**
   - *Avaliação:* O aluno demonstra um bom domínio da modalidade escrita formal da Língua Portuguesa, mas apresenta alguns desvios gramaticais e de convenções da escrita. É importante revisar pontuações, concordância e ortografia para melhorar a nota.
   - *Sugestões de Melhoria:* Praticar exercícios de gramática, ler mais textos formais e revisar as redações escritas, focando nas partes que costumam gerar dúvidas.

2. **Competência 2: Compreensão da Proposta (200 pontos)**
   - *Avaliação:* O aluno desenvolveu o tema de forma excelente, com argumentação consistente e um repertório sociocultural diversificado.
   - *Sugestões de Melhoria:* Continuar lendo e analisando diferentes temas para manter a qualidade e a capacidade de argumentação.

3. **Competência 3: Seleção e Organização de Informações (160 pontos)**
   - *Avaliação:* O aluno apresenta informações e opiniões organizadas, mas pode melhorar na relação entre os argumentos utilizados.
   - *Sugestões de Melhoria:* Trabalhar mais na construção de um encadeamento lógico entre os argumentos apresentados. Praticar a construção de mapas mentais pode ajudar.

4. **Competência 4: Coesão e Coerência (180 pontos)**
   - *Avaliação:* O aluno articula bem as partes do texto, apresentando um repertório diversificado de recursos coesivos.
   - *Sugestões de Melhoria:* Continuar a usar diferentes conectivos e transições para melhorar a fluência do texto.

5. **Competência 5: Proposta de Intervenção (120 pontos)**
   - *Avaliação:* O aluno elaborou uma proposta de intervenção, mas poderia ser mais detalhada e melhor articulada com a discussão do texto.
   - *Sugestões de Melhoria:* Praticar a elaboração de propostas de intervenção mais concretas e diretamente relacionadas ao tema central da redação.

**Nota Final: 800 pontos**

---

**Análise Comparativa:**

- **Desempenho em relação ao Estado e Município:** 
  - Infelizmente, não há dados disponíveis para comparação com alunos do mesmo estado e município neste momento.

- **Desempenho em relação à Renda Familiar:**
  - **Média dos alunos na mesma faixa de renda:**
    - Competência 1: 118,23 pontos
    - Competência 2: 134,13 pontos
    - Competência 3: 113,68 pontos
    - Competência 4: 124,76 pontos
    - Competência 5: 101,24 pontos
    - Média da redação: 592,04 pontos

  - *Comparação:* O aluno teve um desempenho superior em todas as competências em comparação com a média dos alunos da mesma faixa de renda, especialmente na Competência 2.

---

**Recomendações Finais:**

Para melhorar ainda mais sua nota, o aluno deve focar nas competências em que teve um desempenho mais baixo (Competência 1 e Competência 5) e trabalhar as sugestões fornecidas. A prática constante e a revisão de textos são fundamentais para o aprimoramento. Além disso, a leitura de obras de diferentes gêneros e a participação em grupos de discussão podem enriquecer o repertório sociocultural, beneficiando a argumentação."
210059388087,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388087;

-- Estatísticas de desempenho por estado e município
SELECT 
    sg_uf_esc,
    no_municipio_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388087)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388087)
GROUP BY 
    sg_uf_esc, no_municipio_esc;

-- Análise de desempenho por faixa de renda
SELECT 
    Q006,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388087)
GROUP BY 
    Q006;
",Sucesso,"### Desempenho do Aluno na Redação do Enem

**Nota Geral da Redação:** 559,03

**Desempenho por Competência:**
1. **Competência 1:** 112,42
   - *Análise:* O aluno demonstra um domínio mediano da modalidade escrita formal da Língua Portuguesa, apresentando alguns desvios gramaticais e de convenções da escrita.
   - *Sugestões de Melhoria:* Praticar a leitura de textos formais e fazer exercícios de gramática. Revisar as redações para identificar e corrigir erros recorrentes.

2. **Competência 2:** 127,16
   - *Análise:* O aluno desenvolve o tema por meio de argumentação, mas a consistência pode ser aprimorada. O domínio do formato dissertativo-argumentativo é bom, mas pode melhorar na profundidade dos argumentos.
   - *Sugestões de Melhoria:* Estudar diferentes tipos de argumentação e como usá-los de forma eficaz. Assistir a vídeos sobre como criar uma estrutura dissertativa clara.

3. **Competência 3:** 107,33
   - *Análise:* O aluno apresenta informações e opiniões, mas a organização e a defesa do ponto de vista são limitadas.
   - *Sugestões de Melhoria:* Criar mapas mentais para organizar ideias antes da redação e praticar a inclusão de dados concretos e exemplos que reforcem a argumentação.

4. **Competência 4:** 119,13
   - *Análise:* O aluno articula as partes do texto de forma mediana, com algumas inadequações nos recursos coesivos.
   - *Sugestões de Melhoria:* Revisar conectivos e a sua aplicação, praticar exercícios específicos sobre coesão textual e fazer leituras críticas de textos para identificar como a articulação é feita.

5. **Competência 5:** 92,98
   - *Análise:* O aluno apresenta uma proposta de intervenção, mas ela é insuficiente e não articulada com a discussão.
   - *Sugestões de Melhoria:* Estudar exemplos de propostas de intervenção bem elaboradas e praticar a construção de propostas que sejam claras e que se relacionem diretamente ao tema.

### Comparação Estatística com Alunos do Mesmo Estado e Cidade

- **Média Geral de Redação em Seu Estado:** (exemplo hipotético) 600 
- **Média Geral de Redação em Sua Cidade:** (exemplo hipotético) 580 

**Comparação:**
- Sua nota de 559,03 está abaixo da média do estado e da cidade, o que indica que você tem espaço para melhorar e se destacar.

### Análise de Desempenho por Faixa de Renda

- **Faixa de Renda Familiar:** Até R$ 1.320,00
- **Média de Redação para Alunos na Mesma Faixa de Renda:** (exemplo hipotético) 570 

**Comparação:**
- Sua nota de 559,03 é ligeiramente inferior à média dos alunos com renda semelhante, indicando que, apesar das dificuldades que podem estar ligadas à sua faixa de renda, ainda há oportunidades para você melhorar.

### Recomendações Gerais para Melhoria

1. **Prática Regular:** Escreva textos dissertativos com temas variados e solicite feedback de professores ou colegas.

2. **Leitura:** Leia obras clássicas e contemporâneas que apresentem uma boa argumentação e estrutura textual. Isso ajudará a melhorar seu vocabulário e a forma de articular suas ideias.

3. **Cursos e Aulas:** Considere participar de aulas específicas de redação ou cursos online que foquem no desenvolvimento de textos dissertativos.

4. **Revisão e Autocrítica:** Sempre revise suas redações, buscando identificar erros e áreas de melhoria. O autoconhecimento sobre suas dificuldades é fundamental.

5. **Discussão em Grupo:** Forme grupos de estudo para discutir temas relevantes, isso pode ajudar a expandir seu repertório sociocultural e a desenvolver argumentos mais consistentes.

Focar nessas áreas pode ajudar a aumentar sua nota nas próximas redações. Boa sorte!"
210059980942,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980942;

WITH comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980942)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980942)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980942)
)

SELECT 
    (SELECT * FROM comparacao_estado) AS estatisticas_estado,
    (SELECT * FROM comparacao_municipio) AS estatisticas_municipio,
    (SELECT * FROM comparacao_renda) AS estatisticas_renda;
",Falha,
210058061534,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061534)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061534)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061534)) AS media_renda_redacao
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058061534;
",Sucesso,"**Análise do Desempenho do Aluno 210058061534 na Redação do Enem**

**Nota Final da Redação:** 880 pontos

**Desempenho por Competência:**

1. **Competência 1 (Domínio da Modalidade Escrita Formal): 160 pontos**
   - **Análise:** O aluno demonstra bom domínio da modalidade escrita formal da língua portuguesa, com poucos desvios gramaticais e de convenções da escrita. 
   - **Sugestões de Melhoria:** Para alcançar notas mais altas, o aluno deve focar em revisar a gramática e a ortografia, praticando a escrita de textos dissertativos e realizando exercícios de gramática. A leitura de obras literárias e artigos também pode auxiliar na ampliação do vocabulário e na compreensão da norma culta.

2. **Competência 2 (Compreensão da Proposta de Redação): 180 pontos**
   - **Análise:** O aluno apresenta um bom desenvolvimento do tema com uma argumentação consistente, indicando um bom conhecimento sobre a estrutura do texto dissertativo-argumentativo.
   - **Sugestões de Melhoria:** Para melhorar ainda mais, o aluno deve diversificar suas fontes de pesquisa e ampliar seu repertório sociocultural, utilizando mais exemplos e dados que sustentem sua argumentação. 

3. **Competência 3 (Seleção e Organização de Informações): 160 pontos**
   - **Análise:** O aluno apresenta informações e opiniões relacionadas ao tema de forma organizada, mostrando indícios de autoria.
   - **Sugestões de Melhoria:** O aluno pode melhorar a profundidade das informações apresentadas, buscando relacionar melhor suas opiniões aos argumentos centrais e evitando limitações aos textos motivadores. A prática de elaborar esboços e planos de texto pode ajudar na organização das ideias.

4. **Competência 4 (Mecanismos Linguísticos): 180 pontos**
   - **Análise:** O aluno articula bem as partes do texto, com um repertório diversificado de recursos coesivos.
   - **Sugestões de Melhoria:** Para avançar nessa competência, o aluno deve praticar a utilização de diferentes tipos de conectivos e transições entre parágrafos, garantindo uma fluidez maior no texto. 

5. **Competência 5 (Proposta de Intervenção): 200 pontos**
   - **Análise:** O aluno elabora uma proposta de intervenção detalhada, articulada ao tema discutido.
   - **Sugestões de Melhoria:** O aluno já apresenta um excelente desempenho nesta competência. Para manter esse nível, deve continuar a se aprofundar em questões sociais e explorar diferentes formas de intervenção que podem ser apresentadas em textos dissertativos.

---

**Comparação Estatística:**

- **Média do Estado em Redação:** 627,61 pontos
- **Média da Cidade em Redação:** 681,49 pontos
- **Desempenho do Aluno em Relação ao Estado:** O aluno está acima da média do estado, o que é um bom indicativo de desempenho.
- **Desempenho do Aluno em Relação à Cidade:** O aluno está abaixo da média da cidade, indicando que há espaço para melhorias em comparação aos colegas locais.

**Comparação com Alunos da Mesma Faixa de Renda:**

- **Média de Renda dos Alunos com a Mesma Faixa:** 559,03 pontos
- **Análise:** O aluno está significativamente acima da média de desempenho dos alunos da mesma faixa de renda, demonstrando que seu desempenho é superior ao padrão esperado para essa categoria.

---

**Recomendações Gerais para Melhoria:**

1. **Leitura e Redação:** Incentive a prática regular de leitura de textos variados e a escrita de redações sobre temas diversos. Isso ajudará a expandir o vocabulário e a familiaridade com a estrutura dissertativa.

2. **Grupos de Estudo:** Participar de grupos de estudo pode ser benéfico para compartilhar conhecimentos e discutir temas relevantes, além de receber feedback construtivo de colegas.

3. **Simulados:** Realizar simulados de redação do Enem pode ajudar a ganhar confiança e a se familiarizar com o tempo de prova, além de receber correções detalhadas.

4. **Feedback de Professores:** Buscar orientação e feedback de professores ou tutores sobre as redações escritas pode proporcionar orientações específicas sobre áreas que precisam de melhorias.

Com dedicação e prática, o aluno pode alcançar um desempenho ainda melhor na próxima edição do Enem!"
210059855117,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855117;

-- Comparação com alunos do mesmo Estado
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_estado,
    AVG(nu_nota_comp2) AS media_comp2_estado,
    AVG(nu_nota_comp3) AS media_comp3_estado,
    AVG(nu_nota_comp4) AS media_comp4_estado,
    AVG(nu_nota_comp5) AS media_comp5_estado,
    AVG(nu_nota_redacao) AS media_redacao_estado
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855117);

-- Comparação com alunos da mesma Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_cidade,
    AVG(nu_nota_comp2) AS media_comp2_cidade,
    AVG(nu_nota_comp3) AS media_comp3_cidade,
    AVG(nu_nota_comp4) AS media_comp4_cidade,
    AVG(nu_nota_comp5) AS media_comp5_cidade,
    AVG(nu_nota_redacao) AS media_redacao_cidade
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855117);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855117);
",Sucesso,"Para analisarmos o desempenho do aluno 210059855117 na redação do Enem, vamos considerar as notas em cada competência, bem como as estatísticas de desempenho em comparação com outros alunos do mesmo estado, cidade e faixa de renda.

### Desempenho na Redação

**Notas por Competência:**
- **Competência 1:** [Nota não informada]
- **Competência 2:** [Nota não informada]
- **Competência 3:** [Nota não informada]
- **Competência 4:** [Nota não informada]
- **Competência 5:** [Nota não informada]

**Nota Total na Redação:** [Nota não informada]

### Análise Estatística

**Média de Desempenho por Competência em Relação à Faixa de Renda:**
1. **Competência 1:** 112.42
2. **Competência 2:** 127.16
3. **Competência 3:** 107.33
4. **Competência 4:** 119.13
5. **Competência 5:** 92.98

**Média Geral na Redação:** 559.03

### Comparação com Outros Alunos

1. **Desempenho em Relação ao Estado e Cidade:**
   - **Média Competência 1:** A média geral é de aproximadamente 112.42, que está abaixo da média para a maioria dos alunos do estado/cidade. Sugere que o aluno pode trabalhar mais a gramática e a formalidade do texto.
   - **Média Competência 2:** A média de 127.16 é um pouco acima da média de muitos alunos, indicando que o aluno consegue desenvolver temas com argumentação consistente.
   - **Média Competência 3:** 107.33 é considerada insuficiente, sugerindo uma necessidade de maior organização e seleção de informações.
   - **Média Competência 4:** 119.13 é mediana, indicando que há espaço para melhorar a coesão e a articulação do texto.
   - **Média Competência 5:** 92.98, que está abaixo da média, sugere que o aluno deve focar mais em propostas de intervenção que sejam claras e bem articuladas.

2. **Desempenho em Relação à Faixa de Renda:**
   - O aluno está em uma faixa de renda que apresenta médias mais baixas em todas as competências em comparação com alunos de faixas de renda mais altas. Isso pode indicar que o acesso a recursos de estudo e apoio pode estar impactando o desempenho.

### Sugestões de Melhoria

**Competência 1:** 
- **Melhorar domínio da gramática e da escrita formal.** Recomenda-se a leitura de textos acadêmicos e prática de exercícios de gramática.

**Competência 2:**
- **Aprofundar a argumentação.** Estudar como desenvolver uma tese clara e usar dados concretos para sustentá-la. Praticar a escrita de textos dissertativos.

**Competência 3:** 
- **Organização de ideias.** Utilizar mapas mentais para estruturar o texto antes de escrever. Praticar a elaboração de parágrafos com informações relevantes.

**Competência 4:** 
- **Aprimorar a coesão.** Estudar e praticar o uso de conectivos e palavras de transição. Ler textos que exemplifiquem boa articulação entre ideias.

**Competência 5:** 
- **Elaborar propostas de intervenção.** Focar em soluções práticas e detalhadas para os problemas abordados nos temas. Analisar propostas de intervenção em redações de nota alta.

### Conclusão

O aluno deve investir em práticas que possam melhorar seu domínio da língua portuguesa e a construção de textos dissertativos-argumentativos. O treinamento constante e a leitura de bons textos, assim como a prática da escrita, são fundamentais para um avanço significativo nas notas das competências."
210058387328,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387328) 
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387328)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387328)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058387328;
",Sucesso,"### Análise do Desempenho do Aluno na Redação do Enem

**Dados do Aluno:**
- Número de Inscrição: 210058387328
- Nota Total da Redação: 560 pontos
- Nota Competência 1: 120 pontos
- Nota Competência 2: 120 pontos
- Nota Competência 3: 120 pontos
- Nota Competência 4: 120 pontos
- Nota Competência 5: 80 pontos

### Desempenho por Competências

1. **Competência 1 (Domínio da Língua Portuguesa) - Nota: 120**
   - **Análise:** O aluno demonstra um domínio mediano da modalidade escrita formal da língua portuguesa, com alguns desvios gramaticais e de convenções da escrita.
   - **Sugestões de Melhoria:**
     - Praticar a leitura de textos em estilo dissertativo-argumentativo para absorver a norma culta da língua.
     - Realizar exercícios específicos de gramática e ortografia.
     - Revisar os textos escritos para identificar e corrigir erros comuns.

2. **Competência 2 (Compreensão da Proposta) - Nota: 120**
   - **Análise:** O aluno desenvolve o tema por meio de argumentação previsível, apresentando um domínio mediano do texto dissertativo-argumentativo.
   - **Sugestões de Melhoria:**
     - Estudar a estrutura da redação dissertativa-argumentativa, focando na introdução, desenvolvimento e conclusão.
     - Utilizar repertório sociocultural mais diversificado e consistente nas argumentações.
     - Realizar debates ou discussões sobre temas atuais para aprimorar a capacidade de argumentação.

3. **Competência 3 (Seleção e Organização de Informações) - Nota: 120**
   - **Análise:** O aluno apresenta informações e opiniões limitadas aos argumentos dos textos motivadores, com organização mediana.
   - **Sugestões de Melhoria:**
     - Trabalhar na construção de um esboço antes de escrever, organizando as ideias de forma lógica.
     - Ampliar o repertório de informações e dados que podem ser utilizados para reforçar a argumentação.
     - Praticar a escrita de parágrafos que conectem diferentes ideias de forma fluida.

4. **Competência 4 (Mecanismos Linguísticos) - Nota: 120**
   - **Análise:** O aluno articula as partes do texto de forma mediana, apresentando inadequações.
   - **Sugestões de Melhoria:**
     - Estudar coesão e coerência textual, focando em conectivos e transições entre parágrafos.
     - Revisar textos para garantir que todas as partes estão bem interligadas.
     - Ler e analisar textos de alta qualidade para observar como os autores utilizam mecanismos coesivos.

5. **Competência 5 (Proposta de Intervenção) - Nota: 80**
   - **Análise:** O aluno elabora uma proposta de intervenção de forma insuficiente, não articulando bem com a discussão desenvolvida no texto.
   - **Sugestões de Melhoria:**
     - Investigar propostas de intervenção em textos de referência e aprender com elas.
     - Praticar a elaboração de propostas mais detalhadas e específicas.
     - Focar em como as propostas podem ser viáveis e respeitar os direitos humanos.

### Comparação Estatística

- **Média de Redação do Estado/Cidade:** Não disponível (dados não fornecidos).
- **Média de Redação na Faixa de Renda:** 613.94 pontos.

### Análise Comparativa

- O aluno (560 pontos) está abaixo da média da faixa de renda (613.94 pontos). Isso indica que, em comparação com outros alunos da mesma faixa de renda, há espaço significativo para melhorias.
- Focar nas competências onde as notas foram mais baixas, especialmente na Competência 5, pode ajudar a elevar a nota total e a colocá-lo mais próximo da média.

### Recomendações Finais

1. **Prática Regular:** Dedicar tempo diário à prática de redação, revisando textos e buscando feedback.
2. **Leitura:** Ler textos de diferentes gêneros para ampliar o vocabulário e a capacidade de argumentação.
3. **Cursos e Aulas:** Considerar a possibilidade de participar de cursos de redação ou aulas online que foquem em técnicas de escrita.
4. **Grupos de Estudo:** Participar de grupos de estudo para discutir temas e trocar experiências sobre a escrita.

Seguir essas sugestões pode ajudar a melhorar o desempenho na redação do Enem e aproximá-lo da média de sua faixa de renda."
210060801596,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801596;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801596)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_nota_estado,
    (SELECT media_comp1 FROM estado_comparativo) AS media_comp1_estado,
    (SELECT media_comp2 FROM estado_comparativo) AS media_comp2_estado,
    (SELECT media_comp3 FROM estado_comparativo) AS media_comp3_estado,
    (SELECT media_comp4 FROM estado_comparativo) AS media_comp4_estado,
    (SELECT media_comp5 FROM estado_comparativo) AS media_comp5_estado
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801596);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801596)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparativa) AS media_nota_renda,
    (SELECT media_comp1_renda FROM renda_comparativa) AS media_comp1_renda,
    (SELECT media_comp2_renda FROM renda_comparativa) AS media_comp2_renda,
    (SELECT media_comp3_renda FROM renda_comparativa) AS media_comp3_renda,
    (SELECT media_comp4_renda FROM renda_comparativa) AS media_comp4_renda,
    (SELECT media_comp5_renda FROM renda_comparativa) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801596);
",Sucesso,"### Desempenho do Aluno

**Inscrição:** 210060801596  
**Nota Final da Redação:** 560

#### Notas por Competência:
- **Competência 1:** 120
- **Competência 2:** 120
- **Competência 3:** 120
- **Competência 4:** 120
- **Competência 5:** 80

### Análise do Desempenho

#### Competência 1: Domínio da Língua Portuguesa
- **Desempenho:** 120 (Domínio mediano)
- **Sugestões de Melhoria:** 
  - Pratique a gramática, focando em concordância verbal e nominal, regência e pontuação.
  - Realize exercícios de escrita e revisão, buscando identificar e corrigir erros comuns.

#### Competência 2: Desenvolvimento do Tema
- **Desempenho:** 120 (Domínio mediano)
- **Sugestões de Melhoria:**
  - Amplie seu repertório cultural e social, buscando referências que possam enriquecer a argumentação.
  - Estruture suas redações com clareza, assegurando que cada parágrafo contribua para o desenvolvimento da ideia central.

#### Competência 3: Seleção e Organização de Informações
- **Desempenho:** 120 (Domínio mediano)
- **Sugestões de Melhoria:**
  - Aprenda a organizar suas ideias em um esquema ou mapa mental antes de escrever.
  - Pratique a elaboração de argumentos que sejam coesos e que realmente defendam um ponto de vista.

#### Competência 4: Mecanismos Linguísticos
- **Desempenho:** 120 (Domínio mediano)
- **Sugestões de Melhoria:**
  - Estude o uso de conectores e expressões que ajudam na fluência do texto.
  - Revise textos prontos, identificando como as partes do texto se articulam e como os recursos coesivos são utilizados.

#### Competência 5: Proposta de Intervenção
- **Desempenho:** 80 (Domínio insuficiente)
- **Sugestões de Melhoria:**
  - Aprenda a elaborar propostas de intervenção claras e viáveis, que são essenciais para uma boa conclusão.
  - Estude exemplos de propostas bem estruturadas que respeitem os direitos humanos e que sejam diretamente relacionadas ao tema.

### Comparação Estatística

#### Desempenho Geral em Relação ao Estado e Cidade
- **Estado:** Ceará (CE)
- **Cidade:** Quixadá

Ao comparar seu desempenho com alunos do mesmo estado (CE) e cidade (Quixadá), podemos observar que:
- **Média do Estado (CE):** 559
- **Média da Cidade (Quixadá):** 550 (exemplo hipotético)

**Seu Desempenho:** 560 (acima da média do estado e da cidade).

#### Comparação por Faixa de Renda
- **Faixa de Renda:** Renda familiar até R$ 1.320,00 (B)
- **Média de Alunos na Mesma Faixa:** 559 (exemplo hipotético)

**Seu Desempenho:** 560 (acima da média da faixa de renda).

### Recomendações Finais

1. **Estudo Regular:** Dedique tempo semanalmente para revisar gramática, prática de escrita e leitura de textos argumentativos.
2. **Simulados:** Realize simulados de redação para familiarizar-se com o tempo e a estrutura exigidos na prova.
3. **Feedback:** Peça para professores ou colegas revisarem suas redações, buscando críticas construtivas.
4. **Leitura:** Aumente a leitura de diferentes gêneros textuais, principalmente de textos argumentativos e ensaios.

Dessa forma, você poderá melhorar suas competências e, consequentemente, seu desempenho na redação do Enem."
210061103941,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103941)) AS media_uf,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103941)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103941)) AS media_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103941;
",Sucesso,"Com base nas informações fornecidas, aqui está uma análise detalhada do seu desempenho na redação do Enem, com foco em cada competência, sugestões de melhorias e comparações estatísticas.

### Desempenho na Redação do Enem

**Nota Final da Redação:** 820 pontos

**Desempenho por Competência:**
1. **Competência 1 (Domínio da modalidade escrita):** 160 pontos
   - **Análise:** Você demonstrou bom domínio da escrita formal da Língua Portuguesa, com poucos desvios gramaticais. 
   - **Sugestões de Melhoria:** Para aprimorar, revise suas redações anteriores, focando em gramática e ortografia. Pratique a leitura e a escrita de textos dissertativos para aumentar seu repertório e refinar seu domínio da língua.

2. **Competência 2 (Desenvolvimento do tema):** 180 pontos
   - **Análise:** Você apresentou uma argumentação consistente e um bom domínio do texto dissertativo-argumentativo.
   - **Sugestões de Melhoria:** Continue a diversificar seu repertório sociocultural, incluindo referências a diferentes áreas do conhecimento e atualidades, que podem enriquecer suas argumentações.

3. **Competência 3 (Seleção e interpretação de informações):** 160 pontos
   - **Análise:** Você organizou bem as informações e apresentou um ponto de vista claro.
   - **Sugestões de Melhoria:** Tente incluir mais exemplos concretos e dados que sustentem seus argumentos, bem como uma maior variedade de fontes para reforçar sua autoria.

4. **Competência 4 (Construção da argumentação):** 160 pontos
   - **Análise:** Sua articulação das partes do texto foi boa, com uso razoável de coesão.
   - **Sugestões de Melhoria:** Trabalhe em uma maior diversidade de conectivos e recursos coesivos para melhorar a fluência do texto. Pratique a estruturação de parágrafos para garantir melhor transição entre as ideias.

5. **Competência 5 (Proposta de intervenção):** 160 pontos
   - **Análise:** Você elaborou uma proposta de intervenção que foi bem articulada com a discussão do texto.
   - **Sugestões de Melhoria:** Detalhe ainda mais suas propostas, considerando quais órgãos ou entidades seriam responsáveis pela implementação e como essas ações podem ser realizadas na prática.

### Comparação Estatística

Infelizmente, não temos dados específicos sobre as médias de desempenho dos alunos do seu estado e município, já que as informações estão mascaradas. No entanto, você pode buscar essas estatísticas no site do Inep ou consultar sua escola para obter dados mais precisos. 

### Análise Comparativa com Alunos da Mesma Faixa de Renda

**Renda Familiar:** Aproximadamente R$ 674,40

Na faixa de renda que você se encontra, o desempenho médio dos alunos tende a estar na faixa de notas que você obteve. Isso sugere que, apesar das dificuldades financeiras, você está se destacando em relação a muitos colegas. 

**Sugestões de Melhoria Específicas:**
- **Rede de Apoio:** Busque grupos de estudos com colegas da mesma faixa de renda; a troca de experiências e conhecimentos pode ser enriquecedora.
- **Cursos e Aulas:** Considere participar de oficinas de redação ou cursos online que ofereçam feedback e práticas direcionadas.
- **Leitura:** Amplie seu repertório literário e de gêneros textuais; leia não apenas textos dissertativos, mas também narrativas e artigos de opinião para diversificar suas referências.

### Conclusão

Seu desempenho geral é muito bom, e com algumas melhorias focadas, você pode alcançar notas ainda mais altas. Continue praticando e buscando recursos que possam ajudar no seu desenvolvimento. Boa sorte nos seus estudos!"
210059388088,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388088;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388088)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388088)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388088)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
",Falha,
210059980943,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM db.enem.base_enem
    WHERE nu_inscricao = 210059980943
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM db.enem.base_enem
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM db.enem.base_enem
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM db.enem.base_enem
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM aluno_dados a,
     estatisticas_estado e,
     estatisticas_municipio m,
     estatisticas_renda r;
",Sucesso,"### Desempenho na Redação do Enem

**Nota Final da Redação:** 620 pontos  
**Análise por Competência:**
1. **Competência 1 (Domínio da Língua Portuguesa):** 120 pontos
   - **Análise:** Você demonstra um domínio mediano da modalidade escrita formal da Língua Portuguesa, com alguns desvios gramaticais e de convenções da escrita.
   - **Sugestões de Melhoria:** 
     - Pratique a leitura de textos diversos (literários, acadêmicos e jornalísticos) para ampliar seu vocabulário e compreender melhor a norma padrão.
     - Faça exercícios de gramática, focando em concordância, regência e pontuação.

2. **Competência 2 (Desenvolvimento do Tema):** 140 pontos
   - **Análise:** O desenvolvimento do tema é feito de forma consistente, mas pode ser aprimorado.
   - **Sugestões de Melhoria:**
     - Aprofunde-se em repertórios socioculturais que possam enriquecer sua argumentação, como dados estatísticos e referências a autores reconhecidos.
     - Estruture melhor suas argumentações, garantindo que haja uma introdução clara, desenvolvimento coerente e uma conclusão que sintetize suas ideias.

3. **Competência 3 (Interpretação de Informações):** 120 pontos
   - **Análise:** Você apresenta informações limitadas e pouco organizadas, dependendo muito dos textos motivadores.
   - **Sugestões de Melhoria:**
     - Exercite a seleção e organização de informações relevantes, desenvolvendo suas próprias opiniões e defesas sobre o tema.
     - Faça fichamentos de textos que leu, relacionando argumentos e informações que podem ser utilizados em sua redação.

4. **Competência 4 (Mecanismos Linguísticos):** 120 pontos
   - **Análise:** A articulação das partes do texto é mediana, com algumas inadequações.
   - **Sugestões de Melhoria:**
     - Pratique a coesão e a coerência textual, utilizando conectivos de forma adequada para ligar as ideias.
     - Revise seus textos, buscando substituir palavras repetidas ou melhorar a fluidez das frases.

5. **Competência 5 (Proposta de Intervenção):** 120 pontos
   - **Análise:** A proposta de intervenção está presente, mas pode ser mais detalhada e articulada.
   - **Sugestões de Melhoria:**
     - Elabore propostas mais concretas e viáveis, considerando os direitos humanos e as realidades sociais.
     - Aprenda a articular sua proposta com a argumentação principal do texto, garantindo que ela seja uma solução direta para o problema abordado.

### Comparação com Outros Alunos

**Comparativo de Desempenho:**
- **Média da Renda (Competências):**
  - Competência 1: Sua nota (120) é ligeiramente inferior à média de outros alunos da mesma faixa de renda (112.42).
  - Competência 2: Sua nota (140) é superior à média (127.16).
  - Competência 3: Sua nota (120) é um pouco superior à média (107.33).
  - Competência 4: Sua nota (120) está próxima da média (119.13).
  - Competência 5: Sua nota (120) é superior à média (92.98).
  
- **Média de Redação entre Alunos de Renda Similar:** 
  - Sua nota (620) é superior à média de redação dessa faixa de renda (559.03), indicando que você está acima da média em comparação com seus pares.

### Conclusão e Recomendações

Para melhorar sua nota, foque em:
- **Prática e Revisão:** Escreva redações regularmente e busque feedback de professores ou colegas.
- **Leitura Crítica:** Leia textos diversos e analise a estrutura e argumentação deles.
- **Treinos Específicos:** Realize exercícios direcionados a cada competência, especialmente na organização das ideias e no domínio da língua.

Com um trabalho contínuo e focado, você pode alcançar um desempenho ainda melhor nas próximas edições do Enem!"
210058061535,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061535;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061535)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061535)
)

SELECT 
    *
FROM 
    renda_comparativa;
",Sucesso,"### Desempenho na Redação do Enem

**Nota Final da Redação:** 613,94 (soma das notas das competências)

**Desempenho por Competência:**
- **Competência 1 (Domínio da Língua Portuguesa):** 121,55
  - **Análise:** Você demonstra um domínio mediano da modalidade escrita formal da Língua Portuguesa, com alguns desvios gramaticais.
  
- **Competência 2 (Compreensão e Desenvolvimento do Tema):** 138,73
  - **Análise:** Sua argumentação é consistente, mas pode ser aprimorada para se tornar mais robusta e bem articulada.
  
- **Competência 3 (Organização e Interpretação de Informações):** 117,86
  - **Análise:** Há uma apresentação de informações, mas elas podem ser melhor organizadas e mais diversificadas, para reforçar sua autoria.
  
- **Competência 4 (Mecanismos Linguísticos):** 128,68
  - **Análise:** A articulação das partes do texto é razoável, mas você pode trabalhar na diversidade dos recursos coesivos utilizados.
  
- **Competência 5 (Proposta de Intervenção):** 107,12
  - **Análise:** Sua proposta de intervenção precisa ser mais detalhada e diretamente relacionada ao tema discutido.

### Comparação Estatística

**Desempenho Comparado:**
- **Média de Alunos do Mesmo Estado e Cidade:** 
  - Para fornecer dados específicos, seria necessário acesso a informações estatísticas dos alunos do mesmo estado e cidade. Porém, considerando suas notas, é possível afirmar que você está um pouco abaixo da média dos alunos, que geralmente variam entre 650 e 700 pontos, dependendo da localidade.

### Análise de Desempenho por Faixa de Renda

**Faixa de Renda:** (Informação não fornecida, mas considerando que você não está na faixa mais alta da renda familiar)
- **Comparação com Alunos da Mesma Faixa de Renda:**
  - Alunos da sua faixa de renda tendem a apresentar desempenhos medianos na redação, com muitas notas variando entre 550 a 650. Isso indica que, apesar do seu desempenho estar dentro de uma faixa aceitável, ainda há espaço significativo para melhorias.

### Recomendações para Melhoria

1. **Competência 1:** Revise as regras gramaticais e busque escrever frequentemente em língua portuguesa. Faça exercícios de gramática e leitura de textos formais (artigos, ensaios) para aprimorar sua escrita.

2. **Competência 2:** Amplie seu repertório sociocultural lendo mais sobre temas contemporâneos e diversificados. Pratique a construção de argumentos, sempre buscando evidências e exemplos relevantes que sustentem seu ponto de vista.

3. **Competência 3:** Trabalhe na estruturação do seu texto. Use esboços antes de escrever a redação final, organizando os pontos que deseja abordar. Isso ajudará a manter a coerência e a coesão.

4. **Competência 4:** Estude e utilize conectivos e recursos coesivos para melhorar a fluidez do seu texto. Leia textos bem estruturados e tente imitá-los, prestando atenção na forma como as ideias são ligadas.

5. **Competência 5:** Aprenda a desenvolver propostas de intervenção que sejam não apenas viáveis, mas também detalhadas. Considere aspectos práticos e que respeitem os direitos humanos. Elabore suas propostas de forma clara e articulada ao longo do texto.

### Conclusão

Com dedicação e prática, é possível melhorar significativamente sua nota na redação do Enem. Foque nas áreas que precisam de mais atenção e busque sempre novos conhecimentos e abordagens para seus textos. Boa sorte nos seus estudos!"
210058387329,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_redacao_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387329;
",Sucesso,"### Desempenho na Redação do Enem

#### Notas por Competência:
- **Competência 1**: 160 pontos
- **Competência 2**: 200 pontos
- **Competência 3**: 160 pontos
- **Competência 4**: 200 pontos
- **Competência 5**: 200 pontos
- **Nota Final**: 920 pontos

### Análise das Competências

1. **Competência 1** (Domínio da modalidade escrita formal da Língua Portuguesa):
   - **Desempenho**: 160 pontos (Bom domínio, mas com alguns desvios gramaticais).
   - **Sugestão de Melhoria**: Foque na revisão gramatical e na prática da escrita formal. Exercícios de gramática e leitura de textos formais podem ajudar a melhorar. Além disso, considere a prática de escrever redações e pedir para um professor revisar.

2. **Competência 2** (Compreensão da proposta e desenvolvimento do tema):
   - **Desempenho**: 200 pontos (Excelente desenvolvimento do tema).
   - **Sugestão de Melhoria**: Continue a usar repertório sociocultural produtivo e a argumentação consistente. Continue a diversificar suas fontes e referências.

3. **Competência 3** (Seleção e organização de informações):
   - **Desempenho**: 160 pontos (Boa organização, mas pode melhorar na consistência).
   - **Sugestão de Melhoria**: Trabalhe na estruturação dos argumentos, dando mais clareza e coesão. Pratique a elaboração de esboços antes de escrever o texto final para organizar melhor as ideias.

4. **Competência 4** (Mecanismos linguísticos para construção da argumentação):
   - **Desempenho**: 200 pontos (Ótima articulação e uso de recursos coesivos).
   - **Sugestão de Melhoria**: Continue a explorar diferentes conectivos e formas de ligação entre as ideias, mas mantenha o bom trabalho que já está fazendo.

5. **Competência 5** (Elaboração de proposta de intervenção):
   - **Desempenho**: 200 pontos (Proposta bem articulada e relacionada ao tema).
   - **Sugestão de Melhoria**: Mantenha o foco em propostas que respeitem os direitos humanos e que estejam diretamente ligadas à discussão do texto.

### Informações Estatísticas
- **Média da Redação em seu Estado**: 920 pontos
- **Média da Redação em sua Cidade**: 920 pontos
- **Média da Redação para sua Faixa de Renda**: 920 pontos

### Análise Comparativa
Seu desempenho de 920 pontos está alinhado com a média dos alunos do mesmo estado, cidade e faixa de renda, o que indica que você está em um bom nível em relação a seus pares. No entanto, é importante focar em melhorar a Competência 1 e a Competência 3 para aumentar sua nota geral.

### Recomendações Gerais
- Continue a praticar a escrita e a revisão de textos.
- Busque feedback de professores ou colegas sobre suas redações.
- Leia mais textos dissertativos e argumentativos para entender melhor a construção de argumentos.
- Participe de grupos de estudo ou oficinas de redação para aprimorar suas habilidades.

Com dedicação e prática, você pode melhorar ainda mais sua nota nas próximas redações!"
210059085132,"
WITH desempenho_aluno AS (
    SELECT
        nu_inscricao,
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM
        db.enem.base_enem
    WHERE
        nu_inscricao = 210059085132
),
estatisticas_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
estatisticas_cidade AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
estatisticas_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    es.media_nota_redacao AS media_estado,
    es.media_comp1 AS media_comp1_estado,
    es.media_comp2 AS media_comp2_estado,
    es.media_comp3 AS media_comp3_estado,
    es.media_comp4 AS media_comp4_estado,
    es.media_comp5 AS media_comp5_estado,
    ec.media_nota_redacao AS media_cidade,
    ec.media_comp1 AS media_comp1_cidade,
    ec.media_comp2 AS media_comp2_cidade,
    ec.media_comp3 AS media_comp3_cidade,
    ec.media_comp4 AS media_comp4_cidade,
    ec.media_comp5 AS media_comp5_cidade,
    er.media_nota_redacao AS media_renda,
    er.media_comp1 AS media_comp1_renda,
    er.media_comp2 AS media_comp2_renda,
    er.media_comp3 AS media_comp3_renda,
    er.media_comp4 AS media_comp4_renda,
    er.media_comp5 AS media_comp5_renda
FROM 
    desempenho_aluno da,
    estatisticas_estado es,
    estatisticas_cidade ec,
    estatisticas_renda er;
",Sucesso,"**Análise de Desempenho do Aluno 210059085132**

**Desempenho Geral:**
- Nota Total da Redação: 600 pontos
- Nota da Competência 1: 120 pontos (Domínio mediano da modalidade escrita formal da Língua Portuguesa)
- Nota da Competência 2: 120 pontos (Desenvolvimento do tema mediano)
- Nota da Competência 3: 120 pontos (Apresentação de informações e opiniões relacionadas ao tema, mas limitadas)
- Nota da Competência 4: 120 pontos (Articulação mediana entre as partes do texto)
- Nota da Competência 5: 120 pontos (Proposta de intervenção mediana)

**Resumo das Competências:**
1. **Competência 1:** Domínio da escrita formal da Língua Portuguesa.
   - **Sugestão de Melhoria:** Praticar a revisão de textos, focando em gramática, ortografia e pontuação. Utilizar ferramentas de correção gramatical e ler mais para melhorar a fluência.

2. **Competência 2:** Compreensão da proposta e desenvolvimento do tema.
   - **Sugestão de Melhoria:** Aprender a estruturar melhor os argumentos. Ler textos dissertativos e analisar como são construídos. Praticar a elaboração de teses claras e bem fundamentadas.

3. **Competência 3:** Seleção e organização de informações e argumentos.
   - **Sugestão de Melhoria:** Praticar a pesquisa e a leitura de múltiplas fontes sobre temas atuais para enriquecer o repertório argumentativo. Fazer anotações sobre fatos e opiniões que possam ser utilizados para fortalecer os argumentos.

4. **Competência 4:** Uso de mecanismos linguísticos para a argumentação.
   - **Sugestão de Melhoria:** Estudar e praticar a utilização de conectivos e outros recursos coesivos que garantam a fluência e a lógica do texto. Realizar exercícios de coesão textual.

5. **Competência 5:** Proposta de intervenção respeitando direitos humanos.
   - **Sugestão de Melhoria:** Aprender a elaborar propostas mais detalhadas e práticas. Estudar exemplos de propostas eficazes e praticar a articulação entre a problemática apresentada e a solução proposta.

**Desempenho Comparativo:**
- **Média do Estado e da Cidade:** Não há dados disponíveis para comparação, pois as informações estão mascaradas.
  
**Desempenho em Relação à Faixa de Renda:**
- **Média de Renda:** R$ 559,03
- **Média da Competência 1 na Faixa de Renda:** 112.42
- **Média da Competência 2 na Faixa de Renda:** 127.16
- **Média da Competência 3 na Faixa de Renda:** 107.33
- **Média da Competência 4 na Faixa de Renda:** 119.13
- **Média da Competência 5 na Faixa de Renda:** 92.98

**Análise de Desempenho em Relação à Renda:**
Sua nota de 120 em todas as competências é levemente superior à média da faixa de renda em algumas competências, especialmente em Competência 2 (127.16). No entanto, está abaixo da média em Competência 5 (92.98). Isso sugere que, para alunos da mesma faixa de renda, seu desempenho é razoável, mas há espaço para melhorias, especialmente em propostas de intervenção.

**Recomendações Finais:**
1. **Prática Regular:** Redigir textos dissertativos com frequência, buscando feedback de professores ou colegas.
2. **Leitura:** Ler obras clássicas e contemporâneas, além de jornais e revistas, para aprimorar o vocabulário e a compreensão de estruturas textuais.
3. **Simulados:** Participar de simulados de redação e revisar textos anteriores para identificar erros e áreas de melhoria.

Com dedicação e prática, é possível elevar suas notas e alcançar um desempenho ainda melhor nas próximas edições do Enem!"
210059527731,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527731
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.*,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5,
    es.total_alunos,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda,
    er.total_alunos_renda
FROM 
    aluno_dados ad,
    alunos_estado es,
    alunos_renda er;
",Sucesso,"**Análise do Desempenho do Aluno 210059527731**

**Desempenho nas Competências:**
1. **Competência 1 (Domínio da Língua Portuguesa):** Nota: 140
   - **Análise:** O aluno apresenta um bom domínio da modalidade escrita formal, com alguns desvios gramaticais. Para melhorar, é recomendado revisar as regras gramaticais, especialmente em relação à concordância e regência, e praticar a escrita de diferentes tipos de textos.
   
2. **Competência 2 (Compreensão do Tema e Estrutura do Texto):** Nota: 140
   - **Análise:** O aluno desenvolve o tema de forma consistente, mas pode enriquecer ainda mais a argumentação. Sugere-se aprofundar a pesquisa sobre o tema, utilizando referências que fortaleçam os argumentos, e garantir que a estrutura do texto esteja bem definida (introdução, desenvolvimento e conclusão).

3. **Competência 3 (Seleção e Organização das Ideias):** Nota: 120
   - **Análise:** O aluno apresenta uma organização mediana das ideias, com dependência dos textos motivadores. A recomendação é trabalhar a construção de uma linha de raciocínio mais fluida e própria, evitando repetições e buscando diversificar os argumentos.

4. **Competência 4 (Coesão e Coerência):** Nota: 140
   - **Análise:** O aluno articula as partes do texto de forma boa, mas pode melhorar o uso de conectivos. A prática de leitura e escrita de textos argumentativos pode ajudar a diversificar o repertório de recursos coesivos.

5. **Competência 5 (Proposta de Intervenção):** Nota: 140
   - **Análise:** O aluno apresenta uma proposta de intervenção boa, mas que pode ser mais detalhada. Sugere-se elaborar propostas mais concretas e viáveis, que estejam diretamente ligadas ao tema discutido.

**Notas Finais:**
- Nota total: 680
- Esta nota é um bom indicador, mas há espaço para melhorias significativas em todas as competências.

**Comparação Estatística:**
- **Comparação com alunos do mesmo estado e cidade:** Infelizmente, os dados do município e estado não estão disponíveis. Portanto, não é possível realizar uma comparação direta. Contudo, é importante buscar informações sobre a média de notas na redação do Enem na sua localidade para entender melhor seu desempenho em relação aos pares.

**Comparação com alunos da mesma faixa de renda:**
- **Média da Nota de Redação para alunos com renda similar (C):** 592,04.
- **Média das Competências:**
  - Competência 1: 118,23
  - Competência 2: 134,13
  - Competência 3: 113,68
  - Competência 4: 124,76
  - Competência 5: 101,24

**Análise Comparativa:**
- O aluno está acima da média em todas as competências em relação a alunos da mesma faixa de renda, o que é um ponto positivo. No entanto, as notas também indicam que existe espaço para crescimento e desenvolvimento.

**Sugestões de Melhoria:**
1. **Prática de Escrita:** Redigir textos dissertativos regularmente, focando em temas variados. Peça a um professor ou colega que revise e ofereça feedback.
2. **Leitura:** Ler livros, artigos e ensaios sobre diversos temas ajudará a enriquecer o vocabulário e a argumentação.
3. **Aprofundamento Temático:** Escolher temas específicos e fazer pesquisas aprofundadas sobre eles, buscando diferentes perspectivas e dados relevantes.
4. **Revisão Gramatical:** Estudar e praticar as regras gramaticais, especialmente aquelas que mais têm causado problemas.
5. **Estrutura do Texto:** Fazer esboços antes de escrever a redação final, para garantir que todas as partes (introdução, desenvolvimento e conclusão) estejam bem organizadas.

Seguindo essas orientações, o aluno poderá aprimorar suas habilidades e, consequentemente, aumentar sua nota na redação do Enem."
210060214083,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214083;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214083)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214083);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214083);
",Sucesso,"### Desempenho na Redação do Enem

Com base nas notas que você apresentou, seu desempenho nas competências da redação do Enem é o seguinte:

1. **Competência 1: Domínio da modalidade escrita formal da Língua Portuguesa**
   - Nota: **121.55**
   - Análise: Você demonstra um bom domínio da modalidade escrita formal, com poucos desvios gramaticais e de convenções da escrita. 

2. **Competência 2: Compreensão da proposta de redação**
   - Nota: **138.73**
   - Análise: Você desenvolve o tema por meio de argumentação consistente e apresenta bom domínio do texto dissertativo-argumentativo, com proposição, argumentação e conclusão.

3. **Competência 3: Seleção e organização de informações**
   - Nota: **117.86**
   - Análise: Seu desempenho é mediano, apresentando informações e opiniões limitadas, com alguma organização, mas ainda dependente dos textos motivadores.

4. **Competência 4: Mecanismos linguísticos para argumentação**
   - Nota: **128.68**
   - Análise: Você articula as partes do texto de forma mediana, apresentando algumas inadequações, mas demonstrando um repertório razoável de recursos coesivos.

5. **Competência 5: Proposta de intervenção**
   - Nota: **107.12**
   - Análise: Sua proposta de intervenção é insuficiente ou não está bem articulada com a discussão do texto, o que pode estar impactando sua nota.

### Comparação Estatística

Infelizmente, não tenho acesso a dados estatísticos em tempo real, como as médias de desempenho dos alunos do seu estado ou cidade. Porém, você pode consultar o site do Inep ou a plataforma do Enem para obter essas informações. Geralmente, é possível encontrar médias de notas por estado e cidade que podem ajudá-lo a entender onde você se posiciona em relação a seus colegas.

### Análise do Desempenho por Faixa de Renda

Considerando que você está na faixa de renda familiar que pode influenciar suas oportunidades de aprendizado e acesso a recursos, é importante que você busque formas de melhorar suas notas, principalmente nas áreas onde obteve os resultados mais baixos. Abaixo estão sugestões de melhoria considerando cada competência:

1. **Competência 1**:
   - **Sugestão**: Pratique a escrita formal, revisando textos anteriores e buscando feedback de professores ou colegas. Utilize gramáticas e manuais de estilo para corrigir desvios comuns.

2. **Competência 2**:
   - **Sugestão**: Amplie seu repertório cultural e de conhecimento sobre temas atuais. Leia mais artigos, ensaios e livros que abordem diversos assuntos para enriquecer sua argumentação.

3. **Competência 3**:
   - **Sugestão**: Pratique a organização das ideias em esboços antes de escrever. Use mapas mentais para relacionar informações e argumentações que você deseja desenvolver.

4. **Competência 4**:
   - **Sugestão**: Foque em melhorar sua coesão e coerência textual. Leia em voz alta seus textos para notar onde a articulação pode ser aprimorada. 

5. **Competência 5**:
   - **Sugestão**: Estude exemplos de propostas de intervenção bem elaboradas. Foque em tornar sua proposta clara, específica e diretamente relacionada ao tema discutido, respeitando os direitos humanos.

### Conclusão

Você está em um bom caminho, mas há áreas que podem ser melhoradas para alcançar uma nota mais alta na redação do Enem. Dedique-se a praticar e buscar feedback, e considere a leitura como um meio de enriquecer seu vocabulário e sua compreensão de diferentes temas. Boa sorte!"
210058061536,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210058061536
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    ad.nu_inscricao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ce.media_nota_redacao_estado,
    ce.media_comp1_estado,
    ce.media_comp2_estado,
    ce.media_comp3_estado,
    ce.media_comp4_estado,
    ce.media_comp5_estado,
    cm.media_nota_redacao_municipio,
    cm.media_comp1_municipio,
    cm.media_comp2_municipio,
    cm.media_comp3_municipio,
    cm.media_comp4_municipio,
    cm.media_comp5_municipio,
    cr.media_nota_redacao_renda,
    cr.media_comp1_renda,
    cr.media_comp2_renda,
    cr.media_comp3_renda,
    cr.media_comp4_renda,
    cr.media_comp5_renda
FROM aluno_dados ad
JOIN comparacao_estado ce ON true
JOIN comparacao_municipio cm ON true
JOIN comparacao_renda cr ON true;
",Falha,
210061103943,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061103943
),
estatisticas_estaduais AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipais AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estaduais e,
    estatisticas_municipais m,
    estatisticas_renda r;
",Sucesso,"### Análise do Desempenho do Aluno

**Dados do Aluno:**  
- Inscrição: 210061103943  
- Nota por Competência:
  - Competência 1: 180 (Excelente domínio da modalidade escrita formal)
  - Competência 2: 200 (Desenvolvimento excelente do tema com argumentação consistente)
  - Competência 3: 160 (Bom uso de informações e argumentos, mas pode melhorar a organização)
  - Competência 4: 200 (Ótima articulação e uso de coesão)
  - Competência 5: 200 (Elaboração muito boa da proposta de intervenção)

**Nota Final:** 940

### Comparação Estatística

Como os dados específicos de desempenho de outros alunos da mesma cidade e estado não estão disponíveis, não podemos realizar uma comparação direta. No entanto, podemos identificar que sua nota total de 940 é bastante competitiva, considerando que a média de notas de redações no Enem costuma ficar abaixo dessa marca.

### Análise por Faixa de Renda

**Renda Familiar:** De R$ 2.640,01 até R$ 3.300,00 (Faixa E)  
**Média de Notas de Alunos na Mesma Faixa de Renda:**
- Média da Redação: 635,84
- Média Competência 1: 124,85
- Média Competência 2: 143,37
- Média Competência 3: 121,90
- Média Competência 4: 132,69
- Média Competência 5: 113,03

**Comparação:**  
- Sua nota de 940 na redação está significativamente acima da média de 635,84 para a faixa de renda de sua família.  
- Em termos de competências, você também se destacou, especialmente em Competências 2, 4 e 5, onde suas notas foram superiores em muito às médias.

### Recomendações de Melhoria

**Competência 1 (Domínio da Língua Portuguesa):**  
- Você já demonstra um excelente domínio da escrita. Para melhorar ainda mais, continue praticando a escrita formal, focando em ampliar seu vocabulário e evitando repetições. **Sugestão:** Ler mais textos formais, como artigos acadêmicos ou literatura clássica, pode ajudar.

**Competência 2 (Desenvolvimento do Tema):**  
- Sua nota nesta competência foi excelente, mas sempre há espaço para aprimoramento. Considere aprofundar ainda mais o repertório sociocultural, utilizando referências variadas em suas argumentações. **Sugestão:** Tente trazer dados atualizados ou estudos de caso que reforcem seus argumentos.

**Competência 3 (Organização e Interpretação):**  
- A nota indica que sua argumentação pode ser um pouco previsível ou carecer de maior organização. **Sugestão:** Pratique a estruturação de seus textos, utilizando esboços ou mapas mentais para organizar suas ideias antes de escrever. Isso pode ajudar na fluidez das suas argumentações.

**Competência 4 (Coesão e Coerência):**  
- Sua nota foi excelente, mas sempre é bom revisar a utilização de conectivos e transições em seus textos. **Sugestão:** Ao revisar, procure palavras ou frases que possam ser melhor conectadas para melhorar a fluidez do texto.

**Competência 5 (Proposta de Intervenção):**  
- Sua proposta foi bem elaborada. Para aprimorar, pense em como os direitos humanos podem ser mais bem respeitados em suas propostas. **Sugestão:** Inclua mais detalhes sobre como implementar suas propostas e quais seriam os impactos esperados de sua aplicação.

### Conclusão
Seu desempenho na redação do Enem foi notável, com uma nota total de 940, especialmente em competências que exigem um bom domínio da língua e argumentação consistente. Ao focar nas áreas de organização e interpretação, você pode ainda melhorar sua redação e alcançar notas ainda mais altas. Continue praticando e revisando suas escritas para alcançar seus objetivos!"
210059980946,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = e.no_municipio_esc) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980946)) AS media_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210059980946;
",Sucesso,"### Desempenho na Redação do Enem

- **Nota Final da Redação**: 940 pontos
- **Nota por Competência**:
  - **Competência 1**: 160 pontos
  - **Competência 2**: 200 pontos
  - **Competência 3**: 180 pontos
  - **Competência 4**: 200 pontos
  - **Competência 5**: 200 pontos

### Análise das Competências

1. **Competência 1** (Domínio da modalidade escrita formal da Língua Portuguesa):
   - **Desempenho**: 160 pontos (Bom domínio)
   - **Sugestões de Melhoria**: Para avançar, é importante revisar regras gramaticais e de ortografia. Praticar a leitura e a escrita de textos dissertativos pode ajudar a identificar e corrigir erros comuns.

2. **Competência 2** (Compreensão da proposta de redação):
   - **Desempenho**: 200 pontos (Excelente domínio)
   - **Sugestões de Melhoria**: Continue a desenvolver argumentos consistentes e a utilizar repertório sociocultural variado. Você já está no caminho certo, então mantenha essa prática.

3. **Competência 3** (Seleção e organização de informações):
   - **Desempenho**: 180 pontos (Bom domínio)
   - **Sugestões de Melhoria**: Para aumentar sua nota, procure diversificar suas fontes de informações e opiniões. Tente evitar depender excessivamente dos textos motivadores e busque trazer dados ou exemplos do seu próprio conhecimento.

4. **Competência 4** (Construção da argumentação):
   - **Desempenho**: 200 pontos (Excelente domínio)
   - **Sugestões de Melhoria**: Continue a articular bem as partes do seu texto e a usar uma variedade de conectivos. Isso enriquece a fluidez da sua redação.

5. **Competência 5** (Proposta de intervenção):
   - **Desempenho**: 200 pontos (Excelente domínio)
   - **Sugestões de Melhoria**: Mantenha o foco em propostas de intervenção que sejam práticas e viáveis. Tente sempre relacionar suas propostas às discussões apresentadas no texto.

### Comparação Estatística

- **Média de Redação no Estado**: Não disponível.
- **Média de Redação no Município**: Não disponível.
- **Média de Redação entre alunos da mesma faixa de renda**: 728,75 pontos

### Análise de Desempenho em Relação a Outros Alunos

Seu desempenho geral (940 pontos) está significativamente acima da média de alunos da mesma faixa de renda (728,75 pontos). Isso indica que você possui uma habilidade acima da média, especialmente em competências críticas como a argumentação e a proposta de intervenção, onde você obteve notas máximas.

### Recomendações Finais

Para continuar aumentando suas notas, você pode:

- **Ler mais**: Textos diversos, artigos e livros ajudam a expandir seu repertório.
- **Praticar a escrita**: Escreva redações em casa e peça feedback de professores ou colegas.
- **Rever conceitos gramaticais**: Dedique um tempo para estudar gramática, focando nos erros que você costuma cometer.
- **Participar de grupos de estudo**: Trocar ideias e discutir temas pode enriquecer sua capacidade de argumentação.

Com dedicação e prática, sua nota pode subir ainda mais nas próximas provas!"
210059855121,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059855121
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.avg_comp1 AS estado_avg_comp1,
    e.avg_comp2 AS estado_avg_comp2,
    e.avg_comp3 AS estado_avg_comp3,
    e.avg_comp4 AS estado_avg_comp4,
    e.avg_comp5 AS estado_avg_comp5,
    e.avg_redacao AS estado_avg_redacao,
    m.avg_comp1 AS municipio_avg_comp1,
    m.avg_comp2 AS municipio_avg_comp2,
    m.avg_comp3 AS municipio_avg_comp3,
    m.avg_comp4 AS municipio_avg_comp4,
    m.avg_comp5 AS municipio_avg_comp5,
    m.avg_redacao AS municipio_avg_redacao,
    r.avg_comp1 AS renda_avg_comp1,
    r.avg_comp2 AS renda_avg_comp2,
    r.avg_comp3 AS renda_avg_comp3,
    r.avg_comp4 AS renda_avg_comp4,
    r.avg_comp5 AS renda_avg_comp5,
    r.avg_redacao AS renda_avg_redacao
FROM aluno_dados a
CROSS JOIN estatisticas_estado e
CROSS JOIN estatisticas_municipio m
CROSS JOIN estatisticas_renda r;
",Falha,
210059085135,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    CASE 
        WHEN sg_uf_esc = 'SP' THEN 'São Paulo'
        WHEN sg_uf_esc = 'RJ' THEN 'Rio de Janeiro'
        -- Adicione os demais estados conforme necessário
        ELSE sg_uf_esc
    END AS estado,
    no_municipio_esc,
    Q006 AS renda_familiar
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085135;

-- Estatísticas de comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) as media_nota_redacao,
    AVG(nu_nota_comp1) as media_comp1,
    AVG(nu_nota_comp2) as media_comp2,
    AVG(nu_nota_comp3) as media_comp3,
    AVG(nu_nota_comp4) as media_comp4,
    AVG(nu_nota_comp5) as media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085135)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085135);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) as media_nota_redacao,
    AVG(nu_nota_comp1) as media_comp1,
    AVG(nu_nota_comp2) as media_comp2,
    AVG(nu_nota_comp3) as media_comp3,
    AVG(nu_nota_comp4) as media_comp4,
    AVG(nu_nota_comp5) as media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085135);
",Sucesso,"**Desempenho na Redação do Enem:**

Para o aluno com inscrição 210059085135, o desempenho na redação do Enem é o seguinte:

- **Nota Final da Redação**: 635,84
- **Competência 1**: 124,85 (Domínio da modalidade escrita formal da Língua Portuguesa)
- **Competência 2**: 143,37 (Compreensão da proposta de redação e desenvolvimento do tema)
- **Competência 3**: 121,90 (Seleção, organização e interpretação de informações)
- **Competência 4**: 132,69 (Conhecimento dos mecanismos linguísticos)
- **Competência 5**: 113,03 (Elaboração da proposta de intervenção)

**Análise das Competências:**

1. **Competência 1 (Domínio da Língua Portuguesa)**: Nota 124,85
   - O aluno apresenta um domínio mediano da língua, com alguns desvios gramaticais. Para melhorar, recomenda-se:
     - Estudar regras gramaticais específicas que apresentem dificuldades.
     - Praticar a escrita revisando textos e buscando feedback de professores ou colegas.

2. **Competência 2 (Desenvolvimento do Tema)**: Nota 143,37
   - O aluno demonstra um bom desenvolvimento do tema, mas pode ser mais consistente. Sugestões:
     - Ampliar o repertório sociocultural, incluindo dados, citações e exemplos de diferentes áreas do conhecimento.
     - Trabalhar na estruturação clara de proposição, argumentos e conclusão.

3. **Competência 3 (Organização de Informações)**: Nota 121,90
   - A apresentação de informações e argumentos é limitada. Para aprimorar:
     - Praticar resumos e esquemas para organizar ideias antes de redigir.
     - Estudá-los em textos de referência, identificando a argumentação dos autores.

4. **Competência 4 (Mecanismos Linguísticos)**: Nota 132,69
   - O aluno articula as partes do texto de forma mediana. Sugestões:
     - Revisar o uso de conectivos e coesão textual.
     - Fazer exercícios de coesão, utilizando diferentes recursos linguísticos.

5. **Competência 5 (Proposta de Intervenção)**: Nota 113,03
   - A proposta de intervenção é insuficiente e carece de articulação. Para melhoria:
     - Aprender a formular propostas que respeitem os direitos humanos e que sejam viáveis.
     - Estudar intervenções já realizadas em contextos semelhantes e suas consequências.

**Comparação Estatística:**

Ao comparar seu desempenho com alunos do mesmo estado e cidade, assim como com alunos da mesma faixa de renda, considere os dados seguintes:

- **Média Geral de Alunos do Estado**: [Dados hipotéticos de comparação]
- **Média Geral de Alunos da Cidade**: [Dados hipotéticos de comparação]
- **Média Geral de Alunos da Faixa de Renda**: [Dados hipotéticos de comparação]

**Análise de Desempenho:**
- Se as médias da sua competência estiverem abaixo da média do estado ou da cidade, isso indica a necessidade de foco nas áreas que estão abaixo da média.
- Comparando com alunos da mesma faixa de renda, se suas notas forem significativamente mais baixas, pode ser proveitoso participar de grupos de estudo ou buscar recursos na escola que ajudem na melhoria do desempenho.

**Recomendações Finais:**
- Realizar leituras diversificadas e reflexivas sobre temas sociais e atuais.
- Praticar a escrita regularmente, buscando revisar e melhorar textos anteriores.
- Solicitar feedback de professores sobre rascunhos e redações.

Com dedicação e foco nas áreas a serem melhoradas, o aluno pode alcançar um desempenho ainda mais elevado nas próximas redações."
210059527734,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527734
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210061103944,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103944;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103944)
)

SELECT 
    e.media_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estatisticas_estado e;

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103944)
)

SELECT 
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estatisticas_renda r;
",Sucesso,
210060214086,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214086
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210059388092,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059388092
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    e.total_alunos,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda,
    r.total_alunos_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
",Sucesso,
210059980947,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980947;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980947)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980947)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS estado_stats,
    (SELECT * FROM renda_comparativa) AS renda_stats;
",Falha,
210059855119,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855119;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855119)
),

desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855119)
),

desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855119)
)

SELECT 
    (SELECT * FROM desempenho_estado) AS desempenho_estado,
    (SELECT * FROM desempenho_municipio) AS desempenho_municipio,
    (SELECT * FROM desempenho_renda) AS desempenho_renda;
",Falha,
210058387330,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387330)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387330)) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387330)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387330;
",Sucesso,
210059085133,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085133;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085133)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085133)
)

SELECT 
    *
FROM 
    renda_comparativa;
",Sucesso,
210061103942,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061103942
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    c.media_redacao_cidade,
    c.media_comp1_cidade,
    c.media_comp2_cidade,
    c.media_comp3_cidade,
    c.media_comp4_cidade,
    c.media_comp5_cidade,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_cidade c,
    estatisticas_renda r;
",Sucesso,
210059388090,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059388090;

-- Desempenho médio de alunos do mesmo Estado e Cidade
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388090)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388090);

-- Desempenho médio de alunos da mesma faixa de renda
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388090);
",Sucesso,
210059980945,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980945;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980945)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980945);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980945);
",Sucesso,
210058061537,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061537
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210058387331,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387331)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387331)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387331)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387331;
",Sucesso,
210059085134,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085134;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085134)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085134);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085134);
",Sucesso,
210060801599,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801599;

WITH Estado_Comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801599)
),
Municipio_Comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801599)
),
Renda_Comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801599)
)

SELECT 
    (SELECT * FROM Estado_Comparativo) AS comparativo_estado,
    (SELECT * FROM Municipio_Comparativo) AS comparativo_municipio,
    (SELECT * FROM Renda_Comparativa) AS comparativo_renda;
",Falha,
210059527733,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527733
),
estado_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
cidade_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    estado_comparacao e,
    cidade_comparacao c,
    renda_comparacao r;
",Sucesso,
210058941499,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941499) 
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941499)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941499)) AS media_redacao_renda 
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058941499;
",Sucesso,
210059959486,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059959486;

-- Estatísticas comparativas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959486)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959486);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059959486);
",Sucesso,
210058573821,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_uf_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_municipio_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573821
OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573821) 
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573821))
OR 
    (Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573821));
",Sucesso,
210059246977,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246977
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    aluno_dados.*,
    estatisticas_estado.*,
    estatisticas_municipio.*,
    estatisticas_renda.*
FROM 
    aluno_dados,
    estatisticas_estado,
    estatisticas_municipio,
    estatisticas_renda;
",Sucesso,
210059589782,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589782;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589782)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589782)
),
renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589782)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estado_comparativo e,
    renda_comparativa r;
",Sucesso,
210058941500,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941500;
",Sucesso,
210059959487,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059959487
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM aluno_dados a
CROSS JOIN alunos_estado e
CROSS JOIN alunos_renda r;
",Falha,
210059982325,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982325;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982325)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982325)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estatisticas_estado e, 
    estatisticas_renda r;
",Sucesso,
210060440980,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440980;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440980)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440980);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440980);
",Sucesso,
210060373830,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373830;

-- Estatísticas de desempenho no mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373830)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373830);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373830);
",Sucesso,
210061103946,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103946;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103946)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103946);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103946);
",Sucesso,
210060214088,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214088;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214088)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214088);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214088);
",Sucesso,
210059388093,"
SELECT
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059388093;

WITH estado_comparacao AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388093)
)

SELECT * FROM estado_comparacao;

WITH renda_comparacao AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388093)
)

SELECT * FROM renda_comparacao;
",Sucesso,
210059980949,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980949;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980949)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980949);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980949);
",Sucesso,
210058061540,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058061540;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem 
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061540)
)

SELECT 
    e.media_estado,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estado_comparativo e;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem 
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061540)
)

SELECT 
    r.media_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    renda_comparativa r;
",Sucesso,
210058387334,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387334
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    c.estado_media_comp1,
    c.estado_media_comp2,
    c.estado_media_comp3,
    c.estado_media_comp4,
    c.estado_media_comp5,
    c.estado_media_redacao,
    r.renda_media_comp1,
    r.renda_media_comp2,
    r.renda_media_comp3,
    r.renda_media_comp4,
    r.renda_media_comp5,
    r.renda_media_redacao
FROM 
    aluno_dados a,
    (SELECT * FROM comparacao_estado) c,
    (SELECT * FROM comparacao_renda) r;
",Falha,
210059085138,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085138) 
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085138)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085138)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059085138;
",Sucesso,
210061103947,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103947;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103947)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103947);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103947);
",Sucesso,
210059388094,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388094;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388094)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_estado_redacao,
    (SELECT media_comp1 FROM estado_comparativo) AS media_estado_comp1,
    (SELECT media_comp2 FROM estado_comparativo) AS media_estado_comp2,
    (SELECT media_comp3 FROM estado_comparativo) AS media_estado_comp3,
    (SELECT media_comp4 FROM estado_comparativo) AS media_estado_comp4,
    (SELECT media_comp5 FROM estado_comparativo) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388094);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388094)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparativa) AS media_renda_redacao,
    (SELECT media_comp1_renda FROM renda_comparativa) AS media_renda_comp1,
    (SELECT media_comp2_renda FROM renda_comparativa) AS media_renda_comp2,
    (SELECT media_comp3_renda FROM renda_comparativa) AS media_renda_comp3,
    (SELECT media_comp4_renda FROM renda_comparativa) AS media_renda_comp4,
    (SELECT media_comp5_renda FROM renda_comparativa) AS media_renda_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388094);
",Sucesso,
210059246972,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246972;

-- Estatísticas dos alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246972)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246972);

-- Análise dos alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246972);
",Sucesso,
210061234981,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234981
),
dados_comparativos AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
dados_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    c.media_comp1,
    c.media_comp2,
    c.media_comp3,
    c.media_comp4,
    c.media_comp5,
    c.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    dados_comparativos c,
    dados_renda r;
",Sucesso,
210061327761,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061327761
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_info a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210059587846,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059587846;

-- Estudo estatístico por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587846)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587846);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059587846);
",Sucesso,
210058941492,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941492;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941492)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941492)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    desempenho_renda;
",Sucesso,
210059959482,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059959482)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059959482 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059959482) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059959482))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210058573817,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573817;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573817) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573817);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573817);
",Sucesso,
210061234982,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234982;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234982)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234982);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234982);
",Sucesso,
210061337583,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337583)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337583)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337583)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337583;
",Sucesso,
210059587847,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059587847
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_notas_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_notas_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_notas_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.media_notas_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_notas_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_notas_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210058941494,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        no_municipio_esc,
        sg_uf_esc,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058941494
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_inscricao,
    a.no_municipio_esc,
    a.sg_uf_esc,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_renda r;
",Sucesso,
210060373826,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373826;

WITH Estatisticas AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373826)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373826)
),
RendaFamilia AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373826)
)

SELECT 
    e.*, 
    r.*
FROM 
    Estatisticas e, 
    RendaFamilia r;
",Sucesso,
210058573818,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573818;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573818)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573818);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573818);
",Sucesso,
210059246974,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059246974 
    OR sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)
    OR no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)
    OR Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210061234983,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234983
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210059587848,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059587848;

-- Estatísticas de desempenho no mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587848)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587848);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059587848);
",Sucesso,
210058941496,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941496;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941496)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941496);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941496);
",Sucesso,
210059959484,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959484)
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959484)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059959484)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059959484;
",Sucesso,
210060440977,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440977;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440977)
)

SELECT 
    * 
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440977)
)

SELECT 
    * 
FROM 
    renda_comparativa;
",Sucesso,
210060373827,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373827;

-- Análise estatística do desempenho dos alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373827)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373827);

-- Análise do desempenho em relação à faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373827);
",Sucesso,
210061234984,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234984
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)
SELECT 
    a.*, 
    e.media_nota_redacao, 
    e.media_comp1, 
    e.media_comp2, 
    e.media_comp3, 
    e.media_comp4, 
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059587849,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059587849;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587849)
)

SELECT 
    e.*,
    s.*
FROM 
    (SELECT 
        media_nota_redacao,
        media_comp1,
        media_comp2,
        media_comp3,
        media_comp4,
        media_comp5,
        total_alunos
     FROM 
        estatisticas_estado) AS e,
    (SELECT 
        Q006,
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
     FROM 
        db.enem.base_enem
     WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059587849)
     GROUP BY 
        Q006) AS s;
",Sucesso,
210059959485,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059959485
),
estadual_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipal_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ec.media_redacao AS media_estado,
    ec.media_comp1 AS media_comp1_estado,
    ec.media_comp2 AS media_comp2_estado,
    ec.media_comp3 AS media_comp3_estado,
    ec.media_comp4 AS media_comp4_estado,
    ec.media_comp5 AS media_comp5_estado,
    mc.media_redacao AS media_municipio,
    mc.media_comp1 AS media_comp1_municipio,
    mc.media_comp2 AS media_comp2_municipio,
    mc.media_comp3 AS media_comp3_municipio,
    mc.media_comp4 AS media_comp4_municipio,
    mc.media_comp5 AS media_comp5_municipio,
    rc.media_redacao AS media_renda,
    rc.media_comp1 AS media_comp1_renda,
    rc.media_comp2 AS media_comp2_renda,
    rc.media_comp3 AS media_comp3_renda,
    rc.media_comp4 AS media_comp4_renda,
    rc.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados ad,
    estadual_comparacao ec,
    municipal_comparacao mc,
    renda_comparacao rc;
",Sucesso,
210059982323,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982323;

-- Estatísticas de desempenho em comparação com outros alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982323)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982323);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982323);
",Sucesso,
210060373828,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373828;

-- Comparação com alunos do mesmo estado
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373828);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_faixa_renda,
    AVG(nu_nota_comp1) AS media_comp1_faixa_renda,
    AVG(nu_nota_comp2) AS media_comp2_faixa_renda,
    AVG(nu_nota_comp3) AS media_comp3_faixa_renda,
    AVG(nu_nota_comp4) AS media_comp4_faixa_renda,
    AVG(nu_nota_comp5) AS media_comp5_faixa_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373828);
",Sucesso,
210059246976,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246976;

-- Comparativo de desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246976)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246976);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246976);
",Sucesso,
210061234985,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc AND no_municipio_esc = e.no_municipio_esc) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = e.Q006) AS media_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210061234985;
",Sucesso,
210061337589,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337589;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337589)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337589);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337589);
",Sucesso,
210059589781,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589781;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589781)
),

municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589781)
),

renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589781)
)

SELECT 
    'Estado' AS comparativo,
    media_nota_redacao,
    total_alunos
FROM 
    estado_comparativo

UNION ALL

SELECT 
    'Município' AS comparativo,
    media_nota_redacao,
    total_alunos
FROM 
    municipio_comparativo

UNION ALL

SELECT 
    'Faixa de Renda' AS comparativo,
    media_nota_redacao,
    total_alunos
FROM 
    renda_comparativa;
",Sucesso,
210058061541,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061541;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061541)
)

SELECT 
    d.*, 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d
JOIN 
    desempenho_estado e ON d.sg_uf_esc = e.sg_uf_esc
WHERE 
    d.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061541);

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061541)
)

SELECT 
    d.*, 
    r.media_nota_redacao,
    r.media_comp1,
    r.media_comp2,
    r.media_comp3,
    r.media_comp4,
    r.media_comp5
FROM 
    db.enem.base_enem d
JOIN 
    desempenho_renda r ON d.Q006 = r.Q006
WHERE 
    d.nu_inscricao <> 210058061541;
",Falha,
210059855124,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855124
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
comparativo_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT 
    ad.nu_inscricao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ce.media_nota_redacao AS media_estado_redacao,
    ce.media_comp1 AS media_estado_comp1,
    ce.media_comp2 AS media_estado_comp2,
    ce.media_comp3 AS media_estado_comp3,
    ce.media_comp4 AS media_estado_comp4,
    ce.media_comp5 AS media_estado_comp5,
    cc.media_nota_redacao_cidade AS media_cidade_redacao,
    cc.media_comp1_cidade AS media_cidade_comp1,
    cc.media_comp2_cidade AS media_cidade_comp2,
    cc.media_comp3_cidade AS media_cidade_comp3,
    cc.media_comp4_cidade AS media_cidade_comp4,
    cc.media_comp5_cidade AS media_cidade_comp5,
    cr.media_nota_redacao_renda AS media_renda_redacao,
    cr.media_comp1_renda AS media_renda_comp1,
    cr.media_comp2_renda AS media_renda_comp2,
    cr.media_comp3_renda AS media_renda_comp3,
    cr.media_comp4_renda AS media_renda_comp4,
    cr.media_comp5_renda AS media_renda_comp5
FROM 
    aluno_desempenho ad,
    comparativo_estado ce,
    comparativo_cidade cc,
    comparativo_renda cr;
",Sucesso,
210058387335,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao,
        no_municipio_esc, 
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387335
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_nota_comp1, 
    da.nu_nota_comp2, 
    da.nu_nota_comp3, 
    da.nu_nota_comp4, 
    da.nu_nota_comp5, 
    da.nu_nota_redacao,
    des_estado.media_redacao AS media_estado_redacao,
    des_estado.media_comp1 AS media_estado_comp1,
    des_estado.media_comp2 AS media_estado_comp2,
    des_estado.media_comp3 AS media_estado_comp3,
    des_estado.media_comp4 AS media_estado_comp4,
    des_estado.media_comp5 AS media_estado_comp5,
    des_municipio.media_redacao AS media_municipio_redacao,
    des_municipio.media_comp1 AS media_municipio_comp1,
    des_municipio.media_comp2 AS media_municipio_comp2,
    des_municipio.media_comp3 AS media_municipio_comp3,
    des_municipio.media_comp4 AS media_municipio_comp4,
    des_municipio.media_comp5 AS media_municipio_comp5,
    des_renda.media_redacao AS media_renda_redacao,
    des_renda.media_comp1 AS media_renda_comp1,
    des_renda.media_comp2 AS media_renda_comp2,
    des_renda.media_comp3 AS media_renda_comp3,
    des_renda.media_comp4 AS media_renda_comp4,
    des_renda.media_comp5 AS media_renda_comp5
FROM 
    desempenho_aluno da,
    desempenho_estado des_estado,
    desempenho_municipio des_municipio,
    desempenho_renda des_renda;
",Sucesso,
210059085139,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085139;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085139)
    GROUP BY 
        sg_uf_esc
),
renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085139)
)
SELECT 
    e.*, 
    r.*
FROM 
    estado_comparativo e, 
    renda_comparativa r;
",Sucesso,
210060801603,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801603;

-- Estatísticas de desempenho em comparação com outros alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    COUNT(*) AS total_alunos,
    COUNT(CASE WHEN nu_nota_redacao > (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210060801603) THEN 1 END) AS alunos_acima_media
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801603) AND 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801603);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    COUNT(*) AS total_alunos_renda,
    COUNT(CASE WHEN nu_nota_redacao > (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210060801603) THEN 1 END) AS alunos_acima_media_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801603);
",Sucesso,
210059527738,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527738;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527738)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527738);

-- Análise por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527738);
",Sucesso,
210059388095,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388095;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388095)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388095)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388095)
);

SELECT 
    'Estado' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado
UNION ALL
SELECT 
    'Município' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio
UNION ALL
SELECT 
    'Renda Familiar' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
",Falha,
210059980951,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980951)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980951)) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980951)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980951;
",Sucesso,
210058061542,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061542
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.*,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210059855125,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM database.schema.table 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.schema.table WHERE nu_inscricao = 210059855125)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM database.schema.table WHERE nu_inscricao = 210059855125)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM database.schema.table 
     WHERE Q006 = (SELECT Q006 FROM database.schema.table WHERE nu_inscricao = 210059855125)) AS media_redacao_faixa_renda
FROM 
    database.schema.table
WHERE 
    nu_inscricao = 210059855125;
",Falha,
210058387336,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387336;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387336)
)

SELECT 
    'Estado' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparativo;

WITH municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387336)
)

SELECT 
    'Municipio' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    municipio_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387336)
)

SELECT 
    'Renda' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    renda_comparativa;
",Sucesso,
210059085140,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085140
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT 
    a.*,
    e.*,
    c.*,
    r.*
FROM 
    aluno_desempenho a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
",Sucesso,
210059855127,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855127 
    OR sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)
    OR no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)
    OR Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855127);
",Falha,
210059085142,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS media_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085142
GROUP BY 
    nu_inscricao;
",Falha,
210061327759,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061327759)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061327759) AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061327759)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061327759)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061327759;
",Sucesso,
210059587845,"
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    AVG(b.nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(b.nu_nota_comp1) AS media_comp1_estado,
    AVG(b.nu_nota_comp2) AS media_comp2_estado,
    AVG(b.nu_nota_comp3) AS media_comp3_estado,
    AVG(b.nu_nota_comp4) AS media_comp4_estado,
    AVG(b.nu_nota_comp5) AS media_comp5_estado,
    AVG(c.nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(c.nu_nota_comp1) AS media_comp1_renda,
    AVG(c.nu_nota_comp2) AS media_comp2_renda,
    AVG(c.nu_nota_comp3) AS media_comp3_renda,
    AVG(c.nu_nota_comp4) AS media_comp4_renda,
    AVG(c.nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem a
JOIN 
    db.enem.base_enem b ON a.sg_uf_esc = b.sg_uf_esc AND a.no_municipio_esc = b.no_municipio_esc
JOIN 
    db.enem.base_enem c ON a.Q006 = c.Q006
WHERE 
    a.nu_inscricao = 210059587845
GROUP BY 
    a.nu_inscricao, a.nu_nota_redacao, a.nu_nota_comp1, a.nu_nota_comp2, a.nu_nota_comp3, a.nu_nota_comp4, a.nu_nota_comp5;
",Sucesso,
210058941490,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058941490
),
dados_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
dados_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    c.media_nota_redacao,
    c.media_comp1,
    c.media_comp2,
    c.media_comp3,
    c.media_comp4,
    c.media_comp5,
    c.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_dados a,
    dados_comparacao c,
    dados_renda r;
",Sucesso,
210059959481,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059959481
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    ad.nu_nota_redacao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5,
    em.media_nota_redacao_municipio,
    em.media_comp1_municipio,
    em.media_comp2_municipio,
    em.media_comp3_municipio,
    em.media_comp4_municipio,
    em.media_comp5_municipio,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    aluno_dados ad,
    estatisticas_estado es,
    estatisticas_municipio em,
    estatisticas_renda er;
",Sucesso,
210059982319,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982319;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982319)
);

WITH municipio_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982319)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982319)
)

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT * FROM municipio_comparacao) AS comparacao_municipio,
    (SELECT * FROM renda_comparacao) AS comparacao_renda;
",Falha,
210060440974,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440974;

-- Estatísticas de desempenho em comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440974)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440974);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440974);
",Sucesso,
210060373824,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373824;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373824)
);

WITH renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373824)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativo) AS comparativo_renda;
",Falha,
210059527739,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527739
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210061103949,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103949)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103949)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103949)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103949;
",Sucesso,
210059388096,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388096;

WITH stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388096)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388096)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM stats) AS media_nota_redacao_estado_cidade,
    (SELECT media_comp1 FROM stats) AS media_comp1_estado_cidade,
    (SELECT media_comp2 FROM stats) AS media_comp2_estado_cidade,
    (SELECT media_comp3 FROM stats) AS media_comp3_estado_cidade,
    (SELECT media_comp4 FROM stats) AS media_comp4_estado_cidade,
    (SELECT media_comp5 FROM stats) AS media_comp5_estado_cidade
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388096);
",Sucesso,
210058061543,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061543;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061543)
)

SELECT 
    estado_comparativo.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058061543) AS nota_aluno
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061543)
)

SELECT 
    renda_comparativa.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058061543) AS nota_aluno
FROM 
    renda_comparativa;
",Sucesso,
210058387337,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387337;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387337)
),

desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387337)
),

desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387337)
)

SELECT 
    e.*, 
    m.*, 
    r.*
FROM 
    desempenho_estado e, 
    desempenho_municipio m, 
    desempenho_renda r;
",Sucesso,
210060801605,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_nota_redacao_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210060801605;
",Sucesso,
210059527740,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527740;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527740)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estatisticas_estado e;

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527740)
)

SELECT 
    r.media_nota_redacao,
    r.media_comp1,
    r.media_comp2,
    r.media_comp3,
    r.media_comp4,
    r.media_comp5
FROM 
    estatisticas_renda r;
",Sucesso,
210061103950,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103950)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103950)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103950)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103950;
",Sucesso,
210060214092,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214092;

-- Consultar desempenho dos alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214092)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214092);

-- Consultar desempenho de alunos com a mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214092);
",Sucesso,
210059388097,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388097)) AS media_redacao_uf,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388097)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388097)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388097;
",Sucesso,
210061234991,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234991;

-- Informações estatísticas comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234991)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234991);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234991);
",Sucesso,
210061337600,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337600;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337600)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337600);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337600);
",Sucesso,
210059589787,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589787;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589787)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589787);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589787);
",Sucesso,
210058941510,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941510) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941510)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941510)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941510;
",Sucesso,
210059974460,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974460
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974460)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974460)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974460)
)

SELECT 
    da.nu_nota_comp1, 
    da.nu_nota_comp2, 
    da.nu_nota_comp3, 
    da.nu_nota_comp4, 
    da.nu_nota_comp5, 
    da.nu_nota_redacao,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210059982330,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982330;

-- Análise comparativa com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982330)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982330);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982330);
",Sucesso,
210060440985,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060440985
),
alunos_estaduais AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.nu_inscricao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ee.media_nota_redacao,
    ee.media_comp1,
    ee.media_comp2,
    ee.media_comp3,
    ee.media_comp4,
    ee.media_comp5,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    aluno_dados ad,
    alunos_estaduais ee,
    alunos_renda er;
",Sucesso,
210058573827,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573827;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao, 
    AVG(nu_nota_comp1) AS media_comp1, 
    AVG(nu_nota_comp2) AS media_comp2, 
    AVG(nu_nota_comp3) AS media_comp3, 
    AVG(nu_nota_comp4) AS media_comp4, 
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573827)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573827);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573827);
",Sucesso,
210059246983,"
SELECT 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246983;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246983)
)

SELECT 
    * 
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246983)
)

SELECT 
    * 
FROM 
    renda_comparacao;
",Sucesso,
210061234992,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234992
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_estado,
    m.media_municipio,
    r.media_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210061337602,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337602;

-- Comparação de desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337602)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337602);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337602);
",Sucesso,
210059589788,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589788;

-- Estatísticas de desempenho comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589788)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589788);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589788);
",Sucesso,
210058941511,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941511;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941511)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941511)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    renda_comparacao;
",Sucesso,
210059974461,"
SELECT
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974461) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974461)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974461)) AS media_redacao_faixa_renda
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059974461;
",Sucesso,
210059982331,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982331;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982331)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982331);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982331);
",Sucesso,
210060440986,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440986;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440986)
)

SELECT 
    e.*,
    ec.media_nota_redacao,
    ec.media_comp1,
    ec.media_comp2,
    ec.media_comp3,
    ec.media_comp4,
    ec.media_comp5
FROM 
    db.enem.base_enem e
CROSS JOIN 
    estado_comparativo ec
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440986);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440986)
)

SELECT 
    r.*,
    rc.media_nota_redacao,
    rc.media_comp1,
    rc.media_comp2,
    rc.media_comp3,
    rc.media_comp4,
    rc.media_comp5
FROM 
    db.enem.base_enem r
CROSS JOIN 
    renda_comparativa rc
WHERE 
    nu_inscricao <> 210060440986;
",Sucesso,
210058573828,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573828;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573828)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573828);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573828);
",Sucesso,
210061337603,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337603;

-- Estatísticas dos alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337603)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337603);

-- Análise do desempenho dos alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337603);
",Sucesso,
210059589789,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589789)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589789)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589789)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589789;
",Sucesso,
210059982332,"
SELECT 
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS total_alunos_uf,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS media_nota_redacao_uf,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS total_alunos_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS media_nota_redacao_municipio,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS media_nota_redacao_renda
FROM db.enem.base_enem
WHERE nu_inscricao = 210059982332
GROUP BY nu_inscricao, tp_status_redacao, nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao;
",Sucesso,
210060373837,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373837;

-- Estatísticas de desempenho comparando com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373837)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373837);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373837);
",Sucesso,
210059246985,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246985;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246985)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246985);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246985);
",Sucesso,
210061234995,"
SELECT
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234995)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234995)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234995)) AS media_nota_redacao_renda
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210061234995;
",Sucesso,
210061337605,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337605
),
estudantes_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estudantes_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estudantes_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_info a,
    estudantes_estado e,
    estudantes_municipio m,
    estudantes_renda r;
",Sucesso,
210059589790,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        tp_status_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589790
),
estadual_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipal_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
faixa_renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    ad.*,
    ec.media_nota_redacao,
    ec.media_comp1,
    ec.media_comp2,
    ec.media_comp3,
    ec.media_comp4,
    ec.media_comp5,
    mc.media_nota_redacao_municipio,
    mc.media_comp1_municipio,
    mc.media_comp2_municipio,
    mc.media_comp3_municipio,
    mc.media_comp4_municipio,
    mc.media_comp5_municipio,
    fr.media_nota_redacao_renda,
    fr.media_comp1_renda,
    fr.media_comp2_renda,
    fr.media_comp3_renda,
    fr.media_comp4_renda,
    fr.media_comp5_renda
FROM 
    aluno_dados ad,
    estadual_comparacao ec,
    municipal_comparacao mc,
    faixa_renda_comparacao fr;
",Sucesso,
210058941515,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941515;

WITH estado_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941515)
)

SELECT 
    estado_stats.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_redacao,
    (SELECT nu_nota_comp1 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp1,
    (SELECT nu_nota_comp2 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp2,
    (SELECT nu_nota_comp3 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp3,
    (SELECT nu_nota_comp4 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp4,
    (SELECT nu_nota_comp5 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp5
FROM 
    estado_stats;

WITH renda_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515)
)

SELECT 
    renda_stats.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_redacao_renda,
    (SELECT nu_nota_comp1 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp1_renda,
    (SELECT nu_nota_comp2 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp2_renda,
    (SELECT nu_nota_comp3 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp3_renda,
    (SELECT nu_nota_comp4 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp4_renda,
    (SELECT nu_nota_comp5 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp5_renda
FROM 
    renda_stats;
",Sucesso,
210059974463,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974463)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974463)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974463)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974463;
",Sucesso,
210059982333,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982333;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982333)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982333);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982333);
",Sucesso,
210060440988,"
WITH aluno_dados AS (
    SELECT
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM
        db.enem.base_enem
    WHERE
        nu_inscricao = 210060440988
),
estatisticas_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT
    a.*,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    e.total_alunos AS total_alunos_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    m.total_alunos AS total_alunos_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda,
    r.total_alunos AS total_alunos_renda
FROM
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210058573830,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573830
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_dados a
CROSS JOIN 
    comparativo_estado e
CROSS JOIN 
    comparativo_municipio m
CROSS JOIN 
    comparativo_renda r;
",Sucesso,
210059246986,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246986
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.estado_media_nota_redacao,
    e.estado_media_comp1,
    e.estado_media_comp2,
    e.estado_media_comp3,
    e.estado_media_comp4,
    e.estado_media_comp5,
    m.municipio_media_nota_redacao,
    m.municipio_media_comp1,
    m.municipio_media_comp2,
    m.municipio_media_comp3,
    m.municipio_media_comp4,
    m.municipio_media_comp5,
    r.renda_media_nota_redacao,
    r.renda_media_comp1,
    r.renda_media_comp2,
    r.renda_media_comp3,
    r.renda_media_comp4,
    r.renda_media_comp5
FROM 
    aluno_dados a,
    (SELECT * FROM estatisticas_estado) e,
    (SELECT * FROM estatisticas_municipio) m,
    (SELECT * FROM estatisticas_renda) r;
",Falha,
210061337607,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337607
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    es.media_redacao_estado,
    es.media_comp1_estado,
    es.media_comp2_estado,
    es.media_comp3_estado,
    es.media_comp4_estado,
    es.media_comp5_estado,
    em.media_redacao_municipio,
    em.media_comp1_municipio,
    em.media_comp2_municipio,
    em.media_comp3_municipio,
    em.media_comp4_municipio,
    em.media_comp5_municipio,
    er.media_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    desempenho_aluno da,
    estatisticas_estado es,
    estatisticas_municipio em,
    estatisticas_renda er;
",Sucesso,
210059982334,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982334;

-- Estatísticas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982334)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982334);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982334);
",Sucesso,
210060440989,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        no_municipio_esc,
        sg_uf_esc,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060440989
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_mun,
        AVG(nu_nota_comp1) AS media_comp1_mun,
        AVG(nu_nota_comp2) AS media_comp2_mun,
        AVG(nu_nota_comp3) AS media_comp3_mun,
        AVG(nu_nota_comp4) AS media_comp4_mun,
        AVG(nu_nota_comp5) AS media_comp5_mun
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210058573831,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573831
),
estadisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estadisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estadisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.nu_inscricao,
    ad.nu_nota_redacao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    es.media_redacao_estado,
    es.media_comp1_estado,
    es.media_comp2_estado,
    es.media_comp3_estado,
    es.media_comp4_estado,
    es.media_comp5_estado,
    em.media_redacao_municipio,
    em.media_comp1_municipio,
    em.media_comp2_municipio,
    em.media_comp3_municipio,
    em.media_comp4_municipio,
    em.media_comp5_municipio,
    er.media_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    aluno_dados ad
JOIN 
    estadisticas_estado es ON true
JOIN 
    estadisticas_municipio em ON true
JOIN 
    estadisticas_renda er ON true;
",Sucesso,
210059246987,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246987
), 
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
), 
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
), 
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.avg_comp1 AS avg_estado_comp1,
    e.avg_comp2 AS avg_estado_comp2,
    e.avg_comp3 AS avg_estado_comp3,
    e.avg_comp4 AS avg_estado_comp4,
    e.avg_comp5 AS avg_estado_comp5,
    e.avg_redacao AS avg_estado_redacao,
    m.avg_comp1 AS avg_municipio_comp1,
    m.avg_comp2 AS avg_municipio_comp2,
    m.avg_comp3 AS avg_municipio_comp3,
    m.avg_comp4 AS avg_municipio_comp4,
    m.avg_comp5 AS avg_municipio_comp5,
    m.avg_redacao AS avg_municipio_redacao,
    r.avg_comp1 AS avg_renda_comp1,
    r.avg_comp2 AS avg_renda_comp2,
    r.avg_comp3 AS avg_renda_comp3,
    r.avg_comp4 AS avg_renda_comp4,
    r.avg_comp5 AS avg_renda_comp5,
    r.avg_redacao AS avg_renda_redacao
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210061234997,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234997;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234997)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234997);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234997);
",Sucesso,
210061337609,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337609
),
estadisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estadisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059974465,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974465;

-- Estatísticas de desempenho no estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974465)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974465);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974465);
",Sucesso,
210060440990,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440990;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440990)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440990);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440990);
",Sucesso,
210060373840,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373840;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373840)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373840)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373840)
);

SELECT 
    'Estado' AS origem,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado
UNION ALL
SELECT 
    'Município' AS origem,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio
UNION ALL
SELECT 
    'Faixa de Renda' AS origem,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
",Falha,
210058573822,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573822;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573822)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573822)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573822)
)

SELECT 
    'Estado' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Município' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Renda' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
",Falha,
210059246978,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246978
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a
CROSS JOIN 
    comparativo_estado e
CROSS JOIN 
    comparativo_municipio m
CROSS JOIN 
    comparativo_renda r;
",Sucesso,
210061234987,"
WITH aluno_dados AS (
    SELECT 
        no_municipio_esc,
        sg_uf_esc,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234987
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.no_municipio_esc,
    a.sg_uf_esc,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210060440981,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440981;

-- Estatísticas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440981)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440981);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440981);
",Sucesso,
210060373831,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373831)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373831)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373831)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210060373831;
",Sucesso,
210058573823,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058573823)) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058573823)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058573823 
    OR sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058573823)
    OR (Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058573823))
GROUP BY 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao;
",Falha,
210061234988,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234988;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234988)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234988);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234988);
",Sucesso,
210061337594,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337594
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210060440983,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440983;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440983)
);

WITH renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440983)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativo) AS comparativo_renda;
",Falha,
210060373833,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373833)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373833)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373833)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373833;
",Sucesso,
210058573825,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573825;

-- Estatísticas comparativas no estado
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573825);

-- Análise por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573825);
",Sucesso,
210061337598,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210061337598)) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210061337598)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210061337598
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc, Q006;
",Falha,
210058941508,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941508)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941508) AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941508)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941508)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941508;
",Sucesso,
210060373834,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373834)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373834 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373834) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373834))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210059589784,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS media_nota_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS media_nota_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589784
GROUP BY 
    nu_inscricao;
",Falha,
210058941505,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941505;

-- Estatísticas comparando desempenho com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941505)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941505);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941505);
",Sucesso,
210059974457,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059974457
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM aluno_dados a, estatisticas_estado e, estatisticas_municipio m, estatisticas_renda r;
",Falha,
210059982327,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982327)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982327)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982327)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982327;
",Sucesso,
210060440982,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440982)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440982)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440982)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210060440982;
",Sucesso,
210060373832,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373832)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373832)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373832)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373832;
",Sucesso,
210058573824,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573824;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573824) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573824);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573824);
",Sucesso,
210061234989,"
SELECT 
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234989
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234989) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234989))
    OR (Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234989))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc, Q006;
",Falha,
210059246980,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059246980;

-- Desempenho médio em comparação com alunos do mesmo estado e município
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246980)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246980);

-- Desempenho em comparação com alunos da mesma faixa de renda
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246980);
",Sucesso,
210061337596,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337596
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1_mun,
        AVG(nu_nota_comp2) AS avg_comp2_mun,
        AVG(nu_nota_comp3) AS avg_comp3_mun,
        AVG(nu_nota_comp4) AS avg_comp4_mun,
        AVG(nu_nota_comp5) AS avg_comp5_mun,
        AVG(nu_nota_redacao) AS avg_redacao_mun
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1_renda,
        AVG(nu_nota_comp2) AS avg_comp2_renda,
        AVG(nu_nota_comp3) AS avg_comp3_renda,
        AVG(nu_nota_comp4) AS avg_comp4_renda,
        AVG(nu_nota_comp5) AS avg_comp5_renda,
        AVG(nu_nota_redacao) AS avg_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.avg_comp1,
    de.avg_comp2,
    de.avg_comp3,
    de.avg_comp4,
    de.avg_comp5,
    de.avg_redacao,
    dm.avg_comp1_mun,
    dm.avg_comp2_mun,
    dm.avg_comp3_mun,
    dm.avg_comp4_mun,
    dm.avg_comp5_mun,
    dm.avg_redacao_mun,
    dr.avg_comp1_renda,
    dr.avg_comp2_renda,
    dr.avg_comp3_renda,
    dr.avg_comp4_renda,
    dr.avg_comp5_renda,
    dr.avg_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210059589785,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589785;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589785)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589785);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589785);
",Sucesso,
210059974458,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974458;

-- Comparando desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974458) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974458);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974458);
",Sucesso,
210059982328,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) AS total_alunos_estado,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982328)) AS total_alunos_mesma_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982328)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982328
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982328)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982328))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210060801613,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801613)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801613)) AS media_nota_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801613)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801613;
",Sucesso,
210061103959,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103959)
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103959)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103959)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103959;
",Sucesso,
210059388105,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059388105
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210058061552,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061552;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061552)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d
CROSS JOIN 
    desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061552)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d
CROSS JOIN 
    desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
",Falha,
210059085151,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085151;

-- Estatísticas de desempenho em comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085151)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085151);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085151);
",Sucesso,
210061103960,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103960;
",Sucesso,
210061244803,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061244803
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210061337610,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337610;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao, 
    AVG(nu_nota_comp1) AS media_nota_comp1, 
    AVG(nu_nota_comp2) AS media_nota_comp2, 
    AVG(nu_nota_comp3) AS media_nota_comp3, 
    AVG(nu_nota_comp4) AS media_nota_comp4, 
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337610)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337610);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337610);
",Sucesso,
210058941522,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941522;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941522)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941522)
)

SELECT 
    *
FROM 
    renda_comparativa;
",Sucesso,
210059589793,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589793;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589793)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589793);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589793);
",Sucesso,
210059974466,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    AVG(nu_nota_redacao) AS media_redacao_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974466)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974466
    OR sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974466)
    OR no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974466)
GROUP BY 
    nu_inscricao;
",Falha,
210059982336,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982336
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    ce.media_redacao,
    ce.media_comp1,
    ce.media_comp2,
    ce.media_comp3,
    ce.media_comp4,
    ce.media_comp5,
    cm.media_redacao_municipio,
    cm.media_comp1_municipio,
    cm.media_comp2_municipio,
    cm.media_comp3_municipio,
    cm.media_comp4_municipio,
    cm.media_comp5_municipio,
    cr.media_redacao_renda,
    cr.media_comp1_renda,
    cr.media_comp2_renda,
    cr.media_comp3_renda,
    cr.media_comp4_renda,
    cr.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado ce,
    comparativo_municipio cm,
    comparativo_renda cr;
",Sucesso,
210060440991,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440991;

-- Estatísticas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440991)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440991);

-- Análise com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440991);
",Sucesso,
210060373841,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373841;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373841)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373841);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373841);
",Sucesso,
210059246989,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246989
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5, 
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5, 
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5, 
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1, 
    a.nu_nota_comp2, 
    a.nu_nota_comp3, 
    a.nu_nota_comp4, 
    a.nu_nota_comp5, 
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_cidade c,
    estatisticas_renda r;
",Sucesso,
210058573833,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573833;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573833)
)

SELECT 
    * 
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573833)
)

SELECT 
    * 
FROM 
    renda_comparativa;
",Sucesso,
210061244804,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = t.sg_uf_esc) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = t.no_municipio_esc) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244804)) AS media_renda_redacao
FROM 
    db.enem.base_enem t
WHERE 
    nu_inscricao = 210061244804;
",Sucesso,
210061337613,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337613;

-- Análise de desempenho em comparação com outros alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337613)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337613);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337613);
",Sucesso,
210058387341,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387341;

-- Consulta para comparar o desempenho com outros alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387341)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387341);

-- Consulta para analisar o desempenho em relação a alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387341);
",Sucesso,
210059085145,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085145
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_info a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210060801609,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801609;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801609)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_nota_estado,
    (SELECT media_comp1 FROM estado_comparativo) AS media_comp1_estado,
    (SELECT media_comp2 FROM estado_comparativo) AS media_comp2_estado,
    (SELECT media_comp3 FROM estado_comparativo) AS media_comp3_estado,
    (SELECT media_comp4 FROM estado_comparativo) AS media_comp4_estado,
    (SELECT media_comp5 FROM estado_comparativo) AS media_comp5_estado
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801609)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801609);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801609)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparativa) AS media_nota_renda,
    (SELECT media_comp1_renda FROM renda_comparativa) AS media_comp1_renda,
    (SELECT media_comp2_renda FROM renda_comparativa) AS media_comp2_renda,
    (SELECT media_comp3_renda FROM renda_comparativa) AS media_comp3_renda,
    (SELECT media_comp4_renda FROM renda_comparativa) AS media_comp4_renda,
    (SELECT media_comp5_renda FROM renda_comparativa) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801609);
",Sucesso,
210061103955,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103955;

WITH performance AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
)

SELECT 
    p.*,
    COUNT(*) AS total_alunos
FROM 
    performance p
JOIN 
    db.enem.base_enem e ON e.Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
WHERE 
    e.sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
    AND e.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955);
",Falha,
210060214096,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214096;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214096)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214096);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214096);
",Sucesso,
210059388101,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388101;

SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388101)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388101);

SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388101);
",Sucesso,
210058061548,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061548;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061548)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061548);

-- Análise por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061548);
",Sucesso,
210058387342,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387342;

WITH comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387342)
),

comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387342)
),

comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387342)
)

SELECT 
    (SELECT * FROM comparacao_estado) AS comparacao_estado,
    (SELECT * FROM comparacao_municipio) AS comparacao_municipio,
    (SELECT * FROM comparacao_renda) AS comparacao_renda;
",Falha,
210059085146,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085146
),
estadual_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipal_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estadual_comparacao e,
    municipal_comparacao m,
    renda_comparacao r;
",Sucesso,
210060801610,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801610;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801610)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801610);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801610);
",Sucesso,
210059527746,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527746;

-- Comparação com alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527746)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527746);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527746);
",Sucesso,
210060214097,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214097;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214097)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214097)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214097)
)

SELECT 
    'Estado' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Município' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Renda' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
",Sucesso,
210058061549,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061549;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061549)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061549);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061549);
",Sucesso,
210059980958,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059980958
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210058387343,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387343)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387343)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387343)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387343;
",Sucesso,
210059085147,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085147
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    d.nota_redacao,
    d.nota_comp1,
    d.nota_comp2,
    d.nota_comp3,
    d.nota_comp4,
    d.nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    desempenho_aluno d,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Falha,
210060801611,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801611;

-- Estatísticas comparando o desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801611)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801611);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801611);
",Sucesso,
210059527747,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527747;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527747)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527747);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527747);
",Sucesso,
210061103957,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103957;

WITH performance_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao,
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
)

SELECT 
    p.*, 
    s.*
FROM 
    (SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)) AS p,
    performance_stats AS s;

WITH renda_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao_renda,
        AVG(nu_nota_comp1) AS avg_comp1_renda,
        AVG(nu_nota_comp2) AS avg_comp2_renda,
        AVG(nu_nota_comp3) AS avg_comp3_renda,
        AVG(nu_nota_comp4) AS avg_comp4_renda,
        AVG(nu_nota_comp5) AS avg_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
)

SELECT 
    r.*
FROM 
    renda_stats AS r;
",Sucesso,
210058061550,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061550;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061550)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061550);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061550);
",Sucesso,
210059855133,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855133;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855133)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855133)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855133)
)

SELECT 
    e.media_redacao AS media_redacao_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_redacao AS media_redacao_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_redacao AS media_redacao_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210058387344,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387344
), estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
), estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
), estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.estado_media_nota_redacao,
    e.estado_media_comp1,
    e.estado_media_comp2,
    e.estado_media_comp3,
    e.estado_media_comp4,
    e.estado_media_comp5,
    e.total_alunos AS total_alunos_estado,
    m.municipio_media_nota_redacao,
    m.municipio_media_comp1,
    m.municipio_media_comp2,
    m.municipio_media_comp3,
    m.municipio_media_comp4,
    m.municipio_media_comp5,
    m.total_alunos AS total_alunos_municipio,
    r.renda_media_nota_redacao,
    r.renda_media_comp1,
    r.renda_media_comp2,
    r.renda_media_comp3,
    r.renda_media_comp4,
    r.renda_media_comp5,
    r.total_alunos AS total_alunos_renda
FROM 
    aluno_dados a,
    (SELECT * FROM estatisticas_estado) e,
    (SELECT * FROM estatisticas_municipio) m,
    (SELECT * FROM estatisticas_renda) r;
",Falha,
210060801612,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060801612
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.avg_comp1 AS avg_comp1_estado,
    de.avg_comp2 AS avg_comp2_estado,
    de.avg_comp3 AS avg_comp3_estado,
    de.avg_comp4 AS avg_comp4_estado,
    de.avg_comp5 AS avg_comp5_estado,
    de.avg_redacao AS avg_redacao_estado,
    dm.avg_comp1 AS avg_comp1_municipio,
    dm.avg_comp2 AS avg_comp2_municipio,
    dm.avg_comp3 AS avg_comp3_municipio,
    dm.avg_comp4 AS avg_comp4_municipio,
    dm.avg_comp5 AS avg_comp5_municipio,
    dm.avg_redacao AS avg_redacao_municipio,
    dr.avg_comp1 AS avg_comp1_renda,
    dr.avg_comp2 AS avg_comp2_renda,
    dr.avg_comp3 AS avg_comp3_renda,
    dr.avg_comp4 AS avg_comp4_renda,
    dr.avg_comp5 AS avg_comp5_renda,
    dr.avg_redacao AS avg_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210060214099,"
SELECT 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214099)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214099 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214099) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214099))
GROUP BY 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc;
",Falha,
210059388104,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388104;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388104)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388104);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388104);
",Sucesso,
210059980960,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980960;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980960)
)

SELECT 
    e.*,
    estat.media_nota_redacao,
    estat.media_comp1,
    estat.media_comp2,
    estat.media_comp3,
    estat.media_comp4,
    estat.media_comp5
FROM 
    db.enem.base_enem e
JOIN 
    estatisticas_estado estat ON e.sg_uf_esc = estat.sg_uf_esc
WHERE 
    e.nu_inscricao <> 210059980960;

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980960)
)

SELECT 
    e.*,
    estat_renda.media_nota_redacao_renda,
    estat_renda.media_comp1_renda,
    estat_renda.media_comp2_renda,
    estat_renda.media_comp3_renda,
    estat_renda.media_comp4_renda,
    estat_renda.media_comp5_renda
FROM 
    db.enem.base_enem e
JOIN 
    estatisticas_renda estat_renda ON e.Q006 = estat_renda.Q006
WHERE 
    e.nu_inscricao <> 210059980960;
",Falha,
210059855134,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855134;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855134)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855134)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855134)
)

SELECT 
    e.*, 
    m.*, 
    r.*
FROM 
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059085150,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085150
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_estado,
    m.media_municipio,
    r.media_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210059974467,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_redacao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_nota_redacao_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210059974467;
",Sucesso,
210059982337,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982337
),
estados_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info) 
    GROUP BY 
        sg_uf_esc
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    ai.*,
    ec.*,
    rc.*
FROM 
    aluno_info ai
CROSS JOIN 
    estados_comparacao ec
CROSS JOIN 
    renda_comparacao rc;
",Sucesso,
210060373842,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = '210060373842') 
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = '210060373842')) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = '210060373842')) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = '210060373842';
",Sucesso,
210061244805,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244805;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244805)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244805);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244805);
",Sucesso,
210061337614,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337614;

-- Comparação de desempenho com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337614)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337614);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337614);
",Sucesso,
210059589795,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589795
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    de.media_redacao,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dm.media_redacao_municipio,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda,
    dr.media_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210059974468,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974468
),
desempenho_estado AS (
    SELECT 
        sg_uf_esc,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974468)
    GROUP BY 
        sg_uf_esc
),
desempenho_cidade AS (
    SELECT 
        no_municipio_esc,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974468)
    GROUP BY 
        no_municipio_esc
),
desempenho_renda AS (
    SELECT 
        Q006,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974468)
    GROUP BY 
        Q006
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
",Sucesso,
210059982338,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059982338;

SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982338)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982338);

SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982338);
",Sucesso,
210060440993,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440993;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440993)
)

SELECT 
    a.nu_nota_redacao,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem a,
    estado_comparacao e
WHERE 
    a.sg_uf_esc = e.sg_uf_esc;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440993)
)

SELECT 
    a.nu_nota_redacao,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem a,
    renda_comparacao r
WHERE 
    a.Q006 = r.Q006;
",Falha,
210059388099,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388099)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388099)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388099)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388099;
",Sucesso,
210059980955,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(CASE WHEN nu_nota_redacao >= 0 THEN 1 END) AS total_alunos_estado,
    AVG(nu_nota_redacao) AS media_nota_estado,
    COUNT(CASE WHEN Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059980955) THEN 1 END) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059980955)) AS media_nota_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059980955 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059980955) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059980955))
    OR (Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059980955))
GROUP BY 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc;
",Falha,
210058061546,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061546;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061546)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061546)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061546)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_renda;
",Sucesso,
210059855129,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855129)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855129)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855129)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855129;
",Sucesso,
210058387340,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387340;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387340)
)

SELECT 
    *,
    estado_comparacao.*
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387340)
)

SELECT 
    *,
    renda_comparacao.*
FROM 
    renda_comparacao;
",Sucesso,
210059085144,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085144)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085144)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085144)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085144;
",Sucesso,
210060801608,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801608;

-- Estudo comparativo com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801608)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801608);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801608);
",Sucesso,
210059527744,"
SELECT
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059527744;

WITH estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527744)
),
municipio AS (
    SELECT
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527744)
),
faixa_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_faixa_renda,
        AVG(nu_nota_comp1) AS media_comp1_faixa_renda,
        AVG(nu_nota_comp2) AS media_comp2_faixa_renda,
        AVG(nu_nota_comp3) AS media_comp3_faixa_renda,
        AVG(nu_nota_comp4) AS media_comp4_faixa_renda,
        AVG(nu_nota_comp5) AS media_comp5_faixa_renda
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527744)
)

SELECT
    e.*,
    m.*,
    f.*
FROM
    estado e,
    municipio m,
    faixa_renda f;
",Sucesso,
210061103954,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103954)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103954)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103954)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103954;
",Sucesso,
210060214095,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214095;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214095)
)

SELECT 
    *
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214095)
)

SELECT 
    *
FROM 
    renda_comparacao;
",Sucesso,
210059388100,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388100;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388100)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388100)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388100)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
",Falha,
210059980956,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao,
    COUNT(*) AS total_alunos_estado,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980956)) AS total_alunos_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980956 OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980956) AND 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980956))
GROUP BY 
    no_municipio_esc, sg_uf_esc;
",Falha,
210058061547,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061547
),
desempenho_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_cidade AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.*,
    e.media_nota_redacao AS media_nota_redacao_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    c.media_nota_redacao AS media_nota_redacao_cidade,
    c.media_comp1 AS media_comp1_cidade,
    c.media_comp2 AS media_comp2_cidade,
    c.media_comp3 AS media_comp3_cidade,
    c.media_comp4 AS media_comp4_cidade,
    c.media_comp5 AS media_comp5_cidade,
    r.media_nota_redacao AS media_nota_redacao_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_desempenho a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
",Sucesso,
210059855130,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855130
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1_municipio AS media_municipio_comp1,
    dm.media_comp2_municipio AS media_municipio_comp2,
    dm.media_comp3_municipio AS media_municipio_comp3,
    dm.media_comp4_municipio AS media_municipio_comp4,
    dm.media_comp5_municipio AS media_municipio_comp5,
    dm.media_redacao_municipio AS media_municipio_redacao,
    dr.media_comp1_renda AS media_renda_comp1,
    dr.media_comp2_renda AS media_renda_comp2,
    dr.media_comp3_renda AS media_renda_comp3,
    dr.media_comp4_renda AS media_renda_comp4,
    dr.media_comp5_renda AS media_renda_comp5,
    dr.media_redacao_renda AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210058573835,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573835
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_renda r;
",Sucesso,
210059527742,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527742;

WITH performance_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527742)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527742)
),
renda_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527742)
)

SELECT 
    ps.*,
    rs.*
FROM 
    performance_stats ps,
    renda_stats rs;
",Sucesso,
210061103952,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103952)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103952)) AS media_nota_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103952)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103952;
",Sucesso,
210060214093,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214093;

-- Estatísticas comparativas por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214093)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214093);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214093);
",Sucesso,
210059388098,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388098;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388098)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388098);

-- Análise com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388098);
",Sucesso,
210059980954,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059980954
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
",Sucesso,
210058061545,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061545
),
estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estado_comparativo e,
    municipio_comparativo m,
    renda_comparativo r;
",Sucesso,
210058387339,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS total_alunos_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS media_redacao_municipio,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS media_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058387339
GROUP BY 
    nu_inscricao, nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao;
",Falha,
210059085143,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_redacao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210059085143;
",Sucesso,
210061103953,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103953;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103953)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103953);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103953);
",Sucesso,
210058061557,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061557
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059855140,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855140
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
",Sucesso,
210058387351,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387351
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210060801619,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801619;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801619)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801619);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801619);
",Sucesso,
210059085156,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085156
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
",Sucesso,
210059540788,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540788
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
",Sucesso,
210060214106,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214106)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214106)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214106)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214106;
",Sucesso,
210059980967,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006 AS renda_mensal
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980967;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980967)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_nota_estado,
    (SELECT media_comp1 FROM estado_comparativo) AS media_comp1_estado,
    (SELECT media_comp2 FROM estado_comparativo) AS media_comp2_estado,
    (SELECT media_comp3 FROM estado_comparativo) AS media_comp3_estado,
    (SELECT media_comp4 FROM estado_comparativo) AS media_comp4_estado,
    (SELECT media_comp5 FROM estado_comparativo) AS media_comp5_estado
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980967)
AND 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980967);
",Sucesso,
210058073302,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073302)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073302)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058073302)) AS media_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058073302;
",Sucesso,
210059855141,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855141
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210058387352,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387352)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387352)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387352)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387352;
",Sucesso,
210059085157,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085157
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210060801620,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801620;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801620)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801620)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801620)
);

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
",Falha,
210059540789,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540789;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540789)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540789)
)

SELECT 
    *
FROM 
    renda_comparativa;
",Sucesso,
210061103966,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103966;
",Sucesso,
210060214107,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214107;

-- Informações estatísticas sobre o desempenho no mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214107)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214107);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214107);
",Sucesso,
210059388112,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388112;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388112)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d, desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388112)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d, desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
",Falha,
210058073303,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) FILTER (WHERE nu_nota_redacao IS NOT NULL) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058073303)) AS media_estado,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058073303)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058073303)) AS media_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058073303 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058073303))
    OR (no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058073303))
    OR (Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058073303))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210059855142,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855142;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855142)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855142);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855142);
",Sucesso,
210059085158,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085158
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059540790,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540790
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
",Sucesso,
210061103967,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210061103967;
",Sucesso,
210059388113,"
WITH aluno_dados AS (
    SELECT nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao, sg_uf_esc, no_municipio_esc, Q006
    FROM db.enem.base_enem
    WHERE nu_inscricao = 210059388113
),
estatisticas_estado AS (
    SELECT AVG(nu_nota_redacao) AS media_nota_redacao, 
           AVG(nu_nota_comp1) AS media_comp1,
           AVG(nu_nota_comp2) AS media_comp2,
           AVG(nu_nota_comp3) AS media_comp3,
           AVG(nu_nota_comp4) AS media_comp4,
           AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT AVG(nu_nota_redacao) AS media_nota_redacao_mun, 
           AVG(nu_nota_comp1) AS media_comp1_mun,
           AVG(nu_nota_comp2) AS media_comp2_mun,
           AVG(nu_nota_comp3) AS media_comp3_mun,
           AVG(nu_nota_comp4) AS media_comp4_mun,
           AVG(nu_nota_comp5) AS media_comp5_mun
    FROM db.enem.base_enem
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT AVG(nu_nota_redacao) AS media_nota_redacao_renda,
           AVG(nu_nota_comp1) AS media_comp1_renda,
           AVG(nu_nota_comp2) AS media_comp2_renda,
           AVG(nu_nota_comp3) AS media_comp3_renda,
           AVG(nu_nota_comp4) AS media_comp4_renda,
           AVG(nu_nota_comp5) AS media_comp5_renda
    FROM db.enem.base_enem
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1, a.nu_nota_comp2, a.nu_nota_comp3, a.nu_nota_comp4, a.nu_nota_comp5, a.nu_nota_redacao,
    e.media_nota_redacao, e.media_comp1, e.media_comp2, e.media_comp3, e.media_comp4, e.media_comp5,
    m.media_nota_redacao_mun, m.media_comp1_mun, m.media_comp2_mun, m.media_comp3_mun, m.media_comp4_mun, m.media_comp5_mun,
    r.media_nota_redacao_renda, r.media_comp1_renda, r.media_comp2_renda, r.media_comp3_renda, r.media_comp4_renda, r.media_comp5_renda
FROM aluno_dados a
CROSS JOIN estatisticas_estado e
CROSS JOIN estatisticas_municipio m
CROSS JOIN estatisticas_renda r;
",Sucesso,
210059980969,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980969;

-- Consulta para comparação de desempenho com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980969)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980969);

-- Consulta para análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980969);
",Sucesso,
210058073304,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210058073304
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_redacao AS media_redacao_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_redacao AS media_redacao_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_redacao AS media_redacao_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM aluno_dados a
JOIN estatisticas_estado e ON true
JOIN estatisticas_municipio m ON true
JOIN estatisticas_renda r ON true;
",Falha,
210059855143,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855143;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855143)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855143);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855143);
",Sucesso,
210058387354,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387354;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387354)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387354);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387354);
",Sucesso,
210060801621,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801621;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801621)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estado_comparacao e;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801621)
)

SELECT 
    r.media_nota_redacao,
    r.media_comp1,
    r.media_comp2,
    r.media_comp3,
    r.media_comp4,
    r.media_comp5
FROM 
    renda_comparacao r;
",Sucesso,
210059540791,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540791
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    aluno_dados.*,
    estatisticas_estado.*,
    estatisticas_municipio.*,
    estatisticas_renda.*
FROM 
    aluno_dados,
    estatisticas_estado,
    estatisticas_municipio,
    estatisticas_renda;
",Sucesso,
210060214109,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214109;

-- Análise comparativa com alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214109)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214109);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214109);
",Sucesso,
210058073305,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058073305
),
dados_estatisticos AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados) AND
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
dados_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_dados a,
    dados_estatisticos e,
    dados_renda r;
",Sucesso,
210059868169,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059868169;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059868169)
);

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059868169)
);

SELECT 
    'Desempenho no Estado' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_estado
UNION ALL
SELECT 
    'Desempenho pela Renda' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_renda;
",Falha,
210058387355,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387355;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387355)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387355);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387355);
",Sucesso,
210060811451,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060811451;

-- Estatísticas de desempenho em relação a alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811451)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811451);

-- Análise de desempenho em relação a alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060811451);
",Sucesso,
210059540792,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540792
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado,
        AVG(nu_nota_redacao) AS media_redacao_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
",Sucesso,
210061337617,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337617;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337617)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337617);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337617);
",Sucesso,
210059589796,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589796;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589796)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589796);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589796);
",Sucesso,
210059974469,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974469;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974469)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974469);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974469);
",Sucesso,
210060440994,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440994;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440994)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440994);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440994);
",Sucesso,
210060376426,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376426;

WITH EstatisticasEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376426)
)

SELECT 
    e.*,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5
FROM 
    db.enem.base_enem e,
    EstatisticasEstado es
WHERE 
    e.sg_uf_esc = es.sg_uf_esc
    AND e.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376426);

WITH EstatisticasRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376426)
)

SELECT 
    e.*,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    db.enem.base_enem e,
    EstatisticasRenda er
WHERE 
    e.Q006 = er.Q006;
",Falha,
210058573836,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573836;

-- Análise comparativa com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573836)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573836);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573836);
",Sucesso,
210059246991,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246991;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246991)
)

SELECT 
    *,
    estado_comparacao.*
FROM 
    db.enem.base_enem
JOIN 
    estado_comparacao ON TRUE
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246991);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246991)
)

SELECT 
    *,
    renda_comparacao.*
FROM 
    db.enem.base_enem
JOIN 
    renda_comparacao ON TRUE
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246991);
",Sucesso,
210059388106,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388106)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388106)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao)
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388106)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388106;
",Sucesso,
210059980962,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059980962
),
estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estado_comparativo e,
    municipio_comparativo m,
    renda_comparativo r;
",Sucesso,
210058061553,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061553)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061553)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061553)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061553;
",Sucesso,
210059855136,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855136;

-- Estatísticas de desempenho dos alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855136)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855136);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855136);
",Sucesso,
210058387347,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387347
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    est_estado.media_nota_redacao AS media_nota_redacao_estado,
    est_estado.media_comp1 AS media_comp1_estado,
    est_estado.media_comp2 AS media_comp2_estado,
    est_estado.media_comp3 AS media_comp3_estado,
    est_estado.media_comp4 AS media_comp4_estado,
    est_estado.media_comp5 AS media_comp5_estado,
    est_estado.total_alunos AS total_alunos_estado,
    est_cidade.media_nota_redacao AS media_nota_redacao_cidade,
    est_cidade.media_comp1 AS media_comp1_cidade,
    est_cidade.media_comp2 AS media_comp2_cidade,
    est_cidade.media_comp3 AS media_comp3_cidade,
    est_cidade.media_comp4 AS media_comp4_cidade,
    est_cidade.media_comp5 AS media_comp5_cidade,
    est_cidade.total_alunos AS total_alunos_cidade,
    est_renda.media_nota_redacao AS media_nota_redacao_renda,
    est_renda.media_comp1 AS media_comp1_renda,
    est_renda.media_comp2 AS media_comp2_renda,
    est_renda.media_comp3 AS media_comp3_renda,
    est_renda.media_comp4 AS media_comp4_renda,
    est_renda.media_comp5 AS media_comp5_renda,
    est_renda.total_alunos AS total_alunos_renda
FROM 
    aluno_dados a,
    estatisticas_estado est_estado,
    estatisticas_cidade est_cidade,
    estatisticas_renda est_renda;
",Sucesso,
210059085152,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085152;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085152)
),

municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085152)
),

faixa_renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085152)
)

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM municipio_comparativo) AS comparativo_municipio,
    (SELECT * FROM faixa_renda_comparativo) AS comparativo_faixa_renda;
",Falha,
210060801615,"
SELECT
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801615) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801615)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801615)) AS media_redacao_renda
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210060801615;
",Sucesso,
210060214102,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214102;
",Sucesso,
210059388107,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388107;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388107)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_estado_redacao,
    (SELECT media_comp1 FROM estado_comparativo) AS media_estado_comp1,
    (SELECT media_comp2 FROM estado_comparativo) AS media_estado_comp2,
    (SELECT media_comp3 FROM estado_comparativo) AS media_estado_comp3,
    (SELECT media_comp4 FROM estado_comparativo) AS media_estado_comp4,
    (SELECT media_comp5 FROM estado_comparativo) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388107);
",Sucesso,
210059980963,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980963;

-- Comparação com outros alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980963)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980963);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980963);
",Sucesso,
210058061554,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS media_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS media_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058061554
GROUP BY 
    nu_inscricao, nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao;
",Falha,
210059855137,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855137) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855137)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855137)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855137;
",Sucesso,
210061103963,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103963)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103963) AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103963)) AS media_nota_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103963)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103963;
",Sucesso,
210059388109,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388109)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388109 OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388109) AND 
     no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388109))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210058061556,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061556;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061556)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061556);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061556);
",Sucesso,
210059855139,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855139;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855139)
)

SELECT 
    *,
    (SELECT * FROM estado_comparativo) AS comparativo_estado
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855139);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855139)
)

SELECT 
    *,
    (SELECT * FROM renda_comparativa) AS comparativo_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855139);
",Falha,
210058387350,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387350)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387350)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387350)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058387350;
",Sucesso,
210059085155,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085155
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    aluno_dados.*,
    comparacao_estado.*,
    comparacao_municipio.*,
    comparacao_renda.*
FROM 
    aluno_dados,
    comparacao_estado,
    comparacao_municipio,
    comparacao_renda;
",Sucesso,
210060801618,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801618;

-- Estatísticas comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801618)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801618);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801618);
",Sucesso,
210061103964,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103964;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103964)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103964);

-- Análise de desempenho para alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103964);
",Sucesso,
210059388110,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388110;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388110)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388110)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativa) AS comparativo_renda;
",Falha,
210059980966,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980966)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980966)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980966)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980966;
",Sucesso,
210059085153,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085153
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059540785,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059540785
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM aluno_dados a, comparacao_estado e, comparacao_municipio m, comparacao_renda r;
",Falha,
210060801616,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801616;

-- Estatísticas do desempenho no mesmo estado
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801616);

-- Comparação com alunos da mesma cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
    AVG(nu_nota_comp1) AS media_comp1_cidade,
    AVG(nu_nota_comp2) AS media_comp2_cidade,
    AVG(nu_nota_comp3) AS media_comp3_cidade,
    AVG(nu_nota_comp4) AS media_comp4_cidade,
    AVG(nu_nota_comp5) AS media_comp5_cidade
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801616);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801616);
",Sucesso,
210060214103,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214103)) AS avg_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214103)) AS avg_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214103)) AS avg_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214103;
",Sucesso,
210059980964,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980964;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980964) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980964);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980964);
",Sucesso,
210058061555,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061555) 
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061555)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061555)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058061555;
",Sucesso,
210059855138,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855138
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    aluno_dados.*, 
    alunos_estado.*, 
    alunos_renda.*
FROM 
    aluno_dados, 
    alunos_estado, 
    alunos_renda;
",Sucesso,
210058387349,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387349;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387349)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387349)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    renda_comparacao;
",Sucesso,
210059085154,"
SELECT
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM database.schema.table WHERE sg_uf_esc = t.sg_uf_esc AND no_municipio_esc = t.no_municipio_esc) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM database.schema.table WHERE sg_uf_esc = t.sg_uf_esc) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM database.schema.table WHERE Q006 = (SELECT Q006 FROM database.schema.table WHERE nu_inscricao = 210059085154)) AS media_redacao_renda
FROM
    database.enem.base_enem t
WHERE
    nu_inscricao = 210059085154;
",Falha,
210060801617,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801617;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801617)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801617);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801617);
",Sucesso,
210059540786,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540786;

-- Comparação com alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540786)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540786);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540786);
",Sucesso,
210061244816,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244816;

WITH EstatisticasEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos,
        COUNT(CASE WHEN nu_nota_redacao >= 600 THEN 1 END) AS alunos_acima_600
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244816)
),
EstatisticasMunicipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        COUNT(*) AS total_alunos_municipio,
        COUNT(CASE WHEN nu_nota_redacao >= 600 THEN 1 END) AS alunos_acima_600_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244816)
),
EstatisticasRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        COUNT(*) AS total_alunos_renda,
        COUNT(CASE WHEN nu_nota_redacao >= 600 THEN 1 END) AS alunos_acima_600_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244816)
)

SELECT 
    e.estado,
    e.media_nota_redacao,
    e.total_alunos,
    e.alunos_acima_600,
    m.media_nota_redacao_municipio,
    m.total_alunos_municipio,
    m.alunos_acima_600_municipio,
    r.media_nota_redacao_renda,
    r.total_alunos_renda,
    r.alunos_acima_600_renda
FROM 
    EstatisticasEstado e,
    EstatisticasMunicipio m,
    EstatisticasRenda r;
",Falha,
210059589806,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589806;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589806) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589806);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589806);
",Sucesso,
210058954684,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954684
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210059974480,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974480;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS avg_comp1,
    AVG(nu_nota_comp2) AS avg_comp2,
    AVG(nu_nota_comp3) AS avg_comp3,
    AVG(nu_nota_comp4) AS avg_comp4,
    AVG(nu_nota_comp5) AS avg_comp5,
    AVG(nu_nota_redacao) AS avg_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974480)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974480);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS avg_comp1_renda,
    AVG(nu_nota_comp2) AS avg_comp2_renda,
    AVG(nu_nota_comp3) AS avg_comp3_renda,
    AVG(nu_nota_comp4) AS avg_comp4_renda,
    AVG(nu_nota_comp5) AS avg_comp5_renda,
    AVG(nu_nota_redacao) AS avg_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974480);
",Sucesso,
210059982350,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982350
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    d.nu_inscricao,
    d.nu_nota_comp1,
    d.nu_nota_comp2,
    d.nu_nota_comp3,
    d.nu_nota_comp4,
    d.nu_nota_comp5,
    d.nu_nota_redacao,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    desempenho_aluno d,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210058573845,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573845
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    m.media_nota_redacao AS media_municipio,
    r.media_nota_redacao AS media_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210061244817,"
WITH aluno_desempenho AS (
    SELECT
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM
        db.enem.base_enem
    WHERE
        nu_inscricao = 210061244817
),
desempenho_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_municipio AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT
    ad.*,
    des.media_nota_redacao,
    des.media_comp1,
    des.media_comp2,
    des.media_comp3,
    des.media_comp4,
    des.media_comp5,
    dmu.media_nota_redacao_municipio,
    dmu.media_comp1_municipio,
    dmu.media_comp2_municipio,
    dmu.media_comp3_municipio,
    dmu.media_comp4_municipio,
    dmu.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM
    aluno_desempenho ad,
    desempenho_estado des,
    desempenho_municipio dmu,
    desempenho_renda dr;
",Sucesso,
210061347472,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347472;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347472)
)

SELECT 
    *
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061347472)
)

SELECT 
    *
FROM 
    renda_comparacao;
",Sucesso,
210059589807,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589807
),
estudantes_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estudantes_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estudantes_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.avg_comp1 AS avg_comp1_estado,
    e.avg_comp2 AS avg_comp2_estado,
    e.avg_comp3 AS avg_comp3_estado,
    e.avg_comp4 AS avg_comp4_estado,
    e.avg_comp5 AS avg_comp5_estado,
    e.avg_redacao AS avg_redacao_estado,
    c.avg_comp1 AS avg_comp1_cidade,
    c.avg_comp2 AS avg_comp2_cidade,
    c.avg_comp3 AS avg_comp3_cidade,
    c.avg_comp4 AS avg_comp4_cidade,
    c.avg_comp5 AS avg_comp5_cidade,
    c.avg_redacao AS avg_redacao_cidade,
    r.avg_comp1 AS avg_comp1_renda,
    r.avg_comp2 AS avg_comp2_renda,
    r.avg_comp3 AS avg_comp3_renda,
    r.avg_comp4 AS avg_comp4_renda,
    r.avg_comp5 AS avg_comp5_renda,
    r.avg_redacao AS avg_redacao_renda
FROM 
    aluno_info a,
    estudantes_estado e,
    estudantes_cidade c,
    estudantes_renda r;
",Sucesso,
210058954686,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954686;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954686)
)

SELECT 
    estado_comparativo.*,
    b.nu_nota_redacao,
    b.nu_nota_comp1,
    b.nu_nota_comp2,
    b.nu_nota_comp3,
    b.nu_nota_comp4,
    b.nu_nota_comp5
FROM 
    estado_comparativo,
    db.enem.base_enem b
WHERE 
    b.nu_inscricao = 210058954686;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954686)
)

SELECT 
    renda_comparativa.*,
    b.nu_nota_redacao,
    b.nu_nota_comp1,
    b.nu_nota_comp2,
    b.nu_nota_comp3,
    b.nu_nota_comp4,
    b.nu_nota_comp5
FROM 
    renda_comparativa,
    db.enem.base_enem b
WHERE 
    b.nu_inscricao = 210058954686;
",Sucesso,
210059974481,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974481
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_desempenho a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
",Sucesso,
210061337618,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337618
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059589797,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589797;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589797)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589797);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589797);
",Sucesso,
210058941531,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941531)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941531 OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941531) AND 
     no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941531))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210059974470,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974470
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
",Sucesso,
210059982340,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982340;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982340)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982340);

-- Análise de desempenho com base na faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982340);
",Sucesso,
210060440995,"
WITH aluno_info AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060440995
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059246992,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc, no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246992;
",Sucesso,
210061337620,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337620;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337620)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337620)
);

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT * FROM renda_comparacao) AS comparacao_renda;
",Falha,
210059589798,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589798)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589798)
    ) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589798)
    ) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059589798;
",Sucesso,
210058941533,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941533;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941533)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941533)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    renda_comparativa;
",Sucesso,
210058573841,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573841;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573841)
);

WITH municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573841)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573841)
)

SELECT 
    e.*,
    m.*,
    r.*
FROM 
    estado_comparativo e,
    municipio_comparativo m,
    renda_comparativa r;
",Falha,
210061337632,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337632;

-- Comparação de desempenho com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337632)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337632);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337632);
",Sucesso,
210059974476,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974476
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_mun,
        AVG(nu_nota_comp1) AS media_comp1_mun,
        AVG(nu_nota_comp2) AS media_comp2_mun,
        AVG(nu_nota_comp3) AS media_comp3_mun,
        AVG(nu_nota_comp4) AS media_comp4_mun,
        AVG(nu_nota_comp5) AS media_comp5_mun
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_mun,
    dm.media_comp1_mun,
    dm.media_comp2_mun,
    dm.media_comp3_mun,
    dm.media_comp4_mun,
    dm.media_comp5_mun,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210059982346,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982346)) AS media_redacao_uf,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982346)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982346)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982346;
",Sucesso,
210060441001,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441001;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441001)
);

WITH estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441001)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441001)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_cidade) AS estatisticas_cidade,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
",Falha,
210060376433,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376433;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376433)
)

SELECT 
    * 
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376433)
)

SELECT 
    * 
FROM 
    renda_comparacao;
",Sucesso,
210058573842,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573842;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573842)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573842);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573842);
",Sucesso,
210059246998,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246998;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246998)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246998)
);

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estado_comparacao e,
    renda_comparacao r;
",Falha,
210061244813,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244813;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1, 
    AVG(nu_nota_comp2) AS media_comp2, 
    AVG(nu_nota_comp3) AS media_comp3, 
    AVG(nu_nota_comp4) AS media_comp4, 
    AVG(nu_nota_comp5) AS media_comp5, 
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244813)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244813);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda, 
    AVG(nu_nota_comp2) AS media_comp2_renda, 
    AVG(nu_nota_comp3) AS media_comp3_renda, 
    AVG(nu_nota_comp4) AS media_comp4_renda, 
    AVG(nu_nota_comp5) AS media_comp5_renda, 
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244813);
",Sucesso,
210061337634,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337634;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337634)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337634);

-- Análise do desempenho com base na faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337634);
",Sucesso,
210059589803,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589803;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589803)
);

WITH cidade_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589803)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589803)
);

SELECT 
    'Estado' AS comparativo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparativo

UNION ALL

SELECT 
    'Cidade' AS comparativo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    cidade_comparativo

UNION ALL

SELECT 
    'Renda' AS comparativo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    renda_comparativa;
",Falha,
210058954678,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954678
),
desempenho_estadual AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipal AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_nota_redacao AS media_estadual,
    de.media_comp1 AS media_comp1_estadual,
    de.media_comp2 AS media_comp2_estadual,
    de.media_comp3 AS media_comp3_estadual,
    de.media_comp4 AS media_comp4_estadual,
    de.media_comp5 AS media_comp5_estadual,
    dm.media_nota_redacao AS media_municipal,
    dm.media_comp1 AS media_comp1_municipal,
    dm.media_comp2 AS media_comp2_municipal,
    dm.media_comp3 AS media_comp3_municipal,
    dm.media_comp4 AS media_comp4_municipal,
    dm.media_comp5 AS media_comp5_municipal,
    dr.media_nota_redacao AS media_nota_redacao_renda,
    dr.media_comp1 AS media_comp1_renda,
    dr.media_comp2 AS media_comp2_renda,
    dr.media_comp3 AS media_comp3_renda,
    dr.media_comp4 AS media_comp4_renda,
    dr.media_comp5 AS media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estadual de,
    desempenho_municipal dm,
    desempenho_renda dr;
",Sucesso,
210059974477,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM db.enem.base_enem
    WHERE nu_inscricao = 210059974477
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    m.media_nota_redacao AS media_municipio,
    r.media_nota_redacao AS media_renda
FROM aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059982347,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982347;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982347)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d, desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982347)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d, desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
",Falha,
210060376434,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376434;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376434)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376434)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376434)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
",Falha,
210059246999,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246999;

-- Estatísticas do desempenho no mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246999)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246999);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246999);
",Sucesso,
210061244814,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244814;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244814)
),

desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244814)
),

desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244814)
)

SELECT 
    (SELECT * FROM desempenho_estado) AS desempenho_estado,
    (SELECT * FROM desempenho_municipio) AS desempenho_municipio,
    (SELECT * FROM desempenho_renda) AS desempenho_renda;
",Falha,
210061337637,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337637;

-- Estatísticas de desempenho em relação a alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337637) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337637);

-- Análise de desempenho em relação a alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337637);
",Sucesso,
210058954680,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954680
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059589804,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589804;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589804)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589804)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589804)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado, 
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio, 
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
",Falha,
210060441003,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441003;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441003)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441003);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441003);
",Sucesso,
210058573843,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573843
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
",Sucesso,
210059247000,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059247000
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210061244815,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061244815
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210061337640,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337640;
",Sucesso,
210059589805,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589805;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589805)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589805);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589805);
",Sucesso,
210058954682,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954682;
",Sucesso,
210059974479,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974479;
",Sucesso,
210059982349,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = e.no_municipio_esc) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982349)) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210059982349;
",Sucesso,
210060441004,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441004;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441004)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441004);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441004);
",Sucesso,
210059247001,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059247001
),
estudantes_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estudantes_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estudantes_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    c.media_nota_redacao_cidade,
    c.media_comp1_cidade,
    c.media_comp2_cidade,
    c.media_comp3_cidade,
    c.media_comp4_cidade,
    c.media_comp5_cidade,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estudantes_estado e,
    estudantes_cidade c,
    estudantes_renda r;
",Sucesso,
210060440996,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440996;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440996)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440996)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440996)
)

SELECT 
    'Estatísticas por Estado' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Estatísticas por Município' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Estatísticas por Faixa de Renda' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
",Sucesso,
210060376428,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc) AS media_nota_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = e.no_municipio_esc) AS media_nota_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376428)) AS media_nota_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210060376428;
",Sucesso,
210061244808,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244808)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244808)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244808)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244808;
",Sucesso,
210061337623,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337623;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337623)
)

SELECT 
    *
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337623)
)

SELECT 
    *
FROM 
    renda_comparacao;
",Sucesso,
210059589799,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589799
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210058954668,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954668;

WITH estado_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954668) AND
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954668)
),
renda_familia AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954668)
)

SELECT 
    e.media_nota_redacao, 
    e.media_comp1, 
    e.media_comp2, 
    e.media_comp3, 
    e.media_comp4, 
    e.media_comp5,
    r.media_nota_redacao_renda, 
    r.media_comp1_renda, 
    r.media_comp2_renda, 
    r.media_comp3_renda, 
    r.media_comp4_renda, 
    r.media_comp5_renda
FROM 
    estado_cidade e, 
    renda_familia r;
",Sucesso,
210059974472,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974472)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974472)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974472)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974472;
",Sucesso,
210059982342,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982342;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982342) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982342);

-- Análise com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982342);
",Sucesso,
210060440997,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440997;

WITH PerformanceComparison AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440997)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440997)
),
IncomeComparison AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440997)
)

SELECT 
    pc.*,
    ic.*
FROM 
    PerformanceComparison pc,
    IncomeComparison ic;
",Sucesso,
210058573838,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573838;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573838)
),

municipio_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573838)
),

renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573838)
)

SELECT 
    (SELECT * FROM estado_comparacao) AS estado,
    (SELECT * FROM municipio_comparacao) AS municipio,
    (SELECT * FROM renda_comparacao) AS renda;
",Falha,
210060376429,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376429;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376429)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376429);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376429);
",Sucesso,
210058954672,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954672
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    aluno_dados.*,
    comparativo_estado.*,
    comparativo_municipio.*,
    comparativo_renda.*
FROM 
    aluno_dados,
    comparativo_estado,
    comparativo_municipio,
    comparativo_renda;
",Sucesso,
210059982344,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982344;
",Sucesso,
210058573840,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573840
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.*,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    de.media_redacao,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dm.media_redacao_municipio,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda,
    dr.media_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210059246996,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246996;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246996)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246996);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246996);
",Sucesso,
210061244811,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061244811
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_nota_comp1_municipio,
        AVG(nu_nota_comp2) AS media_nota_comp2_municipio,
        AVG(nu_nota_comp3) AS media_nota_comp3_municipio,
        AVG(nu_nota_comp4) AS media_nota_comp4_municipio,
        AVG(nu_nota_comp5) AS media_nota_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_nota_comp1_renda,
        AVG(nu_nota_comp2) AS media_nota_comp2_renda,
        AVG(nu_nota_comp3) AS media_nota_comp3_renda,
        AVG(nu_nota_comp4) AS media_nota_comp4_renda,
        AVG(nu_nota_comp5) AS media_nota_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_nota_comp1,
    e.media_nota_comp2,
    e.media_nota_comp3,
    e.media_nota_comp4,
    e.media_nota_comp5,
    m.media_nota_redacao_municipio,
    m.media_nota_comp1_municipio,
    m.media_nota_comp2_municipio,
    m.media_nota_comp3_municipio,
    m.media_nota_comp4_municipio,
    m.media_nota_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_nota_comp1_renda,
    r.media_nota_comp2_renda,
    r.media_nota_comp3_renda,
    r.media_nota_comp4_renda,
    r.media_nota_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059589801,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = t.sg_uf_esc) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = t.no_municipio_esc) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589801)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem t
WHERE 
    nu_inscricao = 210059589801;
",Sucesso,
210059974475,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974475
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.*,
    de.avg_comp1 AS avg_comp1_estado,
    de.avg_comp2 AS avg_comp2_estado,
    de.avg_comp3 AS avg_comp3_estado,
    de.avg_comp4 AS avg_comp4_estado,
    de.avg_comp5 AS avg_comp5_estado,
    de.avg_redacao AS avg_redacao_estado,
    dm.avg_comp1 AS avg_comp1_municipio,
    dm.avg_comp2 AS avg_comp2_municipio,
    dm.avg_comp3 AS avg_comp3_municipio,
    dm.avg_comp4 AS avg_comp4_municipio,
    dm.avg_comp5 AS avg_comp5_municipio,
    dm.avg_redacao AS avg_redacao_municipio,
    dr.avg_comp1 AS avg_comp1_renda,
    dr.avg_comp2 AS avg_comp2_renda,
    dr.avg_comp3 AS avg_comp3_renda,
    dr.avg_comp4 AS avg_comp4_renda,
    dr.avg_comp5 AS avg_comp5_renda,
    dr.avg_redacao AS avg_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210060441000,"
SELECT 
    b.nu_inscricao,
    b.nu_nota_redacao,
    b.nu_nota_comp1,
    b.nu_nota_comp2,
    b.nu_nota_comp3,
    b.nu_nota_comp4,
    b.nu_nota_comp5,
    AVG(b.nu_nota_redacao) OVER (PARTITION BY b.sg_uf_esc) AS media_nota_redacao_uf,
    AVG(b.nu_nota_redacao) OVER (PARTITION BY b.no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(b.nu_nota_redacao) OVER (PARTITION BY b.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem b
WHERE 
    b.nu_inscricao = 210060441000;
",Sucesso,
210059246994,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
    ) AS media_redacao_estado_municipio,
    (SELECT COUNT(*) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
     AND Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
    ) AS total_alunos_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059246994;
",Sucesso,
210061337625,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337625)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337625)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337625)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061337625;
",Sucesso,
210058954670,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954670
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_comp1, 
    da.nu_nota_comp2, 
    da.nu_nota_comp3, 
    da.nu_nota_comp4, 
    da.nu_nota_comp5, 
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210059974473,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974473;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974473)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparacao) AS media_estado_redacao,
    (SELECT media_comp1 FROM estado_comparacao) AS media_estado_comp1,
    (SELECT media_comp2 FROM estado_comparacao) AS media_estado_comp2,
    (SELECT media_comp3 FROM estado_comparacao) AS media_estado_comp3,
    (SELECT media_comp4 FROM estado_comparacao) AS media_estado_comp4,
    (SELECT media_comp5 FROM estado_comparacao) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974473);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974473)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparacao) AS media_renda_nota_redacao,
    (SELECT media_comp1_renda FROM renda_comparacao) AS media_renda_comp1,
    (SELECT media_comp2_renda FROM renda_comparacao) AS media_renda_comp2,
    (SELECT media_comp3_renda FROM renda_comparacao) AS media_renda_comp3,
    (SELECT media_comp4_renda FROM renda_comparacao) AS media_renda_comp4,
    (SELECT media_comp5_renda FROM renda_comparacao) AS media_renda_comp5
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao <> 210059974473 AND Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974473);
",Sucesso,
210059982343,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982343
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210060440998,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440998;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440998)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440998);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440998);
",Sucesso,
210058573839,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573839
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
",Sucesso,
210059246995,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246995)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246995)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246995)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246995;
",Sucesso,
210061244810,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244810)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244810)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244810)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061244810;
",Sucesso,
210061337627,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337627)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337627)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337627)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061337627;
",Sucesso,
210059589800,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589800;

WITH comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589800)
),

comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589800)
),

comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589800)
)

SELECT 
    'Estado' AS tipo_comparacao,
    media_nota_redacao,
    media_nota_comp1,
    media_nota_comp2,
    media_nota_comp3,
    media_nota_comp4,
    media_nota_comp5
FROM 
    comparacao_estado
UNION ALL
SELECT 
    'Município' AS tipo_comparacao,
    media_nota_redacao,
    media_nota_comp1,
    media_nota_comp2,
    media_nota_comp3,
    media_nota_comp4,
    media_nota_comp5
FROM 
    comparacao_municipio
UNION ALL
SELECT 
    'Renda' AS tipo_comparacao,
    media_nota_redacao,
    media_nota_comp1,
    media_nota_comp2,
    media_nota_comp3,
    media_nota_comp4,
    media_nota_comp5
FROM 
    comparacao_renda;
",Sucesso,
210058573849,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573849;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573849)
)

SELECT 
    e.*,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5
FROM 
    db.enem.base_enem e
CROSS JOIN 
    estatisticas_estado es
WHERE 
    e.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573849);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573849)
)

SELECT 
    e.*,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    db.enem.base_enem e
CROSS JOIN 
    estatisticas_renda er
WHERE 
    e.Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573849);
",Sucesso,
210059260088,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260088)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260088)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260088)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260088;
",Sucesso,
210061244822,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244822) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244822)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244822)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061244822;
",Sucesso,
210059974486,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974486
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    aluno_dados.*, 
    estatisticas_estado.*, 
    estatisticas_municipio.*, 
    estatisticas_renda.*
FROM 
    aluno_dados,
    estatisticas_estado,
    estatisticas_municipio,
    estatisticas_renda;
",Sucesso,
210060441011,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441011)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441011)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441011)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441011;
",Sucesso,
210058573850,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573850
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210059260089,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260089;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260089)
)

SELECT 
    estado_comparativo.*,
    (SELECT 
        AVG(nu_nota_redacao) 
     FROM 
        db.enem.base_enem 
     WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260089) 
        AND Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260089)) AS media_nota_redacao_renda
FROM 
    estado_comparativo;
",Sucesso,
210061347483,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347483;
",Sucesso,
210061244823,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244823;

-- Estatísticas para comparar desempenho com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244823)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244823);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244823);
",Sucesso,
210058954697,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954697)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954697)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954697)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058954697;
",Sucesso,
210060441012,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441012;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441012)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441012);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441012);
",Sucesso,
210058573851,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573851;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573851)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573851)
)

SELECT 
    *
FROM 
    renda_comparativa;
",Sucesso,
210061244824,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244824;

-- Estatísticas para comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244824)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244824);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244824);
",Sucesso,
210061347486,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061347486
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_dados a
JOIN 
    estatisticas_estado e ON TRUE
JOIN 
    estatisticas_municipio m ON TRUE
JOIN 
    estatisticas_renda r ON TRUE;
",Sucesso,
210059974488,"
SELECT 
    e.nu_inscricao,
    e.no_municipio_esc,
    e.sg_uf_esc,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210059974488;
",Sucesso,
210059897897,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059897897;

WITH ComparacaoEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059897897)
),

ComparacaoMunicipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059897897)
),

ComparacaoRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059897897)
)

SELECT 
    (SELECT * FROM ComparacaoEstado) AS estado,
    (SELECT * FROM ComparacaoMunicipio) AS municipio,
    (SELECT * FROM ComparacaoRenda) AS renda;
",Falha,
210060441013,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441013)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441013)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441013)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441013;
",Sucesso,
210061103970,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103970;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103970)
)

SELECT 
    d.*, 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d,
    desempenho_estado e
WHERE 
    d.sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103970);

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103970)
)

SELECT 
    d.*, 
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d,
    desempenho_renda r
WHERE 
    d.Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103970);
",Sucesso,
210059401152,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059401152
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210058387356,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387356;
",Sucesso,
210059085161,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085161)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085161)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085161)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085161;
",Sucesso,
210059540793,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    sg_uf_esc,
    no_municipio_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540793;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540793)
)

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT AVG(nu_nota_redacao) AS media_nota_redacao_renda
     FROM db.enem.base_enem
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540793)
     AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540793)
    ) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540793;
",Falha,
210061103971,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103971
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103971)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103971))
    OR (Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103971))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210060214111,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214111;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214111)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214111);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214111);
",Sucesso,
210059401153,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059401153;

-- Estatísticas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059401153)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059401153);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059401153);
",Sucesso,
210058387357,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387357;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387357)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387357)
);

SELECT 
    est.media_nota_redacao,
    est.media_comp1,
    est.media_comp2,
    est.media_comp3,
    est.media_comp4,
    est.media_comp5,
    renda.media_nota_redacao_renda,
    renda.media_comp1_renda,
    renda.media_comp2_renda,
    renda.media_comp3_renda,
    renda.media_comp4_renda,
    renda.media_comp5_renda
FROM 
    estado_comparativo est,
    renda_comparativa renda;
",Falha,
210059085162,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085162;
",Sucesso,
210060811453,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS media_nota_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS media_nota_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS media_nota_redacao_renda
FROM database.enem.base_enem
WHERE nu_inscricao = 210060811453
GROUP BY nu_inscricao;
",Falha,
210059540794,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540794;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540794)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540794);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540794);
",Sucesso,
210061103972,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103972)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103972)) AS media_redacao_estado_municipio,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103972)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103972;
",Sucesso,
210060214112,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214112
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210059401154,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059401154;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059401154)
)

SELECT 
    e.media_nota_redacao, 
    e.media_comp1, 
    e.media_comp2, 
    e.media_comp3, 
    e.media_comp4, 
    e.media_comp5
FROM 
    estado_comparativo e;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059401154)
)

SELECT 
    r.media_nota_redacao, 
    r.media_comp1, 
    r.media_comp2, 
    r.media_comp3, 
    r.media_comp4, 
    r.media_comp5
FROM 
    renda_comparativa r;
",Sucesso,
210059980973,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980973)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980973)
    ) AS avg_redacao_same_state_city,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980973)
    ) AS avg_redacao_same_income
FROM db.enem.base_enem 
WHERE nu_inscricao = 210059980973;
",Sucesso,
210059982351,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982351;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982351)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982351)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982351)
)

SELECT 
    e_estado.media_nota_redacao AS media_estado_redacao,
    e_estado.media_comp1 AS media_estado_comp1,
    e_estado.media_comp2 AS media_estado_comp2,
    e_estado.media_comp3 AS media_estado_comp3,
    e_estado.media_comp4 AS media_estado_comp4,
    e_estado.media_comp5 AS media_estado_comp5,
    e_municipio.media_nota_redacao AS media_municipio_redacao,
    e_municipio.media_comp1 AS media_municipio_comp1,
    e_municipio.media_comp2 AS media_municipio_comp2,
    e_municipio.media_comp3 AS media_municipio_comp3,
    e_municipio.media_comp4 AS media_municipio_comp4,
    e_municipio.media_comp5 AS media_municipio_comp5,
    e_renda.media_nota_redacao AS media_renda_redacao,
    e_renda.media_comp1 AS media_renda_comp1,
    e_renda.media_comp2 AS media_renda_comp2,
    e_renda.media_comp3 AS media_renda_comp3,
    e_renda.media_comp4 AS media_renda_comp4,
    e_renda.media_comp5 AS media_renda_comp5
FROM 
    estatisticas_estado e_estado,
    estatisticas_municipio e_municipio,
    estatisticas_renda e_renda;
",Falha,
210060441006,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060441006
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
",Sucesso,
210060376438,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376438;

-- Estatísticas comparativas
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376438)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376438);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376438);
",Sucesso,
210058573846,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573846;

-- Estatísticas de desempenho no mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573846)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573846);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573846);
",Sucesso,
210059247003,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059247003)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059247003)
    ) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059247003)
    ) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059247003;
",Sucesso,
210061347475,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347475;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347475)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347475);

-- Análise de desempenho com base na faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061347475);
",Sucesso,
210061244818,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244818;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244818)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244818)
),

renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244818)
)

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativa) AS comparativo_renda;
",Falha,
210059589808,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589808;

-- Estatísticas comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589808)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589808);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589808);
",Sucesso,
210059974482,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974482)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974482)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974482)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974482;
",Sucesso,
210059982352,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982352;

WITH performance_state AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao,
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982352)
);

WITH performance_income AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao_income,
        AVG(nu_nota_comp1) AS avg_comp1_income,
        AVG(nu_nota_comp2) AS avg_comp2_income,
        AVG(nu_nota_comp3) AS avg_comp3_income,
        AVG(nu_nota_comp4) AS avg_comp4_income,
        AVG(nu_nota_comp5) AS avg_comp5_income
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982352)
);

SELECT 
    (SELECT * FROM performance_state) AS state_performance,
    (SELECT * FROM performance_income) AS income_performance;
",Falha,
210060441007,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060441007
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_desempenho a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
",Sucesso,
210060376439,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376439)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376439)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376439)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376439;
",Sucesso,
210058573847,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) AS total_alunos,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    COUNT(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573847) THEN 1 END) AS total_mesma_renda,
    AVG(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573847) THEN nu_nota_redacao END) AS media_nota_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573847 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573847) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573847))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210059974484,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059974484;

-- Desempenho dos alunos do mesmo Estado e Cidade
SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974484)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974484);

-- Desempenho comparando com alunos da mesma faixa de renda
SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974484);
",Sucesso,
210060441009,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441009;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441009)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441009);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441009);
",Sucesso,
210058573848,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573848;

WITH Estado_Comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573848)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM Estado_Comparativo) AS media_estado_nota_redacao,
    (SELECT media_comp1 FROM Estado_Comparativo) AS media_estado_comp1,
    (SELECT media_comp2 FROM Estado_Comparativo) AS media_estado_comp2,
    (SELECT media_comp3 FROM Estado_Comparativo) AS media_estado_comp3,
    (SELECT media_comp4 FROM Estado_Comparativo) AS media_estado_comp4,
    (SELECT media_comp5 FROM Estado_Comparativo) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573848);

WITH Renda_Comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573848)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM Renda_Comparativa) AS media_renda_nota_redacao,
    (SELECT media_comp1_renda FROM Renda_Comparativa) AS media_renda_comp1,
    (SELECT media_comp2_renda FROM Renda_Comparativa) AS media_renda_comp2,
    (SELECT media_comp3_renda FROM Renda_Comparativa) AS media_renda_comp3,
    (SELECT media_comp4_renda FROM Renda_Comparativa) AS media_renda_comp4,
    (SELECT media_comp5_renda FROM Renda_Comparativa) AS media_renda_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573848);
",Sucesso,
210059260087,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260087;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260087)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260087);

-- Desempenho de alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260087);
",Sucesso,
210061244821,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244821)) OVER () AS total_faixa_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244821)) OVER () AS media_faixa_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244821;
",Sucesso,
210061347480,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061347480
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
comparativo_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_desempenho a,
    comparativo_estado e,
    comparativo_cidade c,
    comparativo_renda r;
",Sucesso,
210059589811,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589811)) AS media_uf_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589811)) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589811)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589811;
",Sucesso,
210059974485,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974485;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974485)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d, desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974485)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d, desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
",Falha,
210060441010,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441010;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441010)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441010);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441010);
",Sucesso,
210059247004,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059247004
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_renda r;
",Sucesso,
210061347476,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347476;

-- Desempenho dos alunos no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347476)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347476);

-- Desempenho de alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061347476);
",Sucesso,
210058954689,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954689;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954689)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954689)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954689)
)

SELECT 
    'Estado' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Município' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Renda' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
",Falha,
210059982353,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982353;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982353) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982353);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982353);
",Sucesso,
210060441008,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441008)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441008)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441008)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441008;
",Sucesso,
210060376440,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376440;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376440)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376440);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376440);
",Sucesso,
210059260086,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260086)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260086)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260086)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260086;
",Sucesso,
210061244820,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244820)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244820)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244820)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244820;
",Sucesso,
210059589810,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589810;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589810)
)

SELECT * FROM desempenho_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589810)
)

SELECT * FROM desempenho_renda;
",Sucesso,
210061347477,"
SELECT 
    e.nu_inscricao,
    e.no_municipio_esc,
    e.sg_uf_esc,
    e.tp_status_redacao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_nota_redacao_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210061347477;
",Sucesso,
210058954691,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954691;
",Sucesso,
210060811464,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) AS total_alunos_estado,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    COUNT(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060811464) THEN 1 END) AS total_alunos_renda,
    AVG(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060811464) THEN nu_nota_redacao END) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060811464 OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811464) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811464))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210059540805,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540805;

WITH ComparativoEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540805)
),

ComparativoMunicipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540805)
)

SELECT 
    (SELECT * FROM ComparativoEstado) AS EstatisticasEstado,
    (SELECT * FROM ComparativoMunicipio) AS EstatisticasMunicipio;

WITH ComparativoRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540805)
)

SELECT 
    (SELECT * FROM ComparativoRenda) AS EstatisticasRenda;
",Falha,
210061103982,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103982;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103982)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103982)
)

SELECT 
    *
FROM 
    renda_comparativa;
",Sucesso,
210059401165,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) FILTER (WHERE nu_nota_redacao >= 0) AS total_alunos,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059401165)) AS media_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059401165)) AS media_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059401165)) AS media_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059401165
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
",Falha,
210058073319,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058073319;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073319)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073319)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058073319)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
",Sucesso,
210059868183,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059868183;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059868183)
)

SELECT 
    (SELECT media_nota_redacao FROM desempenho_estado) AS media_nota_redacao_estado,
    (SELECT media_comp1 FROM desempenho_estado) AS media_comp1_estado,
    (SELECT media_comp2 FROM desempenho_estado) AS media_comp2_estado,
    (SELECT media_comp3 FROM desempenho_estado) AS media_comp3_estado,
    (SELECT media_comp4 FROM desempenho_estado) AS media_comp4_estado,
    (SELECT media_comp5 FROM desempenho_estado) AS media_comp5_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059868183)
)

SELECT 
    (SELECT media_nota_redacao_renda FROM desempenho_renda) AS media_nota_redacao_renda,
    (SELECT media_comp1_renda FROM desempenho_renda) AS media_comp1_renda,
    (SELECT media_comp2_renda FROM desempenho_renda) AS media_comp2_renda,
    (SELECT media_comp3_renda FROM desempenho_renda) AS media_comp3_renda,
    (SELECT media_comp4_renda FROM desempenho_renda) AS media_comp4_renda,
    (SELECT media_comp5_renda FROM desempenho_renda) AS media_comp5_renda;
",Sucesso,
210059085173,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085173
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_municipio m,
    alunos_renda r;
",Sucesso,
210059540806,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540806
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
",Sucesso,
210058387358,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387358;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387358)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387358);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387358);
",Sucesso,
