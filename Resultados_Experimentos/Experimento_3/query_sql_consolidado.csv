numero_inscricao,query
210061103945,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103945;

-- Estatísticas comparativas com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103945)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103945);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103945);
"
210060214087,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214087
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT 
    ad.nu_inscricao,
    ad.nu_nota_redacao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    de.media_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    aluno_desempenho ad,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059980948,"
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    AVG(b.nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(b.nu_nota_comp1) AS media_comp1_estado,
    AVG(b.nu_nota_comp2) AS media_comp2_estado,
    AVG(b.nu_nota_comp3) AS media_comp3_estado,
    AVG(b.nu_nota_comp4) AS media_comp4_estado,
    AVG(b.nu_nota_comp5) AS media_comp5_estado,
    AVG(c.nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(c.nu_nota_comp1) AS media_comp1_renda,
    AVG(c.nu_nota_comp2) AS media_comp2_renda,
    AVG(c.nu_nota_comp3) AS media_comp3_renda,
    AVG(c.nu_nota_comp4) AS media_comp4_renda,
    AVG(c.nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem a
JOIN 
    db.enem.base_enem b ON a.sg_uf_esc = b.sg_uf_esc AND a.no_municipio_esc = b.no_municipio_esc
JOIN 
    db.enem.base_enem c ON a.Q006 = c.Q006
WHERE 
    a.nu_inscricao = 210059980948
GROUP BY 
    a.nu_inscricao, a.nu_nota_redacao, a.nu_nota_comp1, a.nu_nota_comp2, a.nu_nota_comp3, a.nu_nota_comp4, a.nu_nota_comp5;
"
210060801601,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801601;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801601)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801601)
);

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT * FROM renda_comparacao) AS comparacao_renda;
"
210059085130,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085130
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210060801595,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801595;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801595)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801595);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801595);
"
210060214081,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214081
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210059388087,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388087;

-- Estatísticas de desempenho por estado e município
SELECT 
    sg_uf_esc,
    no_municipio_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388087)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388087)
GROUP BY 
    sg_uf_esc, no_municipio_esc;

-- Análise de desempenho por faixa de renda
SELECT 
    Q006,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388087)
GROUP BY 
    Q006;
"
210059980942,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980942;

WITH comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980942)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980942)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980942)
)

SELECT 
    (SELECT * FROM comparacao_estado) AS estatisticas_estado,
    (SELECT * FROM comparacao_municipio) AS estatisticas_municipio,
    (SELECT * FROM comparacao_renda) AS estatisticas_renda;
"
210058061534,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061534)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061534)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061534)) AS media_renda_redacao
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058061534;
"
210059855117,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855117;

-- Comparação com alunos do mesmo Estado
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_estado,
    AVG(nu_nota_comp2) AS media_comp2_estado,
    AVG(nu_nota_comp3) AS media_comp3_estado,
    AVG(nu_nota_comp4) AS media_comp4_estado,
    AVG(nu_nota_comp5) AS media_comp5_estado,
    AVG(nu_nota_redacao) AS media_redacao_estado
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855117);

-- Comparação com alunos da mesma Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_cidade,
    AVG(nu_nota_comp2) AS media_comp2_cidade,
    AVG(nu_nota_comp3) AS media_comp3_cidade,
    AVG(nu_nota_comp4) AS media_comp4_cidade,
    AVG(nu_nota_comp5) AS media_comp5_cidade,
    AVG(nu_nota_redacao) AS media_redacao_cidade
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855117);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855117);
"
210058387328,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387328) 
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387328)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387328)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058387328;
"
210060801596,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801596;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801596)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_nota_estado,
    (SELECT media_comp1 FROM estado_comparativo) AS media_comp1_estado,
    (SELECT media_comp2 FROM estado_comparativo) AS media_comp2_estado,
    (SELECT media_comp3 FROM estado_comparativo) AS media_comp3_estado,
    (SELECT media_comp4 FROM estado_comparativo) AS media_comp4_estado,
    (SELECT media_comp5 FROM estado_comparativo) AS media_comp5_estado
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801596);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801596)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparativa) AS media_nota_renda,
    (SELECT media_comp1_renda FROM renda_comparativa) AS media_comp1_renda,
    (SELECT media_comp2_renda FROM renda_comparativa) AS media_comp2_renda,
    (SELECT media_comp3_renda FROM renda_comparativa) AS media_comp3_renda,
    (SELECT media_comp4_renda FROM renda_comparativa) AS media_comp4_renda,
    (SELECT media_comp5_renda FROM renda_comparativa) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801596);
"
210061103941,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103941)) AS media_uf,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103941)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103941)) AS media_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103941;
"
210059388088,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388088;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388088)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388088)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388088)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
"
210059980943,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM db.enem.base_enem
    WHERE nu_inscricao = 210059980943
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM db.enem.base_enem
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM db.enem.base_enem
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM db.enem.base_enem
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM aluno_dados a,
     estatisticas_estado e,
     estatisticas_municipio m,
     estatisticas_renda r;
"
210058061535,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061535;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061535)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061535)
)

SELECT 
    *
FROM 
    renda_comparativa;
"
210058387329,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_redacao_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387329;
"
210059085132,"
WITH desempenho_aluno AS (
    SELECT
        nu_inscricao,
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM
        db.enem.base_enem
    WHERE
        nu_inscricao = 210059085132
),
estatisticas_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
estatisticas_cidade AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
estatisticas_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    es.media_nota_redacao AS media_estado,
    es.media_comp1 AS media_comp1_estado,
    es.media_comp2 AS media_comp2_estado,
    es.media_comp3 AS media_comp3_estado,
    es.media_comp4 AS media_comp4_estado,
    es.media_comp5 AS media_comp5_estado,
    ec.media_nota_redacao AS media_cidade,
    ec.media_comp1 AS media_comp1_cidade,
    ec.media_comp2 AS media_comp2_cidade,
    ec.media_comp3 AS media_comp3_cidade,
    ec.media_comp4 AS media_comp4_cidade,
    ec.media_comp5 AS media_comp5_cidade,
    er.media_nota_redacao AS media_renda,
    er.media_comp1 AS media_comp1_renda,
    er.media_comp2 AS media_comp2_renda,
    er.media_comp3 AS media_comp3_renda,
    er.media_comp4 AS media_comp4_renda,
    er.media_comp5 AS media_comp5_renda
FROM 
    desempenho_aluno da,
    estatisticas_estado es,
    estatisticas_cidade ec,
    estatisticas_renda er;
"
210059527731,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527731
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.*,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5,
    es.total_alunos,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda,
    er.total_alunos_renda
FROM 
    aluno_dados ad,
    alunos_estado es,
    alunos_renda er;
"
210060214083,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214083;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214083)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214083);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214083);
"
210058061536,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210058061536
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    ad.nu_inscricao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ce.media_nota_redacao_estado,
    ce.media_comp1_estado,
    ce.media_comp2_estado,
    ce.media_comp3_estado,
    ce.media_comp4_estado,
    ce.media_comp5_estado,
    cm.media_nota_redacao_municipio,
    cm.media_comp1_municipio,
    cm.media_comp2_municipio,
    cm.media_comp3_municipio,
    cm.media_comp4_municipio,
    cm.media_comp5_municipio,
    cr.media_nota_redacao_renda,
    cr.media_comp1_renda,
    cr.media_comp2_renda,
    cr.media_comp3_renda,
    cr.media_comp4_renda,
    cr.media_comp5_renda
FROM aluno_dados ad
JOIN comparacao_estado ce ON true
JOIN comparacao_municipio cm ON true
JOIN comparacao_renda cr ON true;
"
210061103943,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061103943
),
estatisticas_estaduais AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipais AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estaduais e,
    estatisticas_municipais m,
    estatisticas_renda r;
"
210059980946,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = e.no_municipio_esc) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980946)) AS media_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210059980946;
"
210059855121,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059855121
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.avg_comp1 AS estado_avg_comp1,
    e.avg_comp2 AS estado_avg_comp2,
    e.avg_comp3 AS estado_avg_comp3,
    e.avg_comp4 AS estado_avg_comp4,
    e.avg_comp5 AS estado_avg_comp5,
    e.avg_redacao AS estado_avg_redacao,
    m.avg_comp1 AS municipio_avg_comp1,
    m.avg_comp2 AS municipio_avg_comp2,
    m.avg_comp3 AS municipio_avg_comp3,
    m.avg_comp4 AS municipio_avg_comp4,
    m.avg_comp5 AS municipio_avg_comp5,
    m.avg_redacao AS municipio_avg_redacao,
    r.avg_comp1 AS renda_avg_comp1,
    r.avg_comp2 AS renda_avg_comp2,
    r.avg_comp3 AS renda_avg_comp3,
    r.avg_comp4 AS renda_avg_comp4,
    r.avg_comp5 AS renda_avg_comp5,
    r.avg_redacao AS renda_avg_redacao
FROM aluno_dados a
CROSS JOIN estatisticas_estado e
CROSS JOIN estatisticas_municipio m
CROSS JOIN estatisticas_renda r;
"
210059085135,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    CASE 
        WHEN sg_uf_esc = 'SP' THEN 'São Paulo'
        WHEN sg_uf_esc = 'RJ' THEN 'Rio de Janeiro'
        -- Adicione os demais estados conforme necessário
        ELSE sg_uf_esc
    END AS estado,
    no_municipio_esc,
    Q006 AS renda_familiar
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085135;

-- Estatísticas de comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) as media_nota_redacao,
    AVG(nu_nota_comp1) as media_comp1,
    AVG(nu_nota_comp2) as media_comp2,
    AVG(nu_nota_comp3) as media_comp3,
    AVG(nu_nota_comp4) as media_comp4,
    AVG(nu_nota_comp5) as media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085135)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085135);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) as media_nota_redacao,
    AVG(nu_nota_comp1) as media_comp1,
    AVG(nu_nota_comp2) as media_comp2,
    AVG(nu_nota_comp3) as media_comp3,
    AVG(nu_nota_comp4) as media_comp4,
    AVG(nu_nota_comp5) as media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085135);
"
210059527734,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527734
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210061103944,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103944;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103944)
)

SELECT 
    e.media_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estatisticas_estado e;

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103944)
)

SELECT 
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estatisticas_renda r;
"
210060214086,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214086
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210059388092,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059388092
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    e.total_alunos,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda,
    r.total_alunos_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
"
210059980947,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980947;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980947)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980947)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS estado_stats,
    (SELECT * FROM renda_comparativa) AS renda_stats;
"
210059855119,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855119;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855119)
),

desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855119)
),

desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855119)
)

SELECT 
    (SELECT * FROM desempenho_estado) AS desempenho_estado,
    (SELECT * FROM desempenho_municipio) AS desempenho_municipio,
    (SELECT * FROM desempenho_renda) AS desempenho_renda;
"
210058387330,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387330)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387330)) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387330)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387330;
"
210059085133,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085133;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085133)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085133)
)

SELECT 
    *
FROM 
    renda_comparativa;
"
210061103942,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061103942
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    c.media_redacao_cidade,
    c.media_comp1_cidade,
    c.media_comp2_cidade,
    c.media_comp3_cidade,
    c.media_comp4_cidade,
    c.media_comp5_cidade,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_cidade c,
    estatisticas_renda r;
"
210059388090,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059388090;

-- Desempenho médio de alunos do mesmo Estado e Cidade
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388090)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388090);

-- Desempenho médio de alunos da mesma faixa de renda
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388090);
"
210059980945,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980945;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980945)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980945);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980945);
"
210058061537,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061537
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210058387331,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387331)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387331)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387331)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387331;
"
210059085134,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085134;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085134)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085134);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085134);
"
210060801599,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801599;

WITH Estado_Comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801599)
),
Municipio_Comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801599)
),
Renda_Comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801599)
)

SELECT 
    (SELECT * FROM Estado_Comparativo) AS comparativo_estado,
    (SELECT * FROM Municipio_Comparativo) AS comparativo_municipio,
    (SELECT * FROM Renda_Comparativa) AS comparativo_renda;
"
210059527733,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527733
),
estado_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
cidade_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    estado_comparacao e,
    cidade_comparacao c,
    renda_comparacao r;
"
210058941499,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941499) 
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941499)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941499)) AS media_redacao_renda 
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058941499;
"
210059959486,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059959486;

-- Estatísticas comparativas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959486)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959486);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059959486);
"
210058573821,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_uf_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_municipio_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573821
OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573821) 
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573821))
OR 
    (Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573821));
"
210059246977,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246977
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    aluno_dados.*,
    estatisticas_estado.*,
    estatisticas_municipio.*,
    estatisticas_renda.*
FROM 
    aluno_dados,
    estatisticas_estado,
    estatisticas_municipio,
    estatisticas_renda;
"
210059589782,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589782;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589782)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589782)
),
renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589782)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estado_comparativo e,
    renda_comparativa r;
"
210058941500,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941500;
"
210059959487,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059959487
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM aluno_dados a
CROSS JOIN alunos_estado e
CROSS JOIN alunos_renda r;
"
210059982325,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982325;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982325)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982325)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estatisticas_estado e, 
    estatisticas_renda r;
"
210060440980,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440980;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440980)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440980);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440980);
"
210060373830,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373830;

-- Estatísticas de desempenho no mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373830)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373830);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373830);
"
210061103946,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103946;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103946)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103946);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103946);
"
210060214088,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214088;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214088)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214088);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214088);
"
210059388093,"
SELECT
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059388093;

WITH estado_comparacao AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388093)
)

SELECT * FROM estado_comparacao;

WITH renda_comparacao AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388093)
)

SELECT * FROM renda_comparacao;
"
210059980949,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980949;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980949)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980949);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980949);
"
210058061540,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058061540;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem 
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061540)
)

SELECT 
    e.media_estado,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estado_comparativo e;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem 
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061540)
)

SELECT 
    r.media_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    renda_comparativa r;
"
210058387334,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387334
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    c.estado_media_comp1,
    c.estado_media_comp2,
    c.estado_media_comp3,
    c.estado_media_comp4,
    c.estado_media_comp5,
    c.estado_media_redacao,
    r.renda_media_comp1,
    r.renda_media_comp2,
    r.renda_media_comp3,
    r.renda_media_comp4,
    r.renda_media_comp5,
    r.renda_media_redacao
FROM 
    aluno_dados a,
    (SELECT * FROM comparacao_estado) c,
    (SELECT * FROM comparacao_renda) r;
"
210059085138,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085138) 
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085138)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085138)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059085138;
"
210061103947,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103947;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103947)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103947);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103947);
"
210059388094,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388094;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388094)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_estado_redacao,
    (SELECT media_comp1 FROM estado_comparativo) AS media_estado_comp1,
    (SELECT media_comp2 FROM estado_comparativo) AS media_estado_comp2,
    (SELECT media_comp3 FROM estado_comparativo) AS media_estado_comp3,
    (SELECT media_comp4 FROM estado_comparativo) AS media_estado_comp4,
    (SELECT media_comp5 FROM estado_comparativo) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388094);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388094)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparativa) AS media_renda_redacao,
    (SELECT media_comp1_renda FROM renda_comparativa) AS media_renda_comp1,
    (SELECT media_comp2_renda FROM renda_comparativa) AS media_renda_comp2,
    (SELECT media_comp3_renda FROM renda_comparativa) AS media_renda_comp3,
    (SELECT media_comp4_renda FROM renda_comparativa) AS media_renda_comp4,
    (SELECT media_comp5_renda FROM renda_comparativa) AS media_renda_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388094);
"
210059246972,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246972;

-- Estatísticas dos alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246972)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246972);

-- Análise dos alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246972);
"
210061234981,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234981
),
dados_comparativos AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
dados_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    c.media_comp1,
    c.media_comp2,
    c.media_comp3,
    c.media_comp4,
    c.media_comp5,
    c.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    dados_comparativos c,
    dados_renda r;
"
210061327761,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061327761
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_info a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210059587846,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059587846;

-- Estudo estatístico por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587846)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587846);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059587846);
"
210058941492,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941492;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941492)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941492)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    desempenho_renda;
"
210059959482,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059959482)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059959482 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059959482) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059959482))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210058573817,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573817;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573817) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573817);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573817);
"
210061234982,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234982;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234982)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234982);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234982);
"
210061337583,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337583)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337583)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337583)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337583;
"
210059587847,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059587847
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_notas_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_notas_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_notas_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.media_notas_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_notas_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_notas_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210058941494,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        no_municipio_esc,
        sg_uf_esc,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058941494
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_inscricao,
    a.no_municipio_esc,
    a.sg_uf_esc,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_renda r;
"
210060373826,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373826;

WITH Estatisticas AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373826)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373826)
),
RendaFamilia AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373826)
)

SELECT 
    e.*, 
    r.*
FROM 
    Estatisticas e, 
    RendaFamilia r;
"
210058573818,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573818;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573818)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573818);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573818);
"
210059246974,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059246974 
    OR sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)
    OR no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)
    OR Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059246974)
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210061234983,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234983
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210059587848,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059587848;

-- Estatísticas de desempenho no mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587848)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587848);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059587848);
"
210058941496,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941496;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941496)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941496);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941496);
"
210059959484,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959484)
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059959484)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059959484)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059959484;
"
210060440977,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440977;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440977)
)

SELECT 
    * 
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440977)
)

SELECT 
    * 
FROM 
    renda_comparativa;
"
210060373827,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373827;

-- Análise estatística do desempenho dos alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373827)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373827);

-- Análise do desempenho em relação à faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373827);
"
210061234984,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234984
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)
SELECT 
    a.*, 
    e.media_nota_redacao, 
    e.media_comp1, 
    e.media_comp2, 
    e.media_comp3, 
    e.media_comp4, 
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059587849,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059587849;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059587849)
)

SELECT 
    e.*,
    s.*
FROM 
    (SELECT 
        media_nota_redacao,
        media_comp1,
        media_comp2,
        media_comp3,
        media_comp4,
        media_comp5,
        total_alunos
     FROM 
        estatisticas_estado) AS e,
    (SELECT 
        Q006,
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
     FROM 
        db.enem.base_enem
     WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059587849)
     GROUP BY 
        Q006) AS s;
"
210059959485,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059959485
),
estadual_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipal_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ec.media_redacao AS media_estado,
    ec.media_comp1 AS media_comp1_estado,
    ec.media_comp2 AS media_comp2_estado,
    ec.media_comp3 AS media_comp3_estado,
    ec.media_comp4 AS media_comp4_estado,
    ec.media_comp5 AS media_comp5_estado,
    mc.media_redacao AS media_municipio,
    mc.media_comp1 AS media_comp1_municipio,
    mc.media_comp2 AS media_comp2_municipio,
    mc.media_comp3 AS media_comp3_municipio,
    mc.media_comp4 AS media_comp4_municipio,
    mc.media_comp5 AS media_comp5_municipio,
    rc.media_redacao AS media_renda,
    rc.media_comp1 AS media_comp1_renda,
    rc.media_comp2 AS media_comp2_renda,
    rc.media_comp3 AS media_comp3_renda,
    rc.media_comp4 AS media_comp4_renda,
    rc.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados ad,
    estadual_comparacao ec,
    municipal_comparacao mc,
    renda_comparacao rc;
"
210059982323,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982323;

-- Estatísticas de desempenho em comparação com outros alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982323)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982323);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982323);
"
210060373828,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373828;

-- Comparação com alunos do mesmo estado
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373828);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_faixa_renda,
    AVG(nu_nota_comp1) AS media_comp1_faixa_renda,
    AVG(nu_nota_comp2) AS media_comp2_faixa_renda,
    AVG(nu_nota_comp3) AS media_comp3_faixa_renda,
    AVG(nu_nota_comp4) AS media_comp4_faixa_renda,
    AVG(nu_nota_comp5) AS media_comp5_faixa_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373828);
"
210059246976,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246976;

-- Comparativo de desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246976)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246976);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246976);
"
210061234985,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc AND no_municipio_esc = e.no_municipio_esc) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = e.Q006) AS media_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210061234985;
"
210061337589,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337589;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337589)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337589);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337589);
"
210059589781,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589781;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589781)
),

municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589781)
),

renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589781)
)

SELECT 
    'Estado' AS comparativo,
    media_nota_redacao,
    total_alunos
FROM 
    estado_comparativo

UNION ALL

SELECT 
    'Município' AS comparativo,
    media_nota_redacao,
    total_alunos
FROM 
    municipio_comparativo

UNION ALL

SELECT 
    'Faixa de Renda' AS comparativo,
    media_nota_redacao,
    total_alunos
FROM 
    renda_comparativa;
"
210058061541,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061541;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061541)
)

SELECT 
    d.*, 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d
JOIN 
    desempenho_estado e ON d.sg_uf_esc = e.sg_uf_esc
WHERE 
    d.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061541);

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061541)
)

SELECT 
    d.*, 
    r.media_nota_redacao,
    r.media_comp1,
    r.media_comp2,
    r.media_comp3,
    r.media_comp4,
    r.media_comp5
FROM 
    db.enem.base_enem d
JOIN 
    desempenho_renda r ON d.Q006 = r.Q006
WHERE 
    d.nu_inscricao <> 210058061541;
"
210059855124,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855124
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
comparativo_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT 
    ad.nu_inscricao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ce.media_nota_redacao AS media_estado_redacao,
    ce.media_comp1 AS media_estado_comp1,
    ce.media_comp2 AS media_estado_comp2,
    ce.media_comp3 AS media_estado_comp3,
    ce.media_comp4 AS media_estado_comp4,
    ce.media_comp5 AS media_estado_comp5,
    cc.media_nota_redacao_cidade AS media_cidade_redacao,
    cc.media_comp1_cidade AS media_cidade_comp1,
    cc.media_comp2_cidade AS media_cidade_comp2,
    cc.media_comp3_cidade AS media_cidade_comp3,
    cc.media_comp4_cidade AS media_cidade_comp4,
    cc.media_comp5_cidade AS media_cidade_comp5,
    cr.media_nota_redacao_renda AS media_renda_redacao,
    cr.media_comp1_renda AS media_renda_comp1,
    cr.media_comp2_renda AS media_renda_comp2,
    cr.media_comp3_renda AS media_renda_comp3,
    cr.media_comp4_renda AS media_renda_comp4,
    cr.media_comp5_renda AS media_renda_comp5
FROM 
    aluno_desempenho ad,
    comparativo_estado ce,
    comparativo_cidade cc,
    comparativo_renda cr;
"
210058387335,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao,
        no_municipio_esc, 
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387335
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_nota_comp1, 
    da.nu_nota_comp2, 
    da.nu_nota_comp3, 
    da.nu_nota_comp4, 
    da.nu_nota_comp5, 
    da.nu_nota_redacao,
    des_estado.media_redacao AS media_estado_redacao,
    des_estado.media_comp1 AS media_estado_comp1,
    des_estado.media_comp2 AS media_estado_comp2,
    des_estado.media_comp3 AS media_estado_comp3,
    des_estado.media_comp4 AS media_estado_comp4,
    des_estado.media_comp5 AS media_estado_comp5,
    des_municipio.media_redacao AS media_municipio_redacao,
    des_municipio.media_comp1 AS media_municipio_comp1,
    des_municipio.media_comp2 AS media_municipio_comp2,
    des_municipio.media_comp3 AS media_municipio_comp3,
    des_municipio.media_comp4 AS media_municipio_comp4,
    des_municipio.media_comp5 AS media_municipio_comp5,
    des_renda.media_redacao AS media_renda_redacao,
    des_renda.media_comp1 AS media_renda_comp1,
    des_renda.media_comp2 AS media_renda_comp2,
    des_renda.media_comp3 AS media_renda_comp3,
    des_renda.media_comp4 AS media_renda_comp4,
    des_renda.media_comp5 AS media_renda_comp5
FROM 
    desempenho_aluno da,
    desempenho_estado des_estado,
    desempenho_municipio des_municipio,
    desempenho_renda des_renda;
"
210059085139,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085139;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085139)
    GROUP BY 
        sg_uf_esc
),
renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085139)
)
SELECT 
    e.*, 
    r.*
FROM 
    estado_comparativo e, 
    renda_comparativa r;
"
210060801603,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801603;

-- Estatísticas de desempenho em comparação com outros alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    COUNT(*) AS total_alunos,
    COUNT(CASE WHEN nu_nota_redacao > (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210060801603) THEN 1 END) AS alunos_acima_media
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801603) AND 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801603);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    COUNT(*) AS total_alunos_renda,
    COUNT(CASE WHEN nu_nota_redacao > (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210060801603) THEN 1 END) AS alunos_acima_media_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801603);
"
210059527738,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527738;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527738)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527738);

-- Análise por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527738);
"
210059388095,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388095;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388095)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388095)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388095)
);

SELECT 
    'Estado' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado
UNION ALL
SELECT 
    'Município' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio
UNION ALL
SELECT 
    'Renda Familiar' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
"
210059980951,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980951)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980951)) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980951)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980951;
"
210058061542,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061542
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.*,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059855125,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM database.schema.table 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.schema.table WHERE nu_inscricao = 210059855125)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM database.schema.table WHERE nu_inscricao = 210059855125)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM database.schema.table 
     WHERE Q006 = (SELECT Q006 FROM database.schema.table WHERE nu_inscricao = 210059855125)) AS media_redacao_faixa_renda
FROM 
    database.schema.table
WHERE 
    nu_inscricao = 210059855125;
"
210058387336,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387336;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387336)
)

SELECT 
    'Estado' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparativo;

WITH municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387336)
)

SELECT 
    'Municipio' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    municipio_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387336)
)

SELECT 
    'Renda' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    renda_comparativa;
"
210059085140,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085140
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT 
    a.*,
    e.*,
    c.*,
    r.*
FROM 
    aluno_desempenho a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
"
210059855127,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855127 
    OR sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)
    OR no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855127)
    OR Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855127);
"
210059085142,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS media_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085142)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085142
GROUP BY 
    nu_inscricao;
"
210061327759,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061327759)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061327759) AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061327759)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061327759)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061327759;
"
210059587845,"
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    AVG(b.nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(b.nu_nota_comp1) AS media_comp1_estado,
    AVG(b.nu_nota_comp2) AS media_comp2_estado,
    AVG(b.nu_nota_comp3) AS media_comp3_estado,
    AVG(b.nu_nota_comp4) AS media_comp4_estado,
    AVG(b.nu_nota_comp5) AS media_comp5_estado,
    AVG(c.nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(c.nu_nota_comp1) AS media_comp1_renda,
    AVG(c.nu_nota_comp2) AS media_comp2_renda,
    AVG(c.nu_nota_comp3) AS media_comp3_renda,
    AVG(c.nu_nota_comp4) AS media_comp4_renda,
    AVG(c.nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem a
JOIN 
    db.enem.base_enem b ON a.sg_uf_esc = b.sg_uf_esc AND a.no_municipio_esc = b.no_municipio_esc
JOIN 
    db.enem.base_enem c ON a.Q006 = c.Q006
WHERE 
    a.nu_inscricao = 210059587845
GROUP BY 
    a.nu_inscricao, a.nu_nota_redacao, a.nu_nota_comp1, a.nu_nota_comp2, a.nu_nota_comp3, a.nu_nota_comp4, a.nu_nota_comp5;
"
210058941490,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058941490
),
dados_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
dados_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    c.media_nota_redacao,
    c.media_comp1,
    c.media_comp2,
    c.media_comp3,
    c.media_comp4,
    c.media_comp5,
    c.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_dados a,
    dados_comparacao c,
    dados_renda r;
"
210059959481,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059959481
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    ad.nu_nota_redacao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5,
    em.media_nota_redacao_municipio,
    em.media_comp1_municipio,
    em.media_comp2_municipio,
    em.media_comp3_municipio,
    em.media_comp4_municipio,
    em.media_comp5_municipio,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    aluno_dados ad,
    estatisticas_estado es,
    estatisticas_municipio em,
    estatisticas_renda er;
"
210059982319,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982319;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982319)
);

WITH municipio_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982319)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982319)
)

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT * FROM municipio_comparacao) AS comparacao_municipio,
    (SELECT * FROM renda_comparacao) AS comparacao_renda;
"
210060440974,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440974;

-- Estatísticas de desempenho em comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440974)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440974);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440974);
"
210060373824,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373824;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373824)
);

WITH renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373824)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativo) AS comparativo_renda;
"
210059527739,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059527739
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210061103949,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103949)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103949)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103949)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103949;
"
210059388096,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388096;

WITH stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388096)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388096)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM stats) AS media_nota_redacao_estado_cidade,
    (SELECT media_comp1 FROM stats) AS media_comp1_estado_cidade,
    (SELECT media_comp2 FROM stats) AS media_comp2_estado_cidade,
    (SELECT media_comp3 FROM stats) AS media_comp3_estado_cidade,
    (SELECT media_comp4 FROM stats) AS media_comp4_estado_cidade,
    (SELECT media_comp5 FROM stats) AS media_comp5_estado_cidade
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388096);
"
210058061543,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061543;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061543)
)

SELECT 
    estado_comparativo.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058061543) AS nota_aluno
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061543)
)

SELECT 
    renda_comparativa.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058061543) AS nota_aluno
FROM 
    renda_comparativa;
"
210058387337,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387337;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387337)
),

desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387337)
),

desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387337)
)

SELECT 
    e.*, 
    m.*, 
    r.*
FROM 
    desempenho_estado e, 
    desempenho_municipio m, 
    desempenho_renda r;
"
210060801605,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_nota_redacao_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210060801605;
"
210059527740,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527740;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527740)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estatisticas_estado e;

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527740)
)

SELECT 
    r.media_nota_redacao,
    r.media_comp1,
    r.media_comp2,
    r.media_comp3,
    r.media_comp4,
    r.media_comp5
FROM 
    estatisticas_renda r;
"
210061103950,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103950)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103950)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103950)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103950;
"
210060214092,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214092;

-- Consultar desempenho dos alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214092)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214092);

-- Consultar desempenho de alunos com a mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214092);
"
210059388097,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388097)) AS media_redacao_uf,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388097)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388097)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388097;
"
210061234991,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234991;

-- Informações estatísticas comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234991)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234991);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234991);
"
210061337600,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337600;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337600)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337600);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337600);
"
210059589787,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589787;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589787)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589787);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589787);
"
210058941510,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941510) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941510)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941510)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941510;
"
210059974460,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974460
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974460)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974460)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974460)
)

SELECT 
    da.nu_nota_comp1, 
    da.nu_nota_comp2, 
    da.nu_nota_comp3, 
    da.nu_nota_comp4, 
    da.nu_nota_comp5, 
    da.nu_nota_redacao,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059982330,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982330;

-- Análise comparativa com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982330)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982330);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982330);
"
210060440985,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060440985
),
alunos_estaduais AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.nu_inscricao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    ad.nu_nota_redacao,
    ee.media_nota_redacao,
    ee.media_comp1,
    ee.media_comp2,
    ee.media_comp3,
    ee.media_comp4,
    ee.media_comp5,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    aluno_dados ad,
    alunos_estaduais ee,
    alunos_renda er;
"
210058573827,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573827;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao, 
    AVG(nu_nota_comp1) AS media_comp1, 
    AVG(nu_nota_comp2) AS media_comp2, 
    AVG(nu_nota_comp3) AS media_comp3, 
    AVG(nu_nota_comp4) AS media_comp4, 
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573827)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573827);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573827);
"
210059246983,"
SELECT 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246983;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246983)
)

SELECT 
    * 
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246983)
)

SELECT 
    * 
FROM 
    renda_comparacao;
"
210061234992,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234992
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_estado,
    m.media_municipio,
    r.media_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210061337602,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337602;

-- Comparação de desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337602)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337602);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337602);
"
210059589788,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589788;

-- Estatísticas de desempenho comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589788)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589788);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589788);
"
210058941511,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941511;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941511)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941511)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    renda_comparacao;
"
210059974461,"
SELECT
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974461) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974461)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974461)) AS media_redacao_faixa_renda
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059974461;
"
210059982331,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982331;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982331)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982331);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982331);
"
210060440986,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440986;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440986)
)

SELECT 
    e.*,
    ec.media_nota_redacao,
    ec.media_comp1,
    ec.media_comp2,
    ec.media_comp3,
    ec.media_comp4,
    ec.media_comp5
FROM 
    db.enem.base_enem e
CROSS JOIN 
    estado_comparativo ec
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440986);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440986)
)

SELECT 
    r.*,
    rc.media_nota_redacao,
    rc.media_comp1,
    rc.media_comp2,
    rc.media_comp3,
    rc.media_comp4,
    rc.media_comp5
FROM 
    db.enem.base_enem r
CROSS JOIN 
    renda_comparativa rc
WHERE 
    nu_inscricao <> 210060440986;
"
210058573828,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573828;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573828)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573828);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573828);
"
210061337603,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337603;

-- Estatísticas dos alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337603)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337603);

-- Análise do desempenho dos alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337603);
"
210059589789,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589789)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589789)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589789)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589789;
"
210059982332,"
SELECT 
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS total_alunos_uf,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS media_nota_redacao_uf,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS total_alunos_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS media_nota_redacao_municipio,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982332)) AS media_nota_redacao_renda
FROM db.enem.base_enem
WHERE nu_inscricao = 210059982332
GROUP BY nu_inscricao, tp_status_redacao, nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao;
"
210060373837,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373837;

-- Estatísticas de desempenho comparando com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373837)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373837);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373837);
"
210059246985,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246985;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246985)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246985);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246985);
"
210061234995,"
SELECT
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234995)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234995)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234995)) AS media_nota_redacao_renda
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210061234995;
"
210061337605,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337605
),
estudantes_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estudantes_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estudantes_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_info a,
    estudantes_estado e,
    estudantes_municipio m,
    estudantes_renda r;
"
210059589790,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        tp_status_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589790
),
estadual_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipal_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
faixa_renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    ad.*,
    ec.media_nota_redacao,
    ec.media_comp1,
    ec.media_comp2,
    ec.media_comp3,
    ec.media_comp4,
    ec.media_comp5,
    mc.media_nota_redacao_municipio,
    mc.media_comp1_municipio,
    mc.media_comp2_municipio,
    mc.media_comp3_municipio,
    mc.media_comp4_municipio,
    mc.media_comp5_municipio,
    fr.media_nota_redacao_renda,
    fr.media_comp1_renda,
    fr.media_comp2_renda,
    fr.media_comp3_renda,
    fr.media_comp4_renda,
    fr.media_comp5_renda
FROM 
    aluno_dados ad,
    estadual_comparacao ec,
    municipal_comparacao mc,
    faixa_renda_comparacao fr;
"
210058941515,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941515;

WITH estado_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941515)
)

SELECT 
    estado_stats.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_redacao,
    (SELECT nu_nota_comp1 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp1,
    (SELECT nu_nota_comp2 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp2,
    (SELECT nu_nota_comp3 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp3,
    (SELECT nu_nota_comp4 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp4,
    (SELECT nu_nota_comp5 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp5
FROM 
    estado_stats;

WITH renda_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515)
)

SELECT 
    renda_stats.*,
    (SELECT nu_nota_redacao FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_redacao_renda,
    (SELECT nu_nota_comp1 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp1_renda,
    (SELECT nu_nota_comp2 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp2_renda,
    (SELECT nu_nota_comp3 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp3_renda,
    (SELECT nu_nota_comp4 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp4_renda,
    (SELECT nu_nota_comp5 FROM db.enem.base_enem WHERE nu_inscricao = 210058941515) AS minha_nota_comp5_renda
FROM 
    renda_stats;
"
210059974463,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974463)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974463)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974463)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974463;
"
210059982333,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982333;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982333)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982333);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982333);
"
210060440988,"
WITH aluno_dados AS (
    SELECT
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM
        db.enem.base_enem
    WHERE
        nu_inscricao = 210060440988
),
estatisticas_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT
    a.*,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    e.total_alunos AS total_alunos_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    m.total_alunos AS total_alunos_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda,
    r.total_alunos AS total_alunos_renda
FROM
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210058573830,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573830
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_dados a
CROSS JOIN 
    comparativo_estado e
CROSS JOIN 
    comparativo_municipio m
CROSS JOIN 
    comparativo_renda r;
"
210059246986,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246986
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.estado_media_nota_redacao,
    e.estado_media_comp1,
    e.estado_media_comp2,
    e.estado_media_comp3,
    e.estado_media_comp4,
    e.estado_media_comp5,
    m.municipio_media_nota_redacao,
    m.municipio_media_comp1,
    m.municipio_media_comp2,
    m.municipio_media_comp3,
    m.municipio_media_comp4,
    m.municipio_media_comp5,
    r.renda_media_nota_redacao,
    r.renda_media_comp1,
    r.renda_media_comp2,
    r.renda_media_comp3,
    r.renda_media_comp4,
    r.renda_media_comp5
FROM 
    aluno_dados a,
    (SELECT * FROM estatisticas_estado) e,
    (SELECT * FROM estatisticas_municipio) m,
    (SELECT * FROM estatisticas_renda) r;
"
210061337607,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337607
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    es.media_redacao_estado,
    es.media_comp1_estado,
    es.media_comp2_estado,
    es.media_comp3_estado,
    es.media_comp4_estado,
    es.media_comp5_estado,
    em.media_redacao_municipio,
    em.media_comp1_municipio,
    em.media_comp2_municipio,
    em.media_comp3_municipio,
    em.media_comp4_municipio,
    em.media_comp5_municipio,
    er.media_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    desempenho_aluno da,
    estatisticas_estado es,
    estatisticas_municipio em,
    estatisticas_renda er;
"
210059982334,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982334;

-- Estatísticas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982334)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982334);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982334);
"
210060440989,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        no_municipio_esc,
        sg_uf_esc,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060440989
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_mun,
        AVG(nu_nota_comp1) AS media_comp1_mun,
        AVG(nu_nota_comp2) AS media_comp2_mun,
        AVG(nu_nota_comp3) AS media_comp3_mun,
        AVG(nu_nota_comp4) AS media_comp4_mun,
        AVG(nu_nota_comp5) AS media_comp5_mun
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210058573831,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573831
),
estadisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estadisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estadisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    ad.nu_inscricao,
    ad.nu_nota_redacao,
    ad.nu_nota_comp1,
    ad.nu_nota_comp2,
    ad.nu_nota_comp3,
    ad.nu_nota_comp4,
    ad.nu_nota_comp5,
    es.media_redacao_estado,
    es.media_comp1_estado,
    es.media_comp2_estado,
    es.media_comp3_estado,
    es.media_comp4_estado,
    es.media_comp5_estado,
    em.media_redacao_municipio,
    em.media_comp1_municipio,
    em.media_comp2_municipio,
    em.media_comp3_municipio,
    em.media_comp4_municipio,
    em.media_comp5_municipio,
    er.media_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    aluno_dados ad
JOIN 
    estadisticas_estado es ON true
JOIN 
    estadisticas_municipio em ON true
JOIN 
    estadisticas_renda er ON true;
"
210059246987,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246987
), 
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
), 
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
), 
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.avg_comp1 AS avg_estado_comp1,
    e.avg_comp2 AS avg_estado_comp2,
    e.avg_comp3 AS avg_estado_comp3,
    e.avg_comp4 AS avg_estado_comp4,
    e.avg_comp5 AS avg_estado_comp5,
    e.avg_redacao AS avg_estado_redacao,
    m.avg_comp1 AS avg_municipio_comp1,
    m.avg_comp2 AS avg_municipio_comp2,
    m.avg_comp3 AS avg_municipio_comp3,
    m.avg_comp4 AS avg_municipio_comp4,
    m.avg_comp5 AS avg_municipio_comp5,
    m.avg_redacao AS avg_municipio_redacao,
    r.avg_comp1 AS avg_renda_comp1,
    r.avg_comp2 AS avg_renda_comp2,
    r.avg_comp3 AS avg_renda_comp3,
    r.avg_comp4 AS avg_renda_comp4,
    r.avg_comp5 AS avg_renda_comp5,
    r.avg_redacao AS avg_renda_redacao
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210061234997,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234997;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234997)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234997);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234997);
"
210061337609,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337609
),
estadisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estadisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059974465,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974465;

-- Estatísticas de desempenho no estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974465)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974465);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974465);
"
210060440990,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440990;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440990)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440990);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440990);
"
210060373840,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373840;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373840)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373840)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373840)
);

SELECT 
    'Estado' AS origem,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado
UNION ALL
SELECT 
    'Município' AS origem,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio
UNION ALL
SELECT 
    'Faixa de Renda' AS origem,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
"
210058573822,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573822;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573822)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573822)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573822)
)

SELECT 
    'Estado' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Município' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Renda' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
"
210059246978,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246978
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a
CROSS JOIN 
    comparativo_estado e
CROSS JOIN 
    comparativo_municipio m
CROSS JOIN 
    comparativo_renda r;
"
210061234987,"
WITH aluno_dados AS (
    SELECT 
        no_municipio_esc,
        sg_uf_esc,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061234987
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.no_municipio_esc,
    a.sg_uf_esc,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210060440981,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440981;

-- Estatísticas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440981)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440981);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440981);
"
210060373831,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373831)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373831)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373831)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210060373831;
"
210058573823,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058573823)) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058573823)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058573823 
    OR sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058573823)
    OR (Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058573823))
GROUP BY 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao;
"
210061234988,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234988;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234988)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234988);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234988);
"
210061337594,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337594
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210060440983,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440983;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440983)
);

WITH renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440983)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativo) AS comparativo_renda;
"
210060373833,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373833)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373833)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373833)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373833;
"
210058573825,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573825;

-- Estatísticas comparativas no estado
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573825);

-- Análise por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573825);
"
210061337598,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210061337598)) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210061337598)) AS media_nota_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210061337598
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc, Q006;
"
210058941508,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941508)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941508) AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941508)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941508)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941508;
"
210060373834,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373834)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373834 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373834) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373834))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210059589784,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS media_nota_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS media_nota_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589784)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589784
GROUP BY 
    nu_inscricao;
"
210058941505,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941505;

-- Estatísticas comparando desempenho com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941505)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941505);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941505);
"
210059974457,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059974457
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM aluno_dados a, estatisticas_estado e, estatisticas_municipio m, estatisticas_renda r;
"
210059982327,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982327)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982327)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982327)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982327;
"
210060440982,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440982)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440982)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440982)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210060440982;
"
210060373832,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373832)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373832)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373832)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373832;
"
210058573824,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573824;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573824) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573824);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573824);
"
210061234989,"
SELECT 
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061234989
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234989) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061234989))
    OR (Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061234989))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc, Q006;
"
210059246980,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059246980;

-- Desempenho médio em comparação com alunos do mesmo estado e município
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246980)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246980);

-- Desempenho em comparação com alunos da mesma faixa de renda
SELECT
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246980);
"
210061337596,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337596
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1_mun,
        AVG(nu_nota_comp2) AS avg_comp2_mun,
        AVG(nu_nota_comp3) AS avg_comp3_mun,
        AVG(nu_nota_comp4) AS avg_comp4_mun,
        AVG(nu_nota_comp5) AS avg_comp5_mun,
        AVG(nu_nota_redacao) AS avg_redacao_mun
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1_renda,
        AVG(nu_nota_comp2) AS avg_comp2_renda,
        AVG(nu_nota_comp3) AS avg_comp3_renda,
        AVG(nu_nota_comp4) AS avg_comp4_renda,
        AVG(nu_nota_comp5) AS avg_comp5_renda,
        AVG(nu_nota_redacao) AS avg_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.avg_comp1,
    de.avg_comp2,
    de.avg_comp3,
    de.avg_comp4,
    de.avg_comp5,
    de.avg_redacao,
    dm.avg_comp1_mun,
    dm.avg_comp2_mun,
    dm.avg_comp3_mun,
    dm.avg_comp4_mun,
    dm.avg_comp5_mun,
    dm.avg_redacao_mun,
    dr.avg_comp1_renda,
    dr.avg_comp2_renda,
    dr.avg_comp3_renda,
    dr.avg_comp4_renda,
    dr.avg_comp5_renda,
    dr.avg_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059589785,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589785;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589785)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589785);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589785);
"
210059974458,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974458;

-- Comparando desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974458) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974458);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974458);
"
210059982328,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) AS total_alunos_estado,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982328)) AS total_alunos_mesma_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982328)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982328
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982328)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982328))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210060801613,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801613)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801613)) AS media_nota_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801613)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801613;
"
210061103959,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103959)
       AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103959)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103959)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103959;
"
210059388105,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059388105
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210058061552,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061552;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061552)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d
CROSS JOIN 
    desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061552)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d
CROSS JOIN 
    desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
"
210059085151,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085151;

-- Estatísticas de desempenho em comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085151)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085151);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085151);
"
210061103960,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103960;
"
210061244803,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061244803
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210061337610,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337610;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao, 
    AVG(nu_nota_comp1) AS media_nota_comp1, 
    AVG(nu_nota_comp2) AS media_nota_comp2, 
    AVG(nu_nota_comp3) AS media_nota_comp3, 
    AVG(nu_nota_comp4) AS media_nota_comp4, 
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337610)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337610);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337610);
"
210058941522,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941522;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941522)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941522)
)

SELECT 
    *
FROM 
    renda_comparativa;
"
210059589793,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589793;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589793)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589793);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589793);
"
210059974466,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    AVG(nu_nota_redacao) AS media_redacao_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974466)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974466
    OR sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974466)
    OR no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974466)
GROUP BY 
    nu_inscricao;
"
210059982336,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982336
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    ce.media_redacao,
    ce.media_comp1,
    ce.media_comp2,
    ce.media_comp3,
    ce.media_comp4,
    ce.media_comp5,
    cm.media_redacao_municipio,
    cm.media_comp1_municipio,
    cm.media_comp2_municipio,
    cm.media_comp3_municipio,
    cm.media_comp4_municipio,
    cm.media_comp5_municipio,
    cr.media_redacao_renda,
    cr.media_comp1_renda,
    cr.media_comp2_renda,
    cr.media_comp3_renda,
    cr.media_comp4_renda,
    cr.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado ce,
    comparativo_municipio cm,
    comparativo_renda cr;
"
210060440991,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440991;

-- Estatísticas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440991)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440991);

-- Análise com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440991);
"
210060373841,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060373841;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373841)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060373841);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060373841);
"
210059246989,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059246989
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5, 
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5, 
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5, 
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1, 
    a.nu_nota_comp2, 
    a.nu_nota_comp3, 
    a.nu_nota_comp4, 
    a.nu_nota_comp5, 
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_cidade c,
    estatisticas_renda r;
"
210058573833,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573833;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573833)
)

SELECT 
    * 
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573833)
)

SELECT 
    * 
FROM 
    renda_comparativa;
"
210061244804,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = t.sg_uf_esc) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = t.no_municipio_esc) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244804)) AS media_renda_redacao
FROM 
    db.enem.base_enem t
WHERE 
    nu_inscricao = 210061244804;
"
210061337613,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337613;

-- Análise de desempenho em comparação com outros alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337613)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337613);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337613);
"
210058387341,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387341;

-- Consulta para comparar o desempenho com outros alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387341)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387341);

-- Consulta para analisar o desempenho em relação a alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387341);
"
210059085145,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085145
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_info a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210060801609,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801609;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801609)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_nota_estado,
    (SELECT media_comp1 FROM estado_comparativo) AS media_comp1_estado,
    (SELECT media_comp2 FROM estado_comparativo) AS media_comp2_estado,
    (SELECT media_comp3 FROM estado_comparativo) AS media_comp3_estado,
    (SELECT media_comp4 FROM estado_comparativo) AS media_comp4_estado,
    (SELECT media_comp5 FROM estado_comparativo) AS media_comp5_estado
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801609)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801609);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801609)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparativa) AS media_nota_renda,
    (SELECT media_comp1_renda FROM renda_comparativa) AS media_comp1_renda,
    (SELECT media_comp2_renda FROM renda_comparativa) AS media_comp2_renda,
    (SELECT media_comp3_renda FROM renda_comparativa) AS media_comp3_renda,
    (SELECT media_comp4_renda FROM renda_comparativa) AS media_comp4_renda,
    (SELECT media_comp5_renda FROM renda_comparativa) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801609);
"
210061103955,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103955;

WITH performance AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
)

SELECT 
    p.*,
    COUNT(*) AS total_alunos
FROM 
    performance p
JOIN 
    db.enem.base_enem e ON e.Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
WHERE 
    e.sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955)
    AND e.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103955);
"
210060214096,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214096;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214096)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214096);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214096);
"
210059388101,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388101;

SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388101)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388101);

SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388101);
"
210058061548,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061548;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061548)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061548);

-- Análise por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061548);
"
210058387342,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387342;

WITH comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387342)
),

comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387342)
),

comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387342)
)

SELECT 
    (SELECT * FROM comparacao_estado) AS comparacao_estado,
    (SELECT * FROM comparacao_municipio) AS comparacao_municipio,
    (SELECT * FROM comparacao_renda) AS comparacao_renda;
"
210059085146,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085146
),
estadual_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipal_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estadual_comparacao e,
    municipal_comparacao m,
    renda_comparacao r;
"
210060801610,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801610;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801610)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801610);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801610);
"
210059527746,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527746;

-- Comparação com alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527746)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527746);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527746);
"
210060214097,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214097;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214097)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214097)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214097)
)

SELECT 
    'Estado' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Município' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Renda' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
"
210058061549,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061549;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061549)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061549);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061549);
"
210059980958,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059980958
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210058387343,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387343)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387343)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387343)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387343;
"
210059085147,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085147
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    d.nota_redacao,
    d.nota_comp1,
    d.nota_comp2,
    d.nota_comp3,
    d.nota_comp4,
    d.nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    desempenho_aluno d,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210060801611,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801611;

-- Estatísticas comparando o desempenho com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801611)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801611);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801611);
"
210059527747,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527747;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527747)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527747);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527747);
"
210061103957,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103957;

WITH performance_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao,
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
)

SELECT 
    p.*, 
    s.*
FROM 
    (SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)) AS p,
    performance_stats AS s;

WITH renda_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao_renda,
        AVG(nu_nota_comp1) AS avg_comp1_renda,
        AVG(nu_nota_comp2) AS avg_comp2_renda,
        AVG(nu_nota_comp3) AS avg_comp3_renda,
        AVG(nu_nota_comp4) AS avg_comp4_renda,
        AVG(nu_nota_comp5) AS avg_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103957)
)

SELECT 
    r.*
FROM 
    renda_stats AS r;
"
210058061550,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061550;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061550)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061550);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061550);
"
210059855133,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855133;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855133)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855133)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855133)
)

SELECT 
    e.media_redacao AS media_redacao_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_redacao AS media_redacao_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_redacao AS media_redacao_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210058387344,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387344
), estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
), estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
), estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.estado_media_nota_redacao,
    e.estado_media_comp1,
    e.estado_media_comp2,
    e.estado_media_comp3,
    e.estado_media_comp4,
    e.estado_media_comp5,
    e.total_alunos AS total_alunos_estado,
    m.municipio_media_nota_redacao,
    m.municipio_media_comp1,
    m.municipio_media_comp2,
    m.municipio_media_comp3,
    m.municipio_media_comp4,
    m.municipio_media_comp5,
    m.total_alunos AS total_alunos_municipio,
    r.renda_media_nota_redacao,
    r.renda_media_comp1,
    r.renda_media_comp2,
    r.renda_media_comp3,
    r.renda_media_comp4,
    r.renda_media_comp5,
    r.total_alunos AS total_alunos_renda
FROM 
    aluno_dados a,
    (SELECT * FROM estatisticas_estado) e,
    (SELECT * FROM estatisticas_municipio) m,
    (SELECT * FROM estatisticas_renda) r;
"
210060801612,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060801612
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.avg_comp1 AS avg_comp1_estado,
    de.avg_comp2 AS avg_comp2_estado,
    de.avg_comp3 AS avg_comp3_estado,
    de.avg_comp4 AS avg_comp4_estado,
    de.avg_comp5 AS avg_comp5_estado,
    de.avg_redacao AS avg_redacao_estado,
    dm.avg_comp1 AS avg_comp1_municipio,
    dm.avg_comp2 AS avg_comp2_municipio,
    dm.avg_comp3 AS avg_comp3_municipio,
    dm.avg_comp4 AS avg_comp4_municipio,
    dm.avg_comp5 AS avg_comp5_municipio,
    dm.avg_redacao AS avg_redacao_municipio,
    dr.avg_comp1 AS avg_comp1_renda,
    dr.avg_comp2 AS avg_comp2_renda,
    dr.avg_comp3 AS avg_comp3_renda,
    dr.avg_comp4 AS avg_comp4_renda,
    dr.avg_comp5 AS avg_comp5_renda,
    dr.avg_redacao AS avg_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210060214099,"
SELECT 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214099)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214099 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214099) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214099))
GROUP BY 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc;
"
210059388104,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388104;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388104)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388104);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388104);
"
210059980960,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980960;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980960)
)

SELECT 
    e.*,
    estat.media_nota_redacao,
    estat.media_comp1,
    estat.media_comp2,
    estat.media_comp3,
    estat.media_comp4,
    estat.media_comp5
FROM 
    db.enem.base_enem e
JOIN 
    estatisticas_estado estat ON e.sg_uf_esc = estat.sg_uf_esc
WHERE 
    e.nu_inscricao <> 210059980960;

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980960)
)

SELECT 
    e.*,
    estat_renda.media_nota_redacao_renda,
    estat_renda.media_comp1_renda,
    estat_renda.media_comp2_renda,
    estat_renda.media_comp3_renda,
    estat_renda.media_comp4_renda,
    estat_renda.media_comp5_renda
FROM 
    db.enem.base_enem e
JOIN 
    estatisticas_renda estat_renda ON e.Q006 = estat_renda.Q006
WHERE 
    e.nu_inscricao <> 210059980960;
"
210059855134,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855134;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855134)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855134)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855134)
)

SELECT 
    e.*, 
    m.*, 
    r.*
FROM 
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059085150,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085150
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_estado,
    m.media_municipio,
    r.media_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210059974467,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_redacao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_nota_redacao_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210059974467;
"
210059982337,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982337
),
estados_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info) 
    GROUP BY 
        sg_uf_esc
),
renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    ai.*,
    ec.*,
    rc.*
FROM 
    aluno_info ai
CROSS JOIN 
    estados_comparacao ec
CROSS JOIN 
    renda_comparacao rc;
"
210060373842,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = '210060373842') 
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = '210060373842')) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = '210060373842')) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = '210060373842';
"
210061244805,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244805;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244805)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244805);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244805);
"
210061337614,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337614;

-- Comparação de desempenho com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337614)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337614);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337614);
"
210059589795,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589795
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    de.media_redacao,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dm.media_redacao_municipio,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda,
    dr.media_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059974468,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974468
),
desempenho_estado AS (
    SELECT 
        sg_uf_esc,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974468)
    GROUP BY 
        sg_uf_esc
),
desempenho_cidade AS (
    SELECT 
        no_municipio_esc,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974468)
    GROUP BY 
        no_municipio_esc
),
desempenho_renda AS (
    SELECT 
        Q006,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974468)
    GROUP BY 
        Q006
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
"
210059982338,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059982338;

SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982338)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982338);

SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982338);
"
210060440993,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440993;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440993)
)

SELECT 
    a.nu_nota_redacao,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem a,
    estado_comparacao e
WHERE 
    a.sg_uf_esc = e.sg_uf_esc;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440993)
)

SELECT 
    a.nu_nota_redacao,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem a,
    renda_comparacao r
WHERE 
    a.Q006 = r.Q006;
"
210059388099,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388099)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388099)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388099)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388099;
"
210059980955,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(CASE WHEN nu_nota_redacao >= 0 THEN 1 END) AS total_alunos_estado,
    AVG(nu_nota_redacao) AS media_nota_estado,
    COUNT(CASE WHEN Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059980955) THEN 1 END) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059980955)) AS media_nota_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059980955 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059980955) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059980955))
    OR (Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059980955))
GROUP BY 
    nu_inscricao, 
    no_municipio_esc, 
    sg_uf_esc;
"
210058061546,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061546;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061546)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061546)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061546)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_renda;
"
210059855129,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855129)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855129)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855129)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855129;
"
210058387340,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387340;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387340)
)

SELECT 
    *,
    estado_comparacao.*
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387340)
)

SELECT 
    *,
    renda_comparacao.*
FROM 
    renda_comparacao;
"
210059085144,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085144)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085144)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085144)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085144;
"
210060801608,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801608;

-- Estudo comparativo com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801608)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801608);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801608);
"
210059527744,"
SELECT
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059527744;

WITH estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527744)
),
municipio AS (
    SELECT
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527744)
),
faixa_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_faixa_renda,
        AVG(nu_nota_comp1) AS media_comp1_faixa_renda,
        AVG(nu_nota_comp2) AS media_comp2_faixa_renda,
        AVG(nu_nota_comp3) AS media_comp3_faixa_renda,
        AVG(nu_nota_comp4) AS media_comp4_faixa_renda,
        AVG(nu_nota_comp5) AS media_comp5_faixa_renda
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527744)
)

SELECT
    e.*,
    m.*,
    f.*
FROM
    estado e,
    municipio m,
    faixa_renda f;
"
210061103954,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103954)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103954)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103954)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103954;
"
210060214095,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214095;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214095)
)

SELECT 
    *
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214095)
)

SELECT 
    *
FROM 
    renda_comparacao;
"
210059388100,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388100;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388100)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388100)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388100)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
"
210059980956,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao,
    COUNT(*) AS total_alunos_estado,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980956)) AS total_alunos_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980956 OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980956) AND 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980956))
GROUP BY 
    no_municipio_esc, sg_uf_esc;
"
210058061547,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061547
),
desempenho_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_cidade AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.*,
    e.media_nota_redacao AS media_nota_redacao_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    c.media_nota_redacao AS media_nota_redacao_cidade,
    c.media_comp1 AS media_comp1_cidade,
    c.media_comp2 AS media_comp2_cidade,
    c.media_comp3 AS media_comp3_cidade,
    c.media_comp4 AS media_comp4_cidade,
    c.media_comp5 AS media_comp5_cidade,
    r.media_nota_redacao AS media_nota_redacao_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_desempenho a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
"
210059855130,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855130
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1_municipio AS media_municipio_comp1,
    dm.media_comp2_municipio AS media_municipio_comp2,
    dm.media_comp3_municipio AS media_municipio_comp3,
    dm.media_comp4_municipio AS media_municipio_comp4,
    dm.media_comp5_municipio AS media_municipio_comp5,
    dm.media_redacao_municipio AS media_municipio_redacao,
    dr.media_comp1_renda AS media_renda_comp1,
    dr.media_comp2_renda AS media_renda_comp2,
    dr.media_comp3_renda AS media_renda_comp3,
    dr.media_comp4_renda AS media_renda_comp4,
    dr.media_comp5_renda AS media_renda_comp5,
    dr.media_redacao_renda AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210058573835,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573835
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_renda r;
"
210059527742,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059527742;

WITH performance_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527742)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059527742)
),
renda_stats AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059527742)
)

SELECT 
    ps.*,
    rs.*
FROM 
    performance_stats ps,
    renda_stats rs;
"
210061103952,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103952)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103952)) AS media_nota_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103952)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103952;
"
210060214093,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214093;

-- Estatísticas comparativas por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214093)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214093);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214093);
"
210059388098,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388098;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388098)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388098);

-- Análise com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388098);
"
210059980954,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059980954
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
"
210058061545,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061545
),
estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estado_comparativo e,
    municipio_comparativo m,
    renda_comparativo r;
"
210058387339,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS total_alunos_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS media_redacao_municipio,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058387339)) AS media_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058387339
GROUP BY 
    nu_inscricao, nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao;
"
210059085143,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_redacao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210059085143;
"
210061103953,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103953;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103953)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103953);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103953);
"
210058061557,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058061557
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059855140,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855140
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
"
210058387351,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387351
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210060801619,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801619;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801619)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801619);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801619);
"
210059085156,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085156
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
"
210059540788,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540788
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
"
210060214106,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214106)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214106)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214106)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214106;
"
210059980967,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006 AS renda_mensal
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980967;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980967)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_nota_estado,
    (SELECT media_comp1 FROM estado_comparativo) AS media_comp1_estado,
    (SELECT media_comp2 FROM estado_comparativo) AS media_comp2_estado,
    (SELECT media_comp3 FROM estado_comparativo) AS media_comp3_estado,
    (SELECT media_comp4 FROM estado_comparativo) AS media_comp4_estado,
    (SELECT media_comp5 FROM estado_comparativo) AS media_comp5_estado
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980967)
AND 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980967);
"
210058073302,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073302)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073302)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058073302)) AS media_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058073302;
"
210059855141,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855141
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210058387352,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387352)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387352)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387352)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387352;
"
210059085157,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085157
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210060801620,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801620;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801620)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801620)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801620)
);

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
"
210059540789,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540789;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540789)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540789)
)

SELECT 
    *
FROM 
    renda_comparativa;
"
210061103966,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103966;
"
210060214107,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214107;

-- Informações estatísticas sobre o desempenho no mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214107)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214107);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214107);
"
210059388112,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388112;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388112)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d, desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388112)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d, desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
"
210058073303,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) FILTER (WHERE nu_nota_redacao IS NOT NULL) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058073303)) AS media_estado,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058073303)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058073303)) AS media_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058073303 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058073303))
    OR (no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058073303))
    OR (Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058073303))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210059855142,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855142;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855142)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855142);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855142);
"
210059085158,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085158
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059540790,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540790
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
"
210061103967,"
SELECT 
    e.nu_inscricao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210061103967;
"
210059388113,"
WITH aluno_dados AS (
    SELECT nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao, sg_uf_esc, no_municipio_esc, Q006
    FROM db.enem.base_enem
    WHERE nu_inscricao = 210059388113
),
estatisticas_estado AS (
    SELECT AVG(nu_nota_redacao) AS media_nota_redacao, 
           AVG(nu_nota_comp1) AS media_comp1,
           AVG(nu_nota_comp2) AS media_comp2,
           AVG(nu_nota_comp3) AS media_comp3,
           AVG(nu_nota_comp4) AS media_comp4,
           AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT AVG(nu_nota_redacao) AS media_nota_redacao_mun, 
           AVG(nu_nota_comp1) AS media_comp1_mun,
           AVG(nu_nota_comp2) AS media_comp2_mun,
           AVG(nu_nota_comp3) AS media_comp3_mun,
           AVG(nu_nota_comp4) AS media_comp4_mun,
           AVG(nu_nota_comp5) AS media_comp5_mun
    FROM db.enem.base_enem
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT AVG(nu_nota_redacao) AS media_nota_redacao_renda,
           AVG(nu_nota_comp1) AS media_comp1_renda,
           AVG(nu_nota_comp2) AS media_comp2_renda,
           AVG(nu_nota_comp3) AS media_comp3_renda,
           AVG(nu_nota_comp4) AS media_comp4_renda,
           AVG(nu_nota_comp5) AS media_comp5_renda
    FROM db.enem.base_enem
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1, a.nu_nota_comp2, a.nu_nota_comp3, a.nu_nota_comp4, a.nu_nota_comp5, a.nu_nota_redacao,
    e.media_nota_redacao, e.media_comp1, e.media_comp2, e.media_comp3, e.media_comp4, e.media_comp5,
    m.media_nota_redacao_mun, m.media_comp1_mun, m.media_comp2_mun, m.media_comp3_mun, m.media_comp4_mun, m.media_comp5_mun,
    r.media_nota_redacao_renda, r.media_comp1_renda, r.media_comp2_renda, r.media_comp3_renda, r.media_comp4_renda, r.media_comp5_renda
FROM aluno_dados a
CROSS JOIN estatisticas_estado e
CROSS JOIN estatisticas_municipio m
CROSS JOIN estatisticas_renda r;
"
210059980969,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980969;

-- Consulta para comparação de desempenho com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980969)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980969);

-- Consulta para análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980969);
"
210058073304,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210058073304
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_redacao AS media_redacao_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_redacao AS media_redacao_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_redacao AS media_redacao_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM aluno_dados a
JOIN estatisticas_estado e ON true
JOIN estatisticas_municipio m ON true
JOIN estatisticas_renda r ON true;
"
210059855143,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855143;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855143)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855143);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855143);
"
210058387354,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387354;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387354)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387354);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387354);
"
210060801621,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801621;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801621)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    estado_comparacao e;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801621)
)

SELECT 
    r.media_nota_redacao,
    r.media_comp1,
    r.media_comp2,
    r.media_comp3,
    r.media_comp4,
    r.media_comp5
FROM 
    renda_comparacao r;
"
210059540791,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540791
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    aluno_dados.*,
    estatisticas_estado.*,
    estatisticas_municipio.*,
    estatisticas_renda.*
FROM 
    aluno_dados,
    estatisticas_estado,
    estatisticas_municipio,
    estatisticas_renda;
"
210060214109,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214109;

-- Análise comparativa com alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214109)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214109);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214109);
"
210058073305,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058073305
),
dados_estatisticos AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados) AND
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
dados_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.total_alunos,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.total_alunos_renda
FROM 
    aluno_dados a,
    dados_estatisticos e,
    dados_renda r;
"
210059868169,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059868169;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059868169)
);

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059868169)
);

SELECT 
    'Desempenho no Estado' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_estado
UNION ALL
SELECT 
    'Desempenho pela Renda' AS tipo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    desempenho_renda;
"
210058387355,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387355;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387355)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387355);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387355);
"
210060811451,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060811451;

-- Estatísticas de desempenho em relação a alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811451)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811451);

-- Análise de desempenho em relação a alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060811451);
"
210059540792,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540792
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado,
        AVG(nu_nota_redacao) AS media_redacao_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
"
210061337617,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337617;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337617)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337617);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337617);
"
210059589796,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589796;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589796)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589796);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589796);
"
210059974469,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974469;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974469)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974469);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974469);
"
210060440994,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440994;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440994)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440994);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440994);
"
210060376426,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376426;

WITH EstatisticasEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376426)
)

SELECT 
    e.*,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5
FROM 
    db.enem.base_enem e,
    EstatisticasEstado es
WHERE 
    e.sg_uf_esc = es.sg_uf_esc
    AND e.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376426);

WITH EstatisticasRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376426)
)

SELECT 
    e.*,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    db.enem.base_enem e,
    EstatisticasRenda er
WHERE 
    e.Q006 = er.Q006;
"
210058573836,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573836;

-- Análise comparativa com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573836)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573836);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573836);
"
210059246991,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246991;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246991)
)

SELECT 
    *,
    estado_comparacao.*
FROM 
    db.enem.base_enem
JOIN 
    estado_comparacao ON TRUE
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246991);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246991)
)

SELECT 
    *,
    renda_comparacao.*
FROM 
    db.enem.base_enem
JOIN 
    renda_comparacao ON TRUE
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246991);
"
210059388106,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388106)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388106)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao)
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388106)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388106;
"
210059980962,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059980962
),
estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estado_comparativo e,
    municipio_comparativo m,
    renda_comparativo r;
"
210058061553,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061553)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061553)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061553)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061553;
"
210059855136,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855136;

-- Estatísticas de desempenho dos alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855136)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855136);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855136);
"
210058387347,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058387347
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    est_estado.media_nota_redacao AS media_nota_redacao_estado,
    est_estado.media_comp1 AS media_comp1_estado,
    est_estado.media_comp2 AS media_comp2_estado,
    est_estado.media_comp3 AS media_comp3_estado,
    est_estado.media_comp4 AS media_comp4_estado,
    est_estado.media_comp5 AS media_comp5_estado,
    est_estado.total_alunos AS total_alunos_estado,
    est_cidade.media_nota_redacao AS media_nota_redacao_cidade,
    est_cidade.media_comp1 AS media_comp1_cidade,
    est_cidade.media_comp2 AS media_comp2_cidade,
    est_cidade.media_comp3 AS media_comp3_cidade,
    est_cidade.media_comp4 AS media_comp4_cidade,
    est_cidade.media_comp5 AS media_comp5_cidade,
    est_cidade.total_alunos AS total_alunos_cidade,
    est_renda.media_nota_redacao AS media_nota_redacao_renda,
    est_renda.media_comp1 AS media_comp1_renda,
    est_renda.media_comp2 AS media_comp2_renda,
    est_renda.media_comp3 AS media_comp3_renda,
    est_renda.media_comp4 AS media_comp4_renda,
    est_renda.media_comp5 AS media_comp5_renda,
    est_renda.total_alunos AS total_alunos_renda
FROM 
    aluno_dados a,
    estatisticas_estado est_estado,
    estatisticas_cidade est_cidade,
    estatisticas_renda est_renda;
"
210059085152,"
SELECT 
    nu_inscricao,
    nu_nota_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085152;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085152)
),

municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085152)
),

faixa_renda_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085152)
)

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM municipio_comparativo) AS comparativo_municipio,
    (SELECT * FROM faixa_renda_comparativo) AS comparativo_faixa_renda;
"
210060801615,"
SELECT
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801615) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801615)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801615)) AS media_redacao_renda
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210060801615;
"
210060214102,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214102;
"
210059388107,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388107;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao, 
        AVG(nu_nota_comp1) AS media_comp1, 
        AVG(nu_nota_comp2) AS media_comp2, 
        AVG(nu_nota_comp3) AS media_comp3, 
        AVG(nu_nota_comp4) AS media_comp4, 
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388107)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparativo) AS media_estado_redacao,
    (SELECT media_comp1 FROM estado_comparativo) AS media_estado_comp1,
    (SELECT media_comp2 FROM estado_comparativo) AS media_estado_comp2,
    (SELECT media_comp3 FROM estado_comparativo) AS media_estado_comp3,
    (SELECT media_comp4 FROM estado_comparativo) AS media_estado_comp4,
    (SELECT media_comp5 FROM estado_comparativo) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388107);
"
210059980963,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980963;

-- Comparação com outros alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980963)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980963);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980963);
"
210058061554,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS media_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS media_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210058061554)) AS media_redacao_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210058061554
GROUP BY 
    nu_inscricao, nu_nota_comp1, nu_nota_comp2, nu_nota_comp3, nu_nota_comp4, nu_nota_comp5, nu_nota_redacao;
"
210059855137,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855137) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855137)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855137)) AS media_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855137;
"
210061103963,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103963)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103963) AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103963)) AS media_nota_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103963)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103963;
"
210059388109,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388109)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388109 OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388109) AND 
     no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388109))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210058061556,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058061556;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061556)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061556);

-- Análise comparativa com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061556);
"
210059855139,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059855139;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855139)
)

SELECT 
    *,
    (SELECT * FROM estado_comparativo) AS comparativo_estado
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059855139);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855139)
)

SELECT 
    *,
    (SELECT * FROM renda_comparativa) AS comparativo_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059855139);
"
210058387350,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387350)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387350)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387350)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058387350;
"
210059085155,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085155
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    aluno_dados.*,
    comparacao_estado.*,
    comparacao_municipio.*,
    comparacao_renda.*
FROM 
    aluno_dados,
    comparacao_estado,
    comparacao_municipio,
    comparacao_renda;
"
210060801618,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801618;

-- Estatísticas comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801618)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801618);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801618);
"
210061103964,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103964;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103964)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103964);

-- Análise de desempenho para alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103964);
"
210059388110,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059388110;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059388110)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059388110)
);

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativa) AS comparativo_renda;
"
210059980966,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980966)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980966)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980966)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980966;
"
210059085153,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085153
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059540785,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM database.schema.table
    WHERE nu_inscricao = 210059540785
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM database.schema.table
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM database.schema.table
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM database.schema.table
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM aluno_dados a, comparacao_estado e, comparacao_municipio m, comparacao_renda r;
"
210060801616,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801616;

-- Estatísticas do desempenho no mesmo estado
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801616);

-- Comparação com alunos da mesma cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
    AVG(nu_nota_comp1) AS media_comp1_cidade,
    AVG(nu_nota_comp2) AS media_comp2_cidade,
    AVG(nu_nota_comp3) AS media_comp3_cidade,
    AVG(nu_nota_comp4) AS media_comp4_cidade,
    AVG(nu_nota_comp5) AS media_comp5_cidade
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801616);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801616);
"
210060214103,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214103)) AS avg_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214103)) AS avg_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214103)) AS avg_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214103;
"
210059980964,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059980964;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980964) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980964);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980964);
"
210058061555,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061555) 
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058061555)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058061555)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058061555;
"
210059855138,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059855138
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    aluno_dados.*, 
    alunos_estado.*, 
    alunos_renda.*
FROM 
    aluno_dados, 
    alunos_estado, 
    alunos_renda;
"
210058387349,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387349;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387349)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387349)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    renda_comparacao;
"
210059085154,"
SELECT
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM database.schema.table WHERE sg_uf_esc = t.sg_uf_esc AND no_municipio_esc = t.no_municipio_esc) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM database.schema.table WHERE sg_uf_esc = t.sg_uf_esc) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM database.schema.table WHERE Q006 = (SELECT Q006 FROM database.schema.table WHERE nu_inscricao = 210059085154)) AS media_redacao_renda
FROM
    database.enem.base_enem t
WHERE
    nu_inscricao = 210059085154;
"
210060801617,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060801617;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801617)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060801617);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060801617);
"
210059540786,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540786;

-- Comparação com alunos do mesmo Estado e Município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540786)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540786);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540786);
"
210061244816,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244816;

WITH EstatisticasEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        COUNT(*) AS total_alunos,
        COUNT(CASE WHEN nu_nota_redacao >= 600 THEN 1 END) AS alunos_acima_600
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244816)
),
EstatisticasMunicipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        COUNT(*) AS total_alunos_municipio,
        COUNT(CASE WHEN nu_nota_redacao >= 600 THEN 1 END) AS alunos_acima_600_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244816)
),
EstatisticasRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        COUNT(*) AS total_alunos_renda,
        COUNT(CASE WHEN nu_nota_redacao >= 600 THEN 1 END) AS alunos_acima_600_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244816)
)

SELECT 
    e.estado,
    e.media_nota_redacao,
    e.total_alunos,
    e.alunos_acima_600,
    m.media_nota_redacao_municipio,
    m.total_alunos_municipio,
    m.alunos_acima_600_municipio,
    r.media_nota_redacao_renda,
    r.total_alunos_renda,
    r.alunos_acima_600_renda
FROM 
    EstatisticasEstado e,
    EstatisticasMunicipio m,
    EstatisticasRenda r;
"
210059589806,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589806;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589806) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589806);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589806);
"
210058954684,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954684
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.*,
    m.*,
    r.*
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210059974480,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974480;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS avg_comp1,
    AVG(nu_nota_comp2) AS avg_comp2,
    AVG(nu_nota_comp3) AS avg_comp3,
    AVG(nu_nota_comp4) AS avg_comp4,
    AVG(nu_nota_comp5) AS avg_comp5,
    AVG(nu_nota_redacao) AS avg_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974480)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974480);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS avg_comp1_renda,
    AVG(nu_nota_comp2) AS avg_comp2_renda,
    AVG(nu_nota_comp3) AS avg_comp3_renda,
    AVG(nu_nota_comp4) AS avg_comp4_renda,
    AVG(nu_nota_comp5) AS avg_comp5_renda,
    AVG(nu_nota_redacao) AS avg_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974480);
"
210059982350,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982350
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    d.nu_inscricao,
    d.nu_nota_comp1,
    d.nu_nota_comp2,
    d.nu_nota_comp3,
    d.nu_nota_comp4,
    d.nu_nota_comp5,
    d.nu_nota_redacao,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    desempenho_aluno d,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210058573845,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573845
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    m.media_nota_redacao AS media_municipio,
    r.media_nota_redacao AS media_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210061244817,"
WITH aluno_desempenho AS (
    SELECT
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM
        db.enem.base_enem
    WHERE
        nu_inscricao = 210061244817
),
desempenho_estado AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM
        db.enem.base_enem
    WHERE
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_municipio AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM
        db.enem.base_enem
    WHERE
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM
        db.enem.base_enem
    WHERE
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)
SELECT
    ad.*,
    des.media_nota_redacao,
    des.media_comp1,
    des.media_comp2,
    des.media_comp3,
    des.media_comp4,
    des.media_comp5,
    dmu.media_nota_redacao_municipio,
    dmu.media_comp1_municipio,
    dmu.media_comp2_municipio,
    dmu.media_comp3_municipio,
    dmu.media_comp4_municipio,
    dmu.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM
    aluno_desempenho ad,
    desempenho_estado des,
    desempenho_municipio dmu,
    desempenho_renda dr;
"
210061347472,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347472;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347472)
)

SELECT 
    *
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061347472)
)

SELECT 
    *
FROM 
    renda_comparacao;
"
210059589807,"
WITH aluno_info AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589807
),
estudantes_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estudantes_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estudantes_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)
SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.avg_comp1 AS avg_comp1_estado,
    e.avg_comp2 AS avg_comp2_estado,
    e.avg_comp3 AS avg_comp3_estado,
    e.avg_comp4 AS avg_comp4_estado,
    e.avg_comp5 AS avg_comp5_estado,
    e.avg_redacao AS avg_redacao_estado,
    c.avg_comp1 AS avg_comp1_cidade,
    c.avg_comp2 AS avg_comp2_cidade,
    c.avg_comp3 AS avg_comp3_cidade,
    c.avg_comp4 AS avg_comp4_cidade,
    c.avg_comp5 AS avg_comp5_cidade,
    c.avg_redacao AS avg_redacao_cidade,
    r.avg_comp1 AS avg_comp1_renda,
    r.avg_comp2 AS avg_comp2_renda,
    r.avg_comp3 AS avg_comp3_renda,
    r.avg_comp4 AS avg_comp4_renda,
    r.avg_comp5 AS avg_comp5_renda,
    r.avg_redacao AS avg_redacao_renda
FROM 
    aluno_info a,
    estudantes_estado e,
    estudantes_cidade c,
    estudantes_renda r;
"
210058954686,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954686;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954686)
)

SELECT 
    estado_comparativo.*,
    b.nu_nota_redacao,
    b.nu_nota_comp1,
    b.nu_nota_comp2,
    b.nu_nota_comp3,
    b.nu_nota_comp4,
    b.nu_nota_comp5
FROM 
    estado_comparativo,
    db.enem.base_enem b
WHERE 
    b.nu_inscricao = 210058954686;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954686)
)

SELECT 
    renda_comparativa.*,
    b.nu_nota_redacao,
    b.nu_nota_comp1,
    b.nu_nota_comp2,
    b.nu_nota_comp3,
    b.nu_nota_comp4,
    b.nu_nota_comp5
FROM 
    renda_comparativa,
    db.enem.base_enem b
WHERE 
    b.nu_inscricao = 210058954686;
"
210059974481,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974481
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
desempenho_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_desempenho a,
    desempenho_estado e,
    desempenho_cidade c,
    desempenho_renda r;
"
210061337618,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061337618
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059589797,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589797;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589797)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589797);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589797);
"
210058941531,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941531)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941531 OR 
    (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941531) AND 
     no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941531))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210059974470,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974470
),
comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparacao_estado e,
    comparacao_municipio m,
    comparacao_renda r;
"
210059982340,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982340;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982340)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982340);

-- Análise de desempenho com base na faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982340);
"
210060440995,"
WITH aluno_info AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060440995
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_info)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_info)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_info)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_info a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059246992,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc, no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246992;
"
210061337620,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337620;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337620)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337620)
);

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT * FROM renda_comparacao) AS comparacao_renda;
"
210059589798,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589798)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589798)
    ) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589798)
    ) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059589798;
"
210058941533,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058941533;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058941533)
)

SELECT 
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058941533)
)

SELECT 
    media_nota_redacao_renda,
    media_comp1_renda,
    media_comp2_renda,
    media_comp3_renda,
    media_comp4_renda,
    media_comp5_renda
FROM 
    renda_comparativa;
"
210058573841,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573841;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573841)
);

WITH municipio_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573841)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573841)
)

SELECT 
    e.*,
    m.*,
    r.*
FROM 
    estado_comparativo e,
    municipio_comparativo m,
    renda_comparativa r;
"
210061337632,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337632;

-- Comparação de desempenho com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337632)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337632);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337632);
"
210059974476,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974476
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_mun,
        AVG(nu_nota_comp1) AS media_comp1_mun,
        AVG(nu_nota_comp2) AS media_comp2_mun,
        AVG(nu_nota_comp3) AS media_comp3_mun,
        AVG(nu_nota_comp4) AS media_comp4_mun,
        AVG(nu_nota_comp5) AS media_comp5_mun
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_mun,
    dm.media_comp1_mun,
    dm.media_comp2_mun,
    dm.media_comp3_mun,
    dm.media_comp4_mun,
    dm.media_comp5_mun,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059982346,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982346)) AS media_redacao_uf,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982346)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982346)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982346;
"
210060441001,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441001;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441001)
);

WITH estatisticas_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441001)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441001)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_cidade) AS estatisticas_cidade,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
"
210060376433,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376433;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376433)
)

SELECT 
    * 
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376433)
)

SELECT 
    * 
FROM 
    renda_comparacao;
"
210058573842,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573842;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573842)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573842);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573842);
"
210059246998,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246998;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246998)
);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246998)
);

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estado_comparacao e,
    renda_comparacao r;
"
210061244813,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244813;

-- Estatísticas de desempenho em comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1, 
    AVG(nu_nota_comp2) AS media_comp2, 
    AVG(nu_nota_comp3) AS media_comp3, 
    AVG(nu_nota_comp4) AS media_comp4, 
    AVG(nu_nota_comp5) AS media_comp5, 
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244813)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244813);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda, 
    AVG(nu_nota_comp2) AS media_comp2_renda, 
    AVG(nu_nota_comp3) AS media_comp3_renda, 
    AVG(nu_nota_comp4) AS media_comp4_renda, 
    AVG(nu_nota_comp5) AS media_comp5_renda, 
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244813);
"
210061337634,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337634;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337634)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337634);

-- Análise do desempenho com base na faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337634);
"
210059589803,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589803;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589803)
);

WITH cidade_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589803)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589803)
);

SELECT 
    'Estado' AS comparativo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estado_comparativo

UNION ALL

SELECT 
    'Cidade' AS comparativo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    cidade_comparativo

UNION ALL

SELECT 
    'Renda' AS comparativo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    renda_comparativa;
"
210058954678,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954678
),
desempenho_estadual AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipal AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_nota_redacao AS media_estadual,
    de.media_comp1 AS media_comp1_estadual,
    de.media_comp2 AS media_comp2_estadual,
    de.media_comp3 AS media_comp3_estadual,
    de.media_comp4 AS media_comp4_estadual,
    de.media_comp5 AS media_comp5_estadual,
    dm.media_nota_redacao AS media_municipal,
    dm.media_comp1 AS media_comp1_municipal,
    dm.media_comp2 AS media_comp2_municipal,
    dm.media_comp3 AS media_comp3_municipal,
    dm.media_comp4 AS media_comp4_municipal,
    dm.media_comp5 AS media_comp5_municipal,
    dr.media_nota_redacao AS media_nota_redacao_renda,
    dr.media_comp1 AS media_comp1_renda,
    dr.media_comp2 AS media_comp2_renda,
    dr.media_comp3 AS media_comp3_renda,
    dr.media_comp4 AS media_comp4_renda,
    dr.media_comp5 AS media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estadual de,
    desempenho_municipal dm,
    desempenho_renda dr;
"
210059974477,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM db.enem.base_enem
    WHERE nu_inscricao = 210059974477
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM db.enem.base_enem
    WHERE Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao AS media_estado,
    m.media_nota_redacao AS media_municipio,
    r.media_nota_redacao AS media_renda
FROM aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059982347,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982347;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982347)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d, desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982347)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d, desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
"
210060376434,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376434;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376434)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376434)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376434)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado,
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio,
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
"
210059246999,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246999;

-- Estatísticas do desempenho no mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246999)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246999);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246999);
"
210061244814,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244814;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244814)
),

desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244814)
),

desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244814)
)

SELECT 
    (SELECT * FROM desempenho_estado) AS desempenho_estado,
    (SELECT * FROM desempenho_municipio) AS desempenho_municipio,
    (SELECT * FROM desempenho_renda) AS desempenho_renda;
"
210061337637,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337637;

-- Estatísticas de desempenho em relação a alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337637) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337637);

-- Análise de desempenho em relação a alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337637);
"
210058954680,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954680
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059589804,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589804;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589804)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589804)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589804)
)

SELECT 
    (SELECT * FROM estatisticas_estado) AS estatisticas_estado, 
    (SELECT * FROM estatisticas_municipio) AS estatisticas_municipio, 
    (SELECT * FROM estatisticas_renda) AS estatisticas_renda;
"
210060441003,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441003;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441003)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441003);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441003);
"
210058573843,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        sg_uf_esc,
        no_municipio_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573843
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
"
210059247000,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059247000
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210061244815,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061244815
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.*,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210061337640,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao, 
    Q006,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337640;
"
210059589805,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589805;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589805)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589805);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589805);
"
210058954682,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954682;
"
210059974479,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974479;
"
210059982349,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = e.no_municipio_esc) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982349)) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210059982349;
"
210060441004,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441004;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441004)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441004);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441004);
"
210059247001,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059247001
),
estudantes_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estudantes_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_cidade,
        AVG(nu_nota_comp1) AS media_comp1_cidade,
        AVG(nu_nota_comp2) AS media_comp2_cidade,
        AVG(nu_nota_comp3) AS media_comp3_cidade,
        AVG(nu_nota_comp4) AS media_comp4_cidade,
        AVG(nu_nota_comp5) AS media_comp5_cidade
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estudantes_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    c.media_nota_redacao_cidade,
    c.media_comp1_cidade,
    c.media_comp2_cidade,
    c.media_comp3_cidade,
    c.media_comp4_cidade,
    c.media_comp5_cidade,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    estudantes_estado e,
    estudantes_cidade c,
    estudantes_renda r;
"
210060440996,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440996;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440996)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440996)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440996)
)

SELECT 
    'Estatísticas por Estado' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Estatísticas por Município' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Estatísticas por Faixa de Renda' AS categoria,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
"
210060376428,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = e.sg_uf_esc) AS media_nota_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = e.no_municipio_esc) AS media_nota_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376428)) AS media_nota_renda
FROM 
    db.enem.base_enem e
WHERE 
    nu_inscricao = 210060376428;
"
210061244808,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244808)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244808)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244808)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244808;
"
210061337623,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061337623;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337623)
)

SELECT 
    *
FROM 
    estado_comparacao;

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337623)
)

SELECT 
    *
FROM 
    renda_comparacao;
"
210059589799,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059589799
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_dados a,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210058954668,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954668;

WITH estado_cidade AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954668) AND
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954668)
),
renda_familia AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954668)
)

SELECT 
    e.media_nota_redacao, 
    e.media_comp1, 
    e.media_comp2, 
    e.media_comp3, 
    e.media_comp4, 
    e.media_comp5,
    r.media_nota_redacao_renda, 
    r.media_comp1_renda, 
    r.media_comp2_renda, 
    r.media_comp3_renda, 
    r.media_comp4_renda, 
    r.media_comp5_renda
FROM 
    estado_cidade e, 
    renda_familia r;
"
210059974472,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974472)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974472)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974472)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974472;
"
210059982342,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982342;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982342) AND
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982342);

-- Análise com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982342);
"
210060440997,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440997;

WITH PerformanceComparison AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440997)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440997)
),
IncomeComparison AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440997)
)

SELECT 
    pc.*,
    ic.*
FROM 
    PerformanceComparison pc,
    IncomeComparison ic;
"
210058573838,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573838;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573838)
),

municipio_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573838)
),

renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573838)
)

SELECT 
    (SELECT * FROM estado_comparacao) AS estado,
    (SELECT * FROM municipio_comparacao) AS municipio,
    (SELECT * FROM renda_comparacao) AS renda;
"
210060376429,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376429;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376429)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376429);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376429);
"
210058954672,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954672
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    aluno_dados.*,
    comparativo_estado.*,
    comparativo_municipio.*,
    comparativo_renda.*
FROM 
    aluno_dados,
    comparativo_estado,
    comparativo_municipio,
    comparativo_renda;
"
210059982344,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982344;
"
210058573840,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573840
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        AVG(nu_nota_redacao) AS media_redacao_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.*,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    de.media_redacao,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dm.media_redacao_municipio,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda,
    dr.media_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059246996,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246996;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246996)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246996);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246996);
"
210061244811,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061244811
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_nota_comp1_municipio,
        AVG(nu_nota_comp2) AS media_nota_comp2_municipio,
        AVG(nu_nota_comp3) AS media_nota_comp3_municipio,
        AVG(nu_nota_comp4) AS media_nota_comp4_municipio,
        AVG(nu_nota_comp5) AS media_nota_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_nota_comp1_renda,
        AVG(nu_nota_comp2) AS media_nota_comp2_renda,
        AVG(nu_nota_comp3) AS media_nota_comp3_renda,
        AVG(nu_nota_comp4) AS media_nota_comp4_renda,
        AVG(nu_nota_comp5) AS media_nota_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_nota_comp1,
    e.media_nota_comp2,
    e.media_nota_comp3,
    e.media_nota_comp4,
    e.media_nota_comp5,
    m.media_nota_redacao_municipio,
    m.media_nota_comp1_municipio,
    m.media_nota_comp2_municipio,
    m.media_nota_comp3_municipio,
    m.media_nota_comp4_municipio,
    m.media_nota_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_nota_comp1_renda,
    r.media_nota_comp2_renda,
    r.media_nota_comp3_renda,
    r.media_nota_comp4_renda,
    r.media_nota_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059589801,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = t.sg_uf_esc) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = t.no_municipio_esc) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589801)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem t
WHERE 
    nu_inscricao = 210059589801;
"
210059974475,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974475
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5,
        AVG(nu_nota_redacao) AS avg_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.*,
    de.avg_comp1 AS avg_comp1_estado,
    de.avg_comp2 AS avg_comp2_estado,
    de.avg_comp3 AS avg_comp3_estado,
    de.avg_comp4 AS avg_comp4_estado,
    de.avg_comp5 AS avg_comp5_estado,
    de.avg_redacao AS avg_redacao_estado,
    dm.avg_comp1 AS avg_comp1_municipio,
    dm.avg_comp2 AS avg_comp2_municipio,
    dm.avg_comp3 AS avg_comp3_municipio,
    dm.avg_comp4 AS avg_comp4_municipio,
    dm.avg_comp5 AS avg_comp5_municipio,
    dm.avg_redacao AS avg_redacao_municipio,
    dr.avg_comp1 AS avg_comp1_renda,
    dr.avg_comp2 AS avg_comp2_renda,
    dr.avg_comp3 AS avg_comp3_renda,
    dr.avg_comp4 AS avg_comp4_renda,
    dr.avg_comp5 AS avg_comp5_renda,
    dr.avg_redacao AS avg_redacao_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210060441000,"
SELECT 
    b.nu_inscricao,
    b.nu_nota_redacao,
    b.nu_nota_comp1,
    b.nu_nota_comp2,
    b.nu_nota_comp3,
    b.nu_nota_comp4,
    b.nu_nota_comp5,
    AVG(b.nu_nota_redacao) OVER (PARTITION BY b.sg_uf_esc) AS media_nota_redacao_uf,
    AVG(b.nu_nota_redacao) OVER (PARTITION BY b.no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(b.nu_nota_redacao) OVER (PARTITION BY b.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem b
WHERE 
    b.nu_inscricao = 210060441000;
"
210059246994,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
    ) AS media_redacao_estado_municipio,
    (SELECT COUNT(*) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
     AND Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246994)
    ) AS total_alunos_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210059246994;
"
210061337625,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337625)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337625)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337625)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061337625;
"
210058954670,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058954670
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_nota_comp1, 
    da.nu_nota_comp2, 
    da.nu_nota_comp3, 
    da.nu_nota_comp4, 
    da.nu_nota_comp5, 
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210059974473,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974473;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974473)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM estado_comparacao) AS media_estado_redacao,
    (SELECT media_comp1 FROM estado_comparacao) AS media_estado_comp1,
    (SELECT media_comp2 FROM estado_comparacao) AS media_estado_comp2,
    (SELECT media_comp3 FROM estado_comparacao) AS media_estado_comp3,
    (SELECT media_comp4 FROM estado_comparacao) AS media_estado_comp4,
    (SELECT media_comp5 FROM estado_comparacao) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974473);

WITH renda_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974473)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM renda_comparacao) AS media_renda_nota_redacao,
    (SELECT media_comp1_renda FROM renda_comparacao) AS media_renda_comp1,
    (SELECT media_comp2_renda FROM renda_comparacao) AS media_renda_comp2,
    (SELECT media_comp3_renda FROM renda_comparacao) AS media_renda_comp3,
    (SELECT media_comp4_renda FROM renda_comparacao) AS media_renda_comp4,
    (SELECT media_comp5_renda FROM renda_comparacao) AS media_renda_comp5
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao <> 210059974473 AND Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974473);
"
210059982343,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059982343
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210060440998,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060440998;

-- Estatísticas de desempenho no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440998)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060440998);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060440998);
"
210058573839,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573839
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_renda r;
"
210059246995,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246995)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059246995)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059246995)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059246995;
"
210061244810,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244810)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244810)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244810)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061244810;
"
210061337627,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337627)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061337627)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061337627)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061337627;
"
210059589800,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589800;

WITH comparacao_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589800)
),

comparacao_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589800)
),

comparacao_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_nota_comp1,
        AVG(nu_nota_comp2) AS media_nota_comp2,
        AVG(nu_nota_comp3) AS media_nota_comp3,
        AVG(nu_nota_comp4) AS media_nota_comp4,
        AVG(nu_nota_comp5) AS media_nota_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589800)
)

SELECT 
    'Estado' AS tipo_comparacao,
    media_nota_redacao,
    media_nota_comp1,
    media_nota_comp2,
    media_nota_comp3,
    media_nota_comp4,
    media_nota_comp5
FROM 
    comparacao_estado
UNION ALL
SELECT 
    'Município' AS tipo_comparacao,
    media_nota_redacao,
    media_nota_comp1,
    media_nota_comp2,
    media_nota_comp3,
    media_nota_comp4,
    media_nota_comp5
FROM 
    comparacao_municipio
UNION ALL
SELECT 
    'Renda' AS tipo_comparacao,
    media_nota_redacao,
    media_nota_comp1,
    media_nota_comp2,
    media_nota_comp3,
    media_nota_comp4,
    media_nota_comp5
FROM 
    comparacao_renda;
"
210058573849,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573849;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573849)
)

SELECT 
    e.*,
    es.media_nota_redacao,
    es.media_comp1,
    es.media_comp2,
    es.media_comp3,
    es.media_comp4,
    es.media_comp5
FROM 
    db.enem.base_enem e
CROSS JOIN 
    estatisticas_estado es
WHERE 
    e.no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573849);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573849)
)

SELECT 
    e.*,
    er.media_nota_redacao_renda,
    er.media_comp1_renda,
    er.media_comp2_renda,
    er.media_comp3_renda,
    er.media_comp4_renda,
    er.media_comp5_renda
FROM 
    db.enem.base_enem e
CROSS JOIN 
    estatisticas_renda er
WHERE 
    e.Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573849);
"
210059260088,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260088)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260088)) AS media_redacao_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260088)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260088;
"
210061244822,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244822) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244822)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244822)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061244822;
"
210059974486,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059974486
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    aluno_dados.*, 
    estatisticas_estado.*, 
    estatisticas_municipio.*, 
    estatisticas_renda.*
FROM 
    aluno_dados,
    estatisticas_estado,
    estatisticas_municipio,
    estatisticas_renda;
"
210060441011,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441011)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441011)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441011)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441011;
"
210058573850,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210058573850
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_redacao_estado,
    e.media_comp1_estado,
    e.media_comp2_estado,
    e.media_comp3_estado,
    e.media_comp4_estado,
    e.media_comp5_estado,
    m.media_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210059260089,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260089;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260089)
)

SELECT 
    estado_comparativo.*,
    (SELECT 
        AVG(nu_nota_redacao) 
     FROM 
        db.enem.base_enem 
     WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260089) 
        AND Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260089)) AS media_nota_redacao_renda
FROM 
    estado_comparativo;
"
210061347483,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347483;
"
210061244823,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244823;

-- Estatísticas para comparar desempenho com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_nota_comp1,
    AVG(nu_nota_comp2) AS media_nota_comp2,
    AVG(nu_nota_comp3) AS media_nota_comp3,
    AVG(nu_nota_comp4) AS media_nota_comp4,
    AVG(nu_nota_comp5) AS media_nota_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244823)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244823);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_nota_comp1_renda,
    AVG(nu_nota_comp2) AS media_nota_comp2_renda,
    AVG(nu_nota_comp3) AS media_nota_comp3_renda,
    AVG(nu_nota_comp4) AS media_nota_comp4_renda,
    AVG(nu_nota_comp5) AS media_nota_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244823);
"
210058954697,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954697)) AS media_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954697)) AS media_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954697)) AS media_redacao_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210058954697;
"
210060441012,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441012;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441012)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441012);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441012);
"
210058573851,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573851;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573851)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573851)
)

SELECT 
    *
FROM 
    renda_comparativa;
"
210061244824,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244824;

-- Estatísticas para comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244824)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244824);

-- Análise do desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244824);
"
210061347486,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061347486
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)
SELECT 
    a.*,
    e.media_nota_redacao AS media_estado_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    m.media_nota_redacao AS media_municipio_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    r.media_nota_redacao AS media_renda_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5
FROM 
    aluno_dados a
JOIN 
    estatisticas_estado e ON TRUE
JOIN 
    estatisticas_municipio m ON TRUE
JOIN 
    estatisticas_renda r ON TRUE;
"
210059974488,"
SELECT 
    e.nu_inscricao,
    e.no_municipio_esc,
    e.sg_uf_esc,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210059974488;
"
210059897897,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059897897;

WITH ComparacaoEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_estado,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059897897)
),

ComparacaoMunicipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_municipio,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059897897)
),

ComparacaoRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059897897)
)

SELECT 
    (SELECT * FROM ComparacaoEstado) AS estado,
    (SELECT * FROM ComparacaoMunicipio) AS municipio,
    (SELECT * FROM ComparacaoRenda) AS renda;
"
210060441013,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441013)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441013)) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441013)) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441013;
"
210061103970,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103970;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103970)
)

SELECT 
    d.*, 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d,
    desempenho_estado e
WHERE 
    d.sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103970);

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103970)
)

SELECT 
    d.*, 
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d,
    desempenho_renda r
WHERE 
    d.Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103970);
"
210059401152,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059401152
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio,
        COUNT(*) AS total_alunos_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_inscricao,
    da.nu_nota_redacao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    de.media_nota_redacao,
    de.media_comp1,
    de.media_comp2,
    de.media_comp3,
    de.media_comp4,
    de.media_comp5,
    dm.media_nota_redacao_municipio,
    dm.media_comp1_municipio,
    dm.media_comp2_municipio,
    dm.media_comp3_municipio,
    dm.media_comp4_municipio,
    dm.media_comp5_municipio,
    dr.media_nota_redacao_renda,
    dr.media_comp1_renda,
    dr.media_comp2_renda,
    dr.media_comp3_renda,
    dr.media_comp4_renda,
    dr.media_comp5_renda
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210058387356,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387356;
"
210059085161,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085161)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059085161)) AS media_municipio,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059085161)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085161;
"
210059540793,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    sg_uf_esc,
    no_municipio_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540793;

WITH estado_comparacao AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540793)
)

SELECT 
    (SELECT * FROM estado_comparacao) AS comparacao_estado,
    (SELECT AVG(nu_nota_redacao) AS media_nota_redacao_renda
     FROM db.enem.base_enem
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540793)
     AND sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540793)
    ) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540793;
"
210061103971,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103971
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103971)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103971))
    OR (Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103971))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210060214111,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060214111;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214111)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060214111);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060214111);
"
210059401153,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059401153;

-- Estatísticas de desempenho por estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059401153)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059401153);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059401153);
"
210058387357,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387357;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387357)
);

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387357)
);

SELECT 
    est.media_nota_redacao,
    est.media_comp1,
    est.media_comp2,
    est.media_comp3,
    est.media_comp4,
    est.media_comp5,
    renda.media_nota_redacao_renda,
    renda.media_comp1_renda,
    renda.media_comp2_renda,
    renda.media_comp3_renda,
    renda.media_comp4_renda,
    renda.media_comp5_renda
FROM 
    estado_comparativo est,
    renda_comparativa renda;
"
210059085162,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_nota_redacao_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_nota_redacao_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059085162;
"
210060811453,"
SELECT 
    nu_inscricao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    COUNT(*) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS total_alunos_estado,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS media_nota_redacao_estado,
    COUNT(*) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS total_alunos_cidade,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS media_nota_redacao_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS total_alunos_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210060811453)) AS media_nota_redacao_renda
FROM database.enem.base_enem
WHERE nu_inscricao = 210060811453
GROUP BY nu_inscricao;
"
210059540794,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540794;

-- Comparação com alunos do mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540794)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540794);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540794);
"
210061103972,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103972)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103972)) AS media_redacao_estado_municipio,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103972)) AS media_redacao_faixa_renda
FROM 
    db.enem.base_enem 
WHERE 
    nu_inscricao = 210061103972;
"
210060214112,"
WITH aluno_dados AS (
    SELECT 
        nu_nota_redacao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060214112
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao AS media_estado,
    e.media_comp1 AS media_comp1_estado,
    e.media_comp2 AS media_comp2_estado,
    e.media_comp3 AS media_comp3_estado,
    e.media_comp4 AS media_comp4_estado,
    e.media_comp5 AS media_comp5_estado,
    m.media_nota_redacao AS media_municipio,
    m.media_comp1 AS media_comp1_municipio,
    m.media_comp2 AS media_comp2_municipio,
    m.media_comp3 AS media_comp3_municipio,
    m.media_comp4 AS media_comp4_municipio,
    m.media_comp5 AS media_comp5_municipio,
    r.media_nota_redacao AS media_renda,
    r.media_comp1 AS media_comp1_renda,
    r.media_comp2 AS media_comp2_renda,
    r.media_comp3 AS media_comp3_renda,
    r.media_comp4 AS media_comp4_renda,
    r.media_comp5 AS media_comp5_renda
FROM 
    aluno_dados a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210059401154,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059401154;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059401154)
)

SELECT 
    e.media_nota_redacao, 
    e.media_comp1, 
    e.media_comp2, 
    e.media_comp3, 
    e.media_comp4, 
    e.media_comp5
FROM 
    estado_comparativo e;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059401154)
)

SELECT 
    r.media_nota_redacao, 
    r.media_comp1, 
    r.media_comp2, 
    r.media_comp3, 
    r.media_comp4, 
    r.media_comp5
FROM 
    renda_comparativa r;
"
210059980973,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980973)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059980973)
    ) AS avg_redacao_same_state_city,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059980973)
    ) AS avg_redacao_same_income
FROM db.enem.base_enem 
WHERE nu_inscricao = 210059980973;
"
210059982351,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982351;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982351)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982351)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982351)
)

SELECT 
    e_estado.media_nota_redacao AS media_estado_redacao,
    e_estado.media_comp1 AS media_estado_comp1,
    e_estado.media_comp2 AS media_estado_comp2,
    e_estado.media_comp3 AS media_estado_comp3,
    e_estado.media_comp4 AS media_estado_comp4,
    e_estado.media_comp5 AS media_estado_comp5,
    e_municipio.media_nota_redacao AS media_municipio_redacao,
    e_municipio.media_comp1 AS media_municipio_comp1,
    e_municipio.media_comp2 AS media_municipio_comp2,
    e_municipio.media_comp3 AS media_municipio_comp3,
    e_municipio.media_comp4 AS media_municipio_comp4,
    e_municipio.media_comp5 AS media_municipio_comp5,
    e_renda.media_nota_redacao AS media_renda_redacao,
    e_renda.media_comp1 AS media_renda_comp1,
    e_renda.media_comp2 AS media_renda_comp2,
    e_renda.media_comp3 AS media_renda_comp3,
    e_renda.media_comp4 AS media_renda_comp4,
    e_renda.media_comp5 AS media_renda_comp5
FROM 
    estatisticas_estado e_estado,
    estatisticas_municipio e_municipio,
    estatisticas_renda e_renda;
"
210060441006,"
WITH desempenho_aluno AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060441006
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)

SELECT 
    da.nu_inscricao,
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    de.media_comp1 AS media_estado_comp1,
    de.media_comp2 AS media_estado_comp2,
    de.media_comp3 AS media_estado_comp3,
    de.media_comp4 AS media_estado_comp4,
    de.media_comp5 AS media_estado_comp5,
    de.media_redacao AS media_estado_redacao,
    dm.media_comp1 AS media_municipio_comp1,
    dm.media_comp2 AS media_municipio_comp2,
    dm.media_comp3 AS media_municipio_comp3,
    dm.media_comp4 AS media_municipio_comp4,
    dm.media_comp5 AS media_municipio_comp5,
    dm.media_redacao AS media_municipio_redacao,
    dr.media_comp1 AS media_renda_comp1,
    dr.media_comp2 AS media_renda_comp2,
    dr.media_comp3 AS media_renda_comp3,
    dr.media_comp4 AS media_renda_comp4,
    dr.media_comp5 AS media_renda_comp5,
    dr.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado de,
    desempenho_municipio dm,
    desempenho_renda dr;
"
210060376438,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376438;

-- Estatísticas comparativas
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376438)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376438);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376438);
"
210058573846,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573846;

-- Estatísticas de desempenho no mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573846)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573846);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573846);
"
210059247003,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059247003)
     AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059247003)
    ) AS media_redacao_estado_cidade,
    (SELECT AVG(nu_nota_redacao) 
     FROM db.enem.base_enem 
     WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059247003)
    ) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059247003;
"
210061347475,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347475;

-- Comparação com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    AVG(nu_nota_redacao) AS media_redacao
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347475)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347475);

-- Análise de desempenho com base na faixa de renda
SELECT 
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda,
    AVG(nu_nota_redacao) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061347475);
"
210061244818,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244818;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244818)
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244818)
),

renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244818)
)

SELECT 
    (SELECT * FROM estado_comparativo) AS comparativo_estado,
    (SELECT * FROM renda_comparativa) AS comparativo_renda;
"
210059589808,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589808;

-- Estatísticas comparando com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589808)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589808);

-- Análise do desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589808);
"
210059974482,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974482)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974482)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974482)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974482;
"
210059982352,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982352;

WITH performance_state AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao,
        AVG(nu_nota_comp1) AS avg_comp1,
        AVG(nu_nota_comp2) AS avg_comp2,
        AVG(nu_nota_comp3) AS avg_comp3,
        AVG(nu_nota_comp4) AS avg_comp4,
        AVG(nu_nota_comp5) AS avg_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982352)
);

WITH performance_income AS (
    SELECT 
        AVG(nu_nota_redacao) AS avg_nota_redacao_income,
        AVG(nu_nota_comp1) AS avg_comp1_income,
        AVG(nu_nota_comp2) AS avg_comp2_income,
        AVG(nu_nota_comp3) AS avg_comp3_income,
        AVG(nu_nota_comp4) AS avg_comp4_income,
        AVG(nu_nota_comp5) AS avg_comp5_income
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982352)
);

SELECT 
    (SELECT * FROM performance_state) AS state_performance,
    (SELECT * FROM performance_income) AS income_performance;
"
210060441007,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210060441007
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
comparativo_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_desempenho a,
    comparativo_estado e,
    comparativo_municipio m,
    comparativo_renda r;
"
210060376439,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376439)) AS media_estado_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376439)) AS media_cidade_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376439)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376439;
"
210058573847,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) AS total_alunos,
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5,
    COUNT(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573847) THEN 1 END) AS total_mesma_renda,
    AVG(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573847) THEN nu_nota_redacao END) AS media_nota_redacao_mesma_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573847 
    OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573847) 
        AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573847))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210059974484,"
SELECT
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM
    db.enem.base_enem
WHERE
    nu_inscricao = 210059974484;

-- Desempenho dos alunos do mesmo Estado e Cidade
SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM
    db.enem.base_enem
WHERE
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974484)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974484);

-- Desempenho comparando com alunos da mesma faixa de renda
SELECT
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM
    db.enem.base_enem
WHERE
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974484);
"
210060441009,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441009;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441009)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441009);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441009);
"
210058573848,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058573848;

WITH Estado_Comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573848)
)

SELECT 
    *,
    (SELECT media_nota_redacao FROM Estado_Comparativo) AS media_estado_nota_redacao,
    (SELECT media_comp1 FROM Estado_Comparativo) AS media_estado_comp1,
    (SELECT media_comp2 FROM Estado_Comparativo) AS media_estado_comp2,
    (SELECT media_comp3 FROM Estado_Comparativo) AS media_estado_comp3,
    (SELECT media_comp4 FROM Estado_Comparativo) AS media_estado_comp4,
    (SELECT media_comp5 FROM Estado_Comparativo) AS media_estado_comp5
FROM 
    db.enem.base_enem
WHERE 
    no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058573848);

WITH Renda_Comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573848)
)

SELECT 
    *,
    (SELECT media_nota_redacao_renda FROM Renda_Comparativa) AS media_renda_nota_redacao,
    (SELECT media_comp1_renda FROM Renda_Comparativa) AS media_renda_comp1,
    (SELECT media_comp2_renda FROM Renda_Comparativa) AS media_renda_comp2,
    (SELECT media_comp3_renda FROM Renda_Comparativa) AS media_renda_comp3,
    (SELECT media_comp4_renda FROM Renda_Comparativa) AS media_renda_comp4,
    (SELECT media_comp5_renda FROM Renda_Comparativa) AS media_renda_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058573848);
"
210059260087,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260087;

-- Estatísticas comparativas com alunos do mesmo estado e cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260087)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260087);

-- Desempenho de alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260087);
"
210061244821,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_cidade,
    COUNT(*) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244821)) OVER () AS total_faixa_renda,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244821)) OVER () AS media_faixa_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244821;
"
210061347480,"
WITH aluno_desempenho AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210061347480
),
comparativo_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_desempenho)
),
comparativo_cidade AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_desempenho)
),
comparativo_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_desempenho)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    c.media_comp1 AS media_cidade_comp1,
    c.media_comp2 AS media_cidade_comp2,
    c.media_comp3 AS media_cidade_comp3,
    c.media_comp4 AS media_cidade_comp4,
    c.media_comp5 AS media_cidade_comp5,
    c.media_redacao AS media_cidade_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    aluno_desempenho a,
    comparativo_estado e,
    comparativo_cidade c,
    comparativo_renda r;
"
210059589811,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589811)) AS media_uf_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589811)) AS media_municipio_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589811)) AS media_renda_redacao
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589811;
"
210059974485,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059974485;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059974485)
)

SELECT 
    d.*,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5
FROM 
    db.enem.base_enem d, desempenho_estado e
WHERE 
    d.sg_uf_esc = e.sg_uf_esc;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059974485)
)

SELECT 
    d.*,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    db.enem.base_enem d, desempenho_renda r
WHERE 
    d.Q006 = r.Q006;
"
210060441010,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441010;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441010)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441010);

-- Análise de desempenho com alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441010);
"
210059247004,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao, 
        nu_nota_comp1, 
        nu_nota_comp2, 
        nu_nota_comp3, 
        nu_nota_comp4, 
        nu_nota_comp5, 
        nu_nota_redacao, 
        no_municipio_esc, 
        sg_uf_esc, 
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059247004
),
estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao,
        COUNT(*) AS total_alunos
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda,
        AVG(nu_nota_redacao) AS media_redacao_renda,
        COUNT(*) AS total_alunos_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_inscricao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    a.nu_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    e.media_redacao,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda,
    r.media_redacao_renda
FROM 
    aluno_dados a,
    estatisticas_estado e,
    estatisticas_renda r;
"
210061347476,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061347476;

-- Desempenho dos alunos no mesmo estado e município
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347476)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061347476);

-- Desempenho de alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061347476);
"
210058954689,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954689;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954689)
);

WITH estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058954689)
);

WITH estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058954689)
)

SELECT 
    'Estado' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_estado

UNION ALL

SELECT 
    'Município' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_municipio

UNION ALL

SELECT 
    'Renda' AS grupo,
    media_nota_redacao,
    media_comp1,
    media_comp2,
    media_comp3,
    media_comp4,
    media_comp5
FROM 
    estatisticas_renda;
"
210059982353,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059982353;

-- Comparação com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982353) 
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059982353);

-- Análise de desempenho por faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059982353);
"
210060441008,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441008)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060441008)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060441008)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060441008;
"
210060376440,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060376440;

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376440)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060376440);

SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060376440);
"
210059260086,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260086)) AS media_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059260086)) AS media_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059260086)) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059260086;
"
210061244820,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244820)) AS media_nota_redacao_estado,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061244820)) AS media_nota_redacao_cidade,
    (SELECT AVG(nu_nota_redacao) FROM db.enem.base_enem WHERE Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061244820)) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061244820;
"
210059589810,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059589810;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059589810)
)

SELECT * FROM desempenho_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059589810)
)

SELECT * FROM desempenho_renda;
"
210061347477,"
SELECT 
    e.nu_inscricao,
    e.no_municipio_esc,
    e.sg_uf_esc,
    e.tp_status_redacao,
    e.nu_nota_comp1,
    e.nu_nota_comp2,
    e.nu_nota_comp3,
    e.nu_nota_comp4,
    e.nu_nota_comp5,
    e.nu_nota_redacao,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.sg_uf_esc) AS media_nota_redacao_estado,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.no_municipio_esc) AS media_nota_redacao_cidade,
    AVG(e.nu_nota_redacao) OVER (PARTITION BY e.Q006) AS media_nota_redacao_renda
FROM 
    db.enem.base_enem e
WHERE 
    e.nu_inscricao = 210061347477;
"
210058954691,"
SELECT 
    no_municipio_esc, 
    sg_uf_esc, 
    nu_inscricao, 
    tp_status_redacao, 
    nu_nota_comp1, 
    nu_nota_comp2, 
    nu_nota_comp3, 
    nu_nota_comp4, 
    nu_nota_comp5, 
    nu_nota_redacao,
    AVG(nu_nota_redacao) OVER (PARTITION BY sg_uf_esc) AS media_estado,
    AVG(nu_nota_redacao) OVER (PARTITION BY no_municipio_esc) AS media_municipio,
    AVG(nu_nota_redacao) OVER (PARTITION BY Q006) AS media_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058954691;
"
210060811464,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) AS total_alunos_estado,
    AVG(nu_nota_redacao) AS media_redacao_estado,
    COUNT(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060811464) THEN 1 END) AS total_alunos_renda,
    AVG(CASE WHEN Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210060811464) THEN nu_nota_redacao END) AS media_redacao_renda
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210060811464 OR (sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811464) AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210060811464))
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210059540805,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059540805;

WITH ComparativoEstado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_estado,
        AVG(nu_nota_comp1) AS media_comp1_estado,
        AVG(nu_nota_comp2) AS media_comp2_estado,
        AVG(nu_nota_comp3) AS media_comp3_estado,
        AVG(nu_nota_comp4) AS media_comp4_estado,
        AVG(nu_nota_comp5) AS media_comp5_estado
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540805)
),

ComparativoMunicipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059540805)
)

SELECT 
    (SELECT * FROM ComparativoEstado) AS EstatisticasEstado,
    (SELECT * FROM ComparativoMunicipio) AS EstatisticasMunicipio;

WITH ComparativoRenda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059540805)
)

SELECT 
    (SELECT * FROM ComparativoRenda) AS EstatisticasRenda;
"
210061103982,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210061103982;

WITH estado_comparativo AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210061103982)
)

SELECT 
    *
FROM 
    estado_comparativo;

WITH renda_comparativa AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210061103982)
)

SELECT 
    *
FROM 
    renda_comparativa;
"
210059401165,"
SELECT 
    nu_inscricao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    no_municipio_esc,
    sg_uf_esc,
    COUNT(*) FILTER (WHERE nu_nota_redacao >= 0) AS total_alunos,
    AVG(nu_nota_redacao) FILTER (WHERE sg_uf_esc = (SELECT sg_uf_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059401165)) AS media_estado,
    AVG(nu_nota_redacao) FILTER (WHERE no_municipio_esc = (SELECT no_municipio_esc FROM database.enem.base_enem WHERE nu_inscricao = 210059401165)) AS media_municipio,
    AVG(nu_nota_redacao) FILTER (WHERE Q006 = (SELECT Q006 FROM database.enem.base_enem WHERE nu_inscricao = 210059401165)) AS media_renda
FROM 
    database.enem.base_enem
WHERE 
    nu_inscricao = 210059401165
GROUP BY 
    nu_inscricao, no_municipio_esc, sg_uf_esc;
"
210058073319,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058073319;

WITH estatisticas_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073319)
),

estatisticas_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058073319)
),

estatisticas_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058073319)
)

SELECT 
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_nota_redacao_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    estatisticas_estado e,
    estatisticas_municipio m,
    estatisticas_renda r;
"
210059868183,"
SELECT 
    no_municipio_esc,
    sg_uf_esc,
    nu_inscricao,
    tp_status_redacao,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210059868183;

WITH desempenho_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210059868183)
)

SELECT 
    (SELECT media_nota_redacao FROM desempenho_estado) AS media_nota_redacao_estado,
    (SELECT media_comp1 FROM desempenho_estado) AS media_comp1_estado,
    (SELECT media_comp2 FROM desempenho_estado) AS media_comp2_estado,
    (SELECT media_comp3 FROM desempenho_estado) AS media_comp3_estado,
    (SELECT media_comp4 FROM desempenho_estado) AS media_comp4_estado,
    (SELECT media_comp5 FROM desempenho_estado) AS media_comp5_estado;

WITH desempenho_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210059868183)
)

SELECT 
    (SELECT media_nota_redacao_renda FROM desempenho_renda) AS media_nota_redacao_renda,
    (SELECT media_comp1_renda FROM desempenho_renda) AS media_comp1_renda,
    (SELECT media_comp2_renda FROM desempenho_renda) AS media_comp2_renda,
    (SELECT media_comp3_renda FROM desempenho_renda) AS media_comp3_renda,
    (SELECT media_comp4_renda FROM desempenho_renda) AS media_comp4_renda,
    (SELECT media_comp5_renda FROM desempenho_renda) AS media_comp5_renda;
"
210059085173,"
WITH aluno_dados AS (
    SELECT 
        nu_inscricao,
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059085173
),
alunos_estado AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao,
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM aluno_dados)
),
alunos_municipio AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_nota_redacao_municipio,
        AVG(nu_nota_comp1) AS media_comp1_municipio,
        AVG(nu_nota_comp2) AS media_comp2_municipio,
        AVG(nu_nota_comp3) AS media_comp3_municipio,
        AVG(nu_nota_comp4) AS media_comp4_municipio,
        AVG(nu_nota_comp5) AS media_comp5_municipio
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM aluno_dados)
),
alunos_renda AS (
    SELECT 
        AVG(nu_nota_redacao) AS media_renda,
        AVG(nu_nota_comp1) AS media_comp1_renda,
        AVG(nu_nota_comp2) AS media_comp2_renda,
        AVG(nu_nota_comp3) AS media_comp3_renda,
        AVG(nu_nota_comp4) AS media_comp4_renda,
        AVG(nu_nota_comp5) AS media_comp5_renda
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM aluno_dados)
)

SELECT 
    a.nu_nota_redacao,
    a.nu_nota_comp1,
    a.nu_nota_comp2,
    a.nu_nota_comp3,
    a.nu_nota_comp4,
    a.nu_nota_comp5,
    e.media_nota_redacao,
    e.media_comp1,
    e.media_comp2,
    e.media_comp3,
    e.media_comp4,
    e.media_comp5,
    m.media_nota_redacao_municipio,
    m.media_comp1_municipio,
    m.media_comp2_municipio,
    m.media_comp3_municipio,
    m.media_comp4_municipio,
    m.media_comp5_municipio,
    r.media_renda,
    r.media_comp1_renda,
    r.media_comp2_renda,
    r.media_comp3_renda,
    r.media_comp4_renda,
    r.media_comp5_renda
FROM 
    aluno_dados a,
    alunos_estado e,
    alunos_municipio m,
    alunos_renda r;
"
210059540806,"
WITH desempenho_aluno AS (
    SELECT 
        nu_nota_comp1,
        nu_nota_comp2,
        nu_nota_comp3,
        nu_nota_comp4,
        nu_nota_comp5,
        nu_nota_redacao,
        no_municipio_esc,
        sg_uf_esc,
        Q006
    FROM 
        db.enem.base_enem
    WHERE 
        nu_inscricao = 210059540806
),
desempenho_estado AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        sg_uf_esc = (SELECT sg_uf_esc FROM desempenho_aluno)
),
desempenho_municipio AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        no_municipio_esc = (SELECT no_municipio_esc FROM desempenho_aluno)
),
desempenho_renda AS (
    SELECT 
        AVG(nu_nota_comp1) AS media_comp1,
        AVG(nu_nota_comp2) AS media_comp2,
        AVG(nu_nota_comp3) AS media_comp3,
        AVG(nu_nota_comp4) AS media_comp4,
        AVG(nu_nota_comp5) AS media_comp5,
        AVG(nu_nota_redacao) AS media_redacao
    FROM 
        db.enem.base_enem
    WHERE 
        Q006 = (SELECT Q006 FROM desempenho_aluno)
)
SELECT 
    da.nu_nota_comp1,
    da.nu_nota_comp2,
    da.nu_nota_comp3,
    da.nu_nota_comp4,
    da.nu_nota_comp5,
    da.nu_nota_redacao,
    e.media_comp1 AS media_estado_comp1,
    e.media_comp2 AS media_estado_comp2,
    e.media_comp3 AS media_estado_comp3,
    e.media_comp4 AS media_estado_comp4,
    e.media_comp5 AS media_estado_comp5,
    e.media_redacao AS media_estado_redacao,
    m.media_comp1 AS media_municipio_comp1,
    m.media_comp2 AS media_municipio_comp2,
    m.media_comp3 AS media_municipio_comp3,
    m.media_comp4 AS media_municipio_comp4,
    m.media_comp5 AS media_municipio_comp5,
    m.media_redacao AS media_municipio_redacao,
    r.media_comp1 AS media_renda_comp1,
    r.media_comp2 AS media_renda_comp2,
    r.media_comp3 AS media_renda_comp3,
    r.media_comp4 AS media_renda_comp4,
    r.media_comp5 AS media_renda_comp5,
    r.media_redacao AS media_renda_redacao
FROM 
    desempenho_aluno da,
    desempenho_estado e,
    desempenho_municipio m,
    desempenho_renda r;
"
210058387358,"
SELECT 
    nu_inscricao,
    no_municipio_esc,
    sg_uf_esc,
    nu_nota_comp1,
    nu_nota_comp2,
    nu_nota_comp3,
    nu_nota_comp4,
    nu_nota_comp5,
    nu_nota_redacao,
    Q006
FROM 
    db.enem.base_enem
WHERE 
    nu_inscricao = 210058387358;

-- Estatísticas comparativas com alunos do mesmo Estado e Cidade
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao,
    AVG(nu_nota_comp1) AS media_comp1,
    AVG(nu_nota_comp2) AS media_comp2,
    AVG(nu_nota_comp3) AS media_comp3,
    AVG(nu_nota_comp4) AS media_comp4,
    AVG(nu_nota_comp5) AS media_comp5
FROM 
    db.enem.base_enem
WHERE 
    sg_uf_esc = (SELECT sg_uf_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387358)
    AND no_municipio_esc = (SELECT no_municipio_esc FROM db.enem.base_enem WHERE nu_inscricao = 210058387358);

-- Análise de desempenho com outros alunos da mesma faixa de renda
SELECT 
    AVG(nu_nota_redacao) AS media_nota_redacao_renda,
    AVG(nu_nota_comp1) AS media_comp1_renda,
    AVG(nu_nota_comp2) AS media_comp2_renda,
    AVG(nu_nota_comp3) AS media_comp3_renda,
    AVG(nu_nota_comp4) AS media_comp4_renda,
    AVG(nu_nota_comp5) AS media_comp5_renda
FROM 
    db.enem.base_enem
WHERE 
    Q006 = (SELECT Q006 FROM db.enem.base_enem WHERE nu_inscricao = 210058387358);
"
